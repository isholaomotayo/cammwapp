(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{1876:function(e,t,a){"use strict";a.r(t);var n=a(134),s=a(538),i=(a(73),a(72),a(5)),r=a.n(i),o=a(10),c=a.n(o),l=a(47),u=a(546),d=a(0),m=(a(92),a(24),a(20),a(25),a(536)),p=a(553),f=a(549),h=a(535),g=a(577),b=a(589),v=a(575),E=a(3),y=a(592),S=a(12);function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function M(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var T=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),N(M(M(a=function(e,t){return!t||"object"!==_(t)&&"function"!=typeof t?M(e):t}(this,k(t).call(this,e)))),"handleOnChange",function(e){var t=e.currentTarget.value;a.setState({joinLeaveState:t})}),N(M(M(a)),"handleUpdateSection",function(e){e||a.setState({joinLeaveState:a.props.joinLeave}),a.props.onUpdateSection(e)}),N(M(M(a)),"handleSubmit",function(){var e=a.props,t=e.actions,n=e.currentUserId,s=e.onUpdateSection,i={category:S.Preferences.CATEGORY_ADVANCED_SETTINGS,user_id:n,name:S.Preferences.ADVANCED_FILTER_JOIN_LEAVE,value:a.state.joinLeaveState};t.savePreferences(n,[i]),s()}),a.state={joinLeaveState:e.joinLeave},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(t,c.a.PureComponent),function(e,t,a){t&&O(e.prototype,t),a&&O(e,a)}(t,[{key:"render",value:function(){var e=this.state.joinLeaveState;return this.props.activeSection===d.b.JOIN_LEAVE?c.a.createElement(g.a,{title:c.a.createElement(m.c,{id:"user.settings.advance.joinLeaveTitle",defaultMessage:"Enable Join/Leave Messages"}),inputs:[c.a.createElement("div",{key:"joinLeaveSetting"},c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"joinLeaveOn",type:"radio",value:"true",name:d.b.JOIN_LEAVE,checked:"true"===e,onChange:this.handleOnChange}),c.a.createElement(m.c,{id:"user.settings.advance.on",defaultMessage:"On"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"joinLeaveOff",type:"radio",value:"false",name:d.b.JOIN_LEAVE,checked:"false"===e,onChange:this.handleOnChange}),c.a.createElement(m.c,{id:"user.settings.advance.off",defaultMessage:"Off"})),c.a.createElement("br",null)),c.a.createElement("div",null,c.a.createElement("br",null),c.a.createElement(m.c,{id:"user.settings.advance.joinLeaveDesc",defaultMessage:'When "On", System Messages saying a user has joined or left a channel will be visible. When "Off", the System Messages about joining or leaving a channel will be hidden. A message will still show up when you are added to a channel, so you can receive a notification.'})))],setting:d.b.JOIN_LEAVE,submit:this.handleSubmit,saving:this.state.isSaving,server_error:this.state.serverError,updateSection:this.handleUpdateSection}):c.a.createElement(b.a,{title:c.a.createElement(m.c,{id:"user.settings.advance.joinLeaveTitle",defaultMessage:"Enable Join/Leave Messages"}),describe:this.props.renderOnOffLabel(e),focused:this.props.prevActiveSection===d.b.JOIN_LEAVE,section:d.b.JOIN_LEAVE,updateSection:this.handleUpdateSection})}}]),t}();N(T,"propTypes",{activeSection:r.a.string,currentUserId:r.a.string.isRequired,joinLeave:r.a.string,onUpdateSection:r.a.func.isRequired,prevActiveSection:r.a.string,renderOnOffLabel:r.a.func.isRequired,actions:r.a.shape({savePreferences:r.a.func.isRequired}).isRequired});var C=Object(n.connect)(function(e){var t=Object(u.get)(e,S.Preferences.CATEGORY_ADVANCED_SETTINGS,S.Preferences.ADVANCED_FILTER_JOIN_LEAVE,"true");return{currentUserId:Object(s.getCurrentUserId)(e),joinLeave:t}},function(e){return{actions:Object(E.bindActionCreators)({savePreferences:y.savePreferences},e)}})(T);function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function I(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var L=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),D(I(I(a=function(e,t){return!t||"object"!==A(t)&&"function"!=typeof t?I(e):t}(this,P(t).call(this,e)))),"handleOnChange",function(e){var t=e.currentTarget.value;a.setState({codeBlockOnCtrlEnterState:t})}),D(I(I(a)),"handleUpdateSection",function(e){e||a.setState({codeBlockOnCtrlEnterState:a.props.codeBlockOnCtrlEnter}),a.props.onUpdateSection(e)}),D(I(I(a)),"handleSubmit",function(){var e=a.props,t=e.actions,n=e.currentUserId,s=e.onUpdateSection,i={user_id:n,category:S.Preferences.CATEGORY_ADVANCED_SETTINGS,name:"code_block_ctrl_enter",value:a.state.codeBlockOnCtrlEnterState};t.savePreferences(n,[i]),s()}),a.state={codeBlockOnCtrlEnterState:e.codeBlockOnCtrlEnter},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(t,c.a.PureComponent),function(e,t,a){t&&j(e.prototype,t),a&&j(e,a)}(t,[{key:"render",value:function(){if(this.props.sendMessageOnCtrlEnter)return null;var e=this.state.codeBlockOnCtrlEnterState,t=c.a.createElement(b.a,{title:c.a.createElement(m.c,{id:"user.settings.advance.codeBlockOnCtrlEnterSendTitle",defaultMessage:"Send code block messages on CTRL + ENTER"}),describe:this.props.renderOnOffLabel(e),focused:this.props.prevActiveSection===d.b.CODE_BLOCK_ON_CTRL_ENTER,section:d.b.CODE_BLOCK_ON_CTRL_ENTER,updateSection:this.handleUpdateSection});return this.props.activeSection===d.b.CODE_BLOCK_ON_CTRL_ENTER&&(t=c.a.createElement(g.a,{title:c.a.createElement(m.c,{id:"user.settings.advance.codeBlockOnCtrlEnterSendTitle",defaultMessage:"Send code block messages on CTRL + ENTER"}),inputs:[c.a.createElement("div",{key:"codeBlockOnCtrlEnterSetting"},c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"codeBlockOnCtrlEnterOn",type:"radio",value:"true",name:d.b.CODE_BLOCK_ON_CTRL_ENTER,checked:"true"===e,onChange:this.handleOnChange}),c.a.createElement(m.c,{id:"user.settings.advance.on",defaultMessage:"On"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"codeBlockOnCtrlEnterOff",type:"radio",value:"false",name:d.b.CODE_BLOCK_ON_CTRL_ENTER,checked:"false"===e,onChange:this.handleOnChange}),c.a.createElement(m.c,{id:"user.settings.advance.off",defaultMessage:"Off"})),c.a.createElement("br",null)),c.a.createElement("div",null,c.a.createElement("br",null),c.a.createElement(m.c,{id:"user.settings.advance.codeBlockOnCtrlEnterSendDesc",defaultMessage:"If enabled, ENTER inserts a new line within messages formatted as code starting with ```. CTRL + ENTER submits the message."})))],setting:d.b.CODE_BLOCK_ON_CTRL_ENTER,submit:this.handleSubmit,saving:this.state.isSaving,server_error:this.state.serverError,updateSection:this.handleUpdateSection})),c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"divider-light"}),t)}}]),t}();D(L,"propTypes",{activeSection:r.a.string,currentUserId:r.a.string.isRequired,codeBlockOnCtrlEnter:r.a.string,sendMessageOnCtrlEnter:r.a.bool,onUpdateSection:r.a.func.isRequired,prevActiveSection:r.a.string,renderOnOffLabel:r.a.func.isRequired,actions:r.a.shape({savePreferences:r.a.func.isRequired}).isRequired});var U=Object(n.connect)(function(e){return{currentUserId:Object(s.getCurrentUserId)(e),codeBlockOnCtrlEnter:Object(u.get)(e,S.Preferences.CATEGORY_ADVANCED_SETTINGS,"code_block_ctrl_enter","true"),sendMessageOnCtrlEnter:Object(u.getBool)(e,S.Preferences.CATEGORY_ADVANCED_SETTINGS,"send_on_ctrl_enter")}},function(e){return{actions:Object(E.bindActionCreators)({savePreferences:y.savePreferences},e)}})(L);function x(e){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function q(e){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function z(e,t){return(z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function G(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var V=d.D.PRE_RELEASE_FEATURES,H=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),B(G(G(a=function(e,t){return!t||"object"!==x(t)&&"function"!=typeof t?G(e):t}(this,q(t).call(this,e)))),"getStateFromProps",function(){var e=a.props.advancedSettingsCategory,t={send_on_ctrl_enter:a.props.sendOnCtrlEnter,formatting:a.props.formatting,join_leave:a.props.joinLeave},n=Object.keys(V),s=0,i=!0,r=!1,o=void 0;try{for(var c,l=e[Symbol.iterator]();!(i=(c=l.next()).done);i=!0)for(var u=c.value,m=0;m<n.length;m++){var p=n[m],f=V[p];u.name===d.D.FeatureTogglePrefix+f.label&&(t[u.name]=u.value,"true"===u.value&&(s+=1))}}catch(e){r=!0,o=e}finally{try{i||null==l.return||l.return()}finally{if(r)throw o}}var h=a.props.enablePreviewFeatures;return{preReleaseFeatures:V,settings:t,preReleaseFeaturesKeys:n,enabledFeatures:s,isSaving:!1,previewFeaturesEnabled:h,showDeactivateAccountModal:!1}}),B(G(G(a)),"updateSetting",function(e,t){var n=a.state.settings;n[e]=t,a.setState(n)}),B(G(G(a)),"toggleFeature",function(e,t){var n=a.state.settings;n[d.D.FeatureTogglePrefix+e]=String(t);var s=0;Object.keys(a.state.settings).forEach(function(e){0===e.lastIndexOf(d.D.FeatureTogglePrefix)&&"true"===a.state.settings[e]&&s++}),a.setState({settings:n,enabledFeatures:s})}),B(G(G(a)),"saveEnabledFeatures",function(){var e=[];Object.keys(a.state.settings).forEach(function(t){0===t.lastIndexOf(d.D.FeatureTogglePrefix)&&e.push(t)}),a.handleSubmit(e)}),B(G(G(a)),"handleSubmit",function(e){var t=[],n=a.props.currentUser.id;(Array.isArray(e)?e:[e]).forEach(function(e){t.push({user_id:n,category:d.D.Preferences.CATEGORY_ADVANCED_SETTINGS,name:e,value:a.state.settings[e]})}),a.setState({isSaving:!0}),Object(p.B)(t,function(){a.handleUpdateSection("")})}),B(G(G(a)),"handleDeactivateAccountSubmit",function(){var e=a.props.currentUser.id;a.setState({isSaving:!0}),Object(p.G)(e,!1,null,function(e){a.setState({serverError:e.message})}),Object(p.z)(e,function(){Object(f.p)()},function(e){a.setState({serverError:e.message})})}),B(G(G(a)),"handleShowDeactivateAccountModal",function(){a.setState({showDeactivateAccountModal:!0})}),B(G(G(a)),"handleHideDeactivateAccountModal",function(){a.setState({showDeactivateAccountModal:!1})}),B(G(G(a)),"handleUpdateSection",function(e){e||a.setState(a.getStateFromProps()),a.setState({isSaving:!1}),a.props.updateSection(e)}),B(G(G(a)),"renderFormattingSection",function(){return"formatting"===a.props.activeSection?c.a.createElement(g.a,{title:c.a.createElement(m.c,{id:"user.settings.advance.formattingTitle",defaultMessage:"Enable Post Formatting"}),inputs:[c.a.createElement("div",{key:"formattingSetting"},c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"postFormattingOn",type:"radio",name:"formatting",checked:"false"!==a.state.settings.formatting,onChange:a.updateSetting.bind(G(G(a)),"formatting","true")}),c.a.createElement(m.c,{id:"user.settings.advance.on",defaultMessage:"On"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"postFormattingOff",type:"radio",name:"formatting",checked:"false"===a.state.settings.formatting,onChange:a.updateSetting.bind(G(G(a)),"formatting","false")}),c.a.createElement(m.c,{id:"user.settings.advance.off",defaultMessage:"Off"})),c.a.createElement("br",null)),c.a.createElement("div",null,c.a.createElement("br",null),c.a.createElement(m.c,{id:"user.settings.advance.formattingDesc",defaultMessage:"If enabled, posts will be formatted to create links, show emoji, style the text, and add line breaks. By default, this setting is enabled."})))],setting:"formatting",submit:a.handleSubmit,saving:a.state.isSaving,server_error:a.state.serverError,updateSection:a.handleUpdateSection}):c.a.createElement(b.a,{title:c.a.createElement(m.c,{id:"user.settings.advance.formattingTitle",defaultMessage:"Enable Post Formatting"}),describe:a.renderOnOffLabel(a.state.settings.formatting),focused:a.props.prevActiveSection===a.prevSections.formatting,section:"formatting",updateSection:a.handleUpdateSection})}),a.state=a.getStateFromProps(),a.prevSections={advancedCtrlSend:"dummySectionName",formatting:"advancedCtrlSend",join_leave:"formatting",advancedPreviewFeatures:"join_leave",deactivateAccount:"advancedPreviewFeatures"},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&z(e,t)}(t,c.a.Component),function(e,t,a){t&&F(e.prototype,t),a&&F(e,a)}(t,[{key:"renderOnOffLabel",value:function(e){return"false"===e?c.a.createElement(m.c,{id:"user.settings.advance.off",defaultMessage:"Off"}):c.a.createElement(m.c,{id:"user.settings.advance.on",defaultMessage:"On"})}},{key:"renderFeatureLabel",value:function(e){switch(e){case"MARKDOWN_PREVIEW":return c.a.createElement(m.c,{id:"user.settings.advance.markdown_preview",defaultMessage:"Show markdown preview option in message input box"});default:return null}}},{key:"render",value:function(){var e,t=this,a=this.state.serverError||null;if("advancedCtrlSend"===this.props.activeSection){var n=["true"===this.state.settings.send_on_ctrl_enter,"false"===this.state.settings.send_on_ctrl_enter],s=[c.a.createElement("div",{key:"ctrlSendSetting"},c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"ctrlSendOn",type:"radio",name:"sendOnCtrlEnter",checked:n[0],onChange:this.updateSetting.bind(this,"send_on_ctrl_enter","true")}),c.a.createElement(m.c,{id:"user.settings.advance.on",defaultMessage:"On"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"ctrlSendOff",type:"radio",name:"sendOnCtrlEnter",checked:n[1],onChange:this.updateSetting.bind(this,"send_on_ctrl_enter","false")}),c.a.createElement(m.c,{id:"user.settings.advance.off",defaultMessage:"Off"})),c.a.createElement("br",null)),c.a.createElement("div",null,c.a.createElement("br",null),c.a.createElement(m.c,{id:"user.settings.advance.sendDesc",defaultMessage:"If enabled ENTER inserts a new line and CTRL+ENTER submits the message."})))];e=c.a.createElement(g.a,{title:c.a.createElement(m.c,{id:"user.settings.advance.sendTitle",defaultMessage:"Send messages on CTRL+ENTER"}),inputs:s,setting:"send_on_ctrl_enter",submit:this.handleSubmit,saving:this.state.isSaving,server_error:a,updateSection:this.handleUpdateSection})}else e=c.a.createElement(b.a,{title:c.a.createElement(m.c,{id:"user.settings.advance.sendTitle",defaultMessage:"Send messages on CTRL+ENTER"}),describe:this.renderOnOffLabel(this.state.settings.send_on_ctrl_enter),focused:this.props.prevActiveSection===this.prevSections.advancedCtrlSend,section:"advancedCtrlSend",updateSection:this.handleUpdateSection});var i,r,o=this.renderFormattingSection(),l=null;if(o&&(l=c.a.createElement("div",{className:"divider-light"})),this.state.previewFeaturesEnabled&&this.state.preReleaseFeaturesKeys.length>0)if(r=c.a.createElement("div",{className:"divider-light"}),"advancedPreviewFeatures"===this.props.activeSection){var u=[];this.state.preReleaseFeaturesKeys.forEach(function(e){var a=t.state.preReleaseFeatures[e];u.push(c.a.createElement("div",{key:"advancedPreviewFeatures_"+a.label},c.a.createElement("div",{className:"checkbox"},c.a.createElement("label",null,c.a.createElement("input",{id:"advancedPreviewFeatures"+a.label,type:"checkbox",checked:"true"===t.state.settings[d.D.FeatureTogglePrefix+a.label],onChange:function(e){t.toggleFeature(a.label,e.target.checked)}}),t.renderFeatureLabel(e)))))}),u.push(c.a.createElement("div",{key:"advancedPreviewFeatures_helptext"},c.a.createElement("br",null),c.a.createElement(m.c,{id:"user.settings.advance.preReleaseDesc",defaultMessage:"Check any pre-released features you'd like to preview.  You may also need to refresh the page before the setting will take effect."}))),i=c.a.createElement(g.a,{title:c.a.createElement(m.c,{id:"user.settings.advance.preReleaseTitle",defaultMessage:"Preview pre-release features"}),inputs:u,submit:this.saveEnabledFeatures,saving:this.state.isSaving,server_error:a,updateSection:this.handleUpdateSection})}else i=c.a.createElement(b.a,{title:h.localizeMessage("user.settings.advance.preReleaseTitle","Preview pre-release features"),describe:c.a.createElement(m.c,{id:"user.settings.advance.enabledFeatures",defaultMessage:"{count, number} {count, plural, one {Feature} other {Features}} Enabled",values:{count:this.state.enabledFeatures}}),focused:this.props.prevActiveSection===this.prevSections.advancedPreviewFeatures,section:"advancedPreviewFeatures",updateSection:this.handleUpdateSection});var p="",f="";if(""===this.props.currentUser.auth_service&&this.props.enableUserDeactivation){p="deactivateAccount"===this.props.activeSection?c.a.createElement(g.a,{title:c.a.createElement(m.c,{id:"user.settings.advance.deactivateAccountTitle",defaultMessage:"Deactivate Account"}),inputs:[c.a.createElement("div",{key:"formattingSetting"},c.a.createElement("div",null,c.a.createElement("br",null),c.a.createElement(m.c,{id:"user.settings.advance.deactivateDesc",defaultMessage:"Deactivating your account removes your ability to log in to this server and disables all email and mobile notifications. To reactivate your account, contact your System Administrator."})))],saveButtonText:"Deactivate",setting:"deactivateAccount",submit:this.handleShowDeactivateAccountModal,saving:this.state.isSaving,server_error:this.state.serverError,updateSection:this.handleUpdateSection}):c.a.createElement(b.a,{title:c.a.createElement(m.c,{id:"user.settings.advance.deactivateAccountTitle",defaultMessage:"Deactivate Account"}),describe:c.a.createElement(m.c,{id:"user.settings.advance.deactivateDescShort",defaultMessage:"Click 'Edit' to deactivate your account"}),focused:this.props.prevActiveSection===this.prevSections.deactivateAccount,section:"deactivateAccount",updateSection:this.handleUpdateSection});var E=c.a.createElement(m.c,{id:"user.settings.advance.deactivate_member_modal.deactivateButton",defaultMessage:"Yes, deactivate my account"});f=c.a.createElement(v.a,{show:this.state.showDeactivateAccountModal,title:c.a.createElement(m.c,{id:"user.settings.advance.confirmDeactivateAccountTitle",defaultMessage:"Confirm Deactivation"}),message:c.a.createElement(m.c,{id:"user.settings.advance.confirmDeactivateDesc",defaultMessage:"Are you sure you want to deactivate your account? This can only be reversed by your System Administrator."}),confirmButtonClass:"btn btn-danger",confirmButtonText:E,onConfirm:this.handleDeactivateAccountSubmit,onCancel:this.handleHideDeactivateAccountModal})}return c.a.createElement("div",null,c.a.createElement("div",{className:"modal-header"},c.a.createElement("button",{id:"closeButton",type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:this.props.closeModal},c.a.createElement("span",{"aria-hidden":"true"},"×")),c.a.createElement("h4",{className:"modal-title",ref:"title"},c.a.createElement("div",{className:"modal-back"},c.a.createElement("i",{className:"fa fa-angle-left",title:h.localizeMessage("generic_icons.back","Back Icon"),onClick:this.props.collapseModal})),c.a.createElement(m.c,{id:"user.settings.advance.title",defaultMessage:"Advanced Settings"}))),c.a.createElement("div",{className:"user-settings"},c.a.createElement("h3",{className:"tab-header"},c.a.createElement(m.c,{id:"user.settings.advance.title",defaultMessage:"Advanced Settings"})),c.a.createElement("div",{className:"divider-dark first"}),e,c.a.createElement(U,{activeSection:this.props.activeSection,onUpdateSection:this.handleUpdateSection,prevActiveSection:this.props.prevActiveSection,renderOnOffLabel:this.renderOnOffLabel}),l,o,c.a.createElement("div",{className:"divider-light"}),c.a.createElement(C,{activeSection:this.props.activeSection,onUpdateSection:this.handleUpdateSection,prevActiveSection:this.props.prevActiveSection,renderOnOffLabel:this.renderOnOffLabel}),r,i,l,p,c.a.createElement("div",{className:"divider-dark"}),f))}}]),t}();B(H,"propTypes",{currentUser:r.a.object.isRequired,advancedSettingsCategory:r.a.array.isRequired,sendOnCtrlEnter:r.a.string.isRequired,formatting:r.a.string.isRequired,joinLeave:r.a.string.isRequired,updateSection:r.a.func,activeSection:r.a.string,prevActiveSection:r.a.string,closeModal:r.a.func.isRequired,collapseModal:r.a.func.isRequired,enablePreviewFeatures:r.a.bool,enableUserDeactivation:r.a.bool});var Y=Object(n.connect)(function(){var e=Object(u.makeGetCategory)();return function(t){var a=Object(l.getConfig)(t),n="true"===a.EnablePreviewFeatures,i="true"===a.EnableUserDeactivation;return{advancedSettingsCategory:e(t,d.q.CATEGORY_ADVANCED_SETTINGS),sendOnCtrlEnter:Object(u.get)(t,d.q.CATEGORY_ADVANCED_SETTINGS,"send_on_ctrl_enter","false"),formatting:Object(u.get)(t,d.q.CATEGORY_ADVANCED_SETTINGS,"formatting","true"),joinLeave:Object(u.get)(t,d.q.CATEGORY_ADVANCED_SETTINGS,"join_leave","true"),currentUser:Object(s.getCurrentUser)(t),enablePreviewFeatures:n,enableUserDeactivation:i}}})(H),W=a(654),K=a(821),J=a(684),X=a(662),Q=a(685),Z=a(665),$=a(19),ee=a(232),te=(a(94),a(545)),ae=a.n(te),ne=a(135),se=a.n(ne),ie=a(558),re=a(1053),oe=a(1048),ce=(a(1591),a(138)),le=a(1096);function ue(e){return(ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function de(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function me(e){return(me=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pe(e,t){return(pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function he(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ge=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),he(fe(fe(a=function(e,t){return!t||"object"!==ue(t)&&"function"!=typeof t?fe(e):t}(this,me(t).call(this,e)))),"checkClick",function(e){var t=se.a.findDOMNode(a.colorPicker);t&&t.contains(e.target)||a.setState({isOpened:!1})}),he(fe(fe(a)),"togglePicker",function(){a.setState({isOpened:!a.state.isOpened})}),he(fe(fe(a)),"handleChange",function(e){var t=e.hex,n=a.props.onChange;n&&n(t)}),he(fe(fe(a)),"getColorPicker",function(e){a.colorPicker=e}),a.state={idOpened:!1},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pe(e,t)}(t,c.a.Component),function(e,t,a){t&&de(e.prototype,t),a&&de(e,a)}(t,[{key:"componentDidUpdate",value:function(e,t){var a=t.isOpened,n=this.state.isOpened;n!==a&&(n?document.addEventListener("click",this.checkClick):document.removeEventListener("click",this.checkClick))}},{key:"render",value:function(){var e=this.props.color,t=this.state.isOpened;return c.a.createElement("div",{className:"color-input input-group"},c.a.createElement("input",{className:"form-control",type:"text",value:e,readOnly:!0}),c.a.createElement("span",{className:"input-group-addon",onClick:this.togglePicker},c.a.createElement("i",{className:"color-icon",style:{backgroundColor:e}})),t&&c.a.createElement("div",{ref:this.getColorPicker,className:"color-popover"},c.a.createElement(le.ChromePicker,{color:e,onChange:this.handleChange})))}}]),t}();he(ge,"propTypes",{color:r.a.string.isRequired,onChange:r.a.func});var be=ge;function ve(e){return(ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ee(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ye(e){return(ye=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Se(e,t){return(Se=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _e(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Oe(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var ke=function(e){function t(){var e,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return Oe(_e(_e(a=function(e,t){return!t||"object"!==ve(t)&&"function"!=typeof t?_e(e):t}(this,(e=ye(t)).call.apply(e,[this].concat(s))))),"handleChange",function(e){var t=a.props,n=t.id,s=t.onChange;s&&s(n,e)}),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Se(e,t)}(t,c.a.Component),function(e,t,a){t&&Ee(e.prototype,t),a&&Ee(e,a)}(t,[{key:"render",value:function(){var e=this.props,t=e.label,a=e.color;return c.a.createElement("div",null,c.a.createElement("label",{className:"custom-label"},t),c.a.createElement(be,{color:a,onChange:this.handleChange}))}}]),t}();Oe(ke,"propTypes",{id:r.a.string.isRequired,label:r.a.string.isRequired,color:r.a.string.isRequired,onChange:r.a.func});var we=ke;function Me(e){return(Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ne(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Te(e){return(Te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ce(e,t){return(Ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ae(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function je(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Pe=Object(m.g)({sidebarBg:{id:Object($.b)("user.settings.custom_theme.sidebarBg"),defaultMessage:"Sidebar BG"},sidebarText:{id:Object($.b)("user.settings.custom_theme.sidebarText"),defaultMessage:"Sidebar Text"},sidebarHeaderBg:{id:Object($.b)("user.settings.custom_theme.sidebarHeaderBg"),defaultMessage:"Sidebar Header BG"},sidebarHeaderTextColor:{id:Object($.b)("user.settings.custom_theme.sidebarHeaderTextColor"),defaultMessage:"Sidebar Header Text"},sidebarUnreadText:{id:Object($.b)("user.settings.custom_theme.sidebarUnreadText"),defaultMessage:"Sidebar Unread Text"},sidebarTextHoverBg:{id:Object($.b)("user.settings.custom_theme.sidebarTextHoverBg"),defaultMessage:"Sidebar Text Hover BG"},sidebarTextActiveBorder:{id:Object($.b)("user.settings.custom_theme.sidebarTextActiveBorder"),defaultMessage:"Sidebar Text Active Border"},sidebarTextActiveColor:{id:Object($.b)("user.settings.custom_theme.sidebarTextActiveColor"),defaultMessage:"Sidebar Text Active Color"},onlineIndicator:{id:Object($.b)("user.settings.custom_theme.onlineIndicator"),defaultMessage:"Online Indicator"},awayIndicator:{id:Object($.b)("user.settings.custom_theme.awayIndicator"),defaultMessage:"Away Indicator"},dndIndicator:{id:Object($.b)("user.settings.custom_theme.dndIndicator"),defaultMessage:"Do Not Disturb Indicator"},mentionBg:{id:Object($.b)("user.settings.custom_theme.mentionBg"),defaultMessage:"Mention Jewel BG"},mentionColor:{id:Object($.b)("user.settings.custom_theme.mentionColor"),defaultMessage:"Mention Jewel Text"},centerChannelBg:{id:Object($.b)("user.settings.custom_theme.centerChannelBg"),defaultMessage:"Center Channel BG"},centerChannelColor:{id:Object($.b)("user.settings.custom_theme.centerChannelColor"),defaultMessage:"Center Channel Text"},newMessageSeparator:{id:Object($.b)("user.settings.custom_theme.newMessageSeparator"),defaultMessage:"New Message Separator"},linkColor:{id:Object($.b)("user.settings.custom_theme.linkColor"),defaultMessage:"Link Color"},buttonBg:{id:Object($.b)("user.settings.custom_theme.buttonBg"),defaultMessage:"Button BG"},buttonColor:{id:Object($.b)("user.settings.custom_theme.buttonColor"),defaultMessage:"Button Text"},errorTextColor:{id:Object($.b)("user.settings.custom_theme.errorTextColor"),defaultMessage:"Error Text Color"},mentionHighlightBg:{id:Object($.b)("user.settings.custom_theme.mentionHighlightBg"),defaultMessage:"Mention Highlight BG"},mentionHighlightLink:{id:Object($.b)("user.settings.custom_theme.mentionHighlightLink"),defaultMessage:"Mention Highlight Link"},codeTheme:{id:Object($.b)("user.settings.custom_theme.codeTheme"),defaultMessage:"Code Theme"}}),Re=function(e){function t(e){var a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),je(Ae(Ae(a=function(e,t){return!t||"object"!==Me(t)&&"function"!=typeof t?Ae(e):t}(this,Te(t).call(this,e)))),"handleColorChange",function(e,t){var n=a.props,s=n.updateTheme,i=n.theme;if(i[e]!==t){var r=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){je(e,t,a[t])})}return e}({},i,je({type:"custom"},e,t));"mentionBg"===e&&(r.mentionBj=t),s(r);var o=a.setCopyTheme(r);a.setState({copyTheme:o})}}),je(Ae(Ae(a)),"pasteBoxChange",function(e){var t="";if(0!==(t=window.clipboardData&&window.clipboardData.getData?window.clipboardData.getData("Text"):e.clipboardData.getData("Text")).length){var n;try{n=JSON.parse(t)}catch(e){return}a.setState({copyTheme:JSON.stringify(n)}),n.type="custom",a.props.updateTheme(n)}}),je(Ae(Ae(a)),"onChangeHandle",function(e){e.stopPropagation()}),je(Ae(Ae(a)),"selectTheme",function(){var e=a.refs.textarea;e.focus(),e.setSelectionRange(0,a.state.copyTheme.length)}),je(Ae(Ae(a)),"toggleSidebarStyles",function(e){e.preventDefault(),ae()(a.refs.sidebarStylesHeader).toggleClass("open"),a.toggleSection(a.refs.sidebarStyles)}),je(Ae(Ae(a)),"toggleCenterChannelStyles",function(e){e.preventDefault(),ae()(a.refs.centerChannelStylesHeader).toggleClass("open"),a.toggleSection(a.refs.centerChannelStyles)}),je(Ae(Ae(a)),"toggleLinkAndButtonStyles",function(e){e.preventDefault(),ae()(a.refs.linkAndButtonStylesHeader).toggleClass("open"),a.toggleSection(a.refs.linkAndButtonStyles)}),je(Ae(Ae(a)),"onCodeThemeChange",function(e){var t=a.props.theme;t.codeTheme=e.target.value,a.props.updateTheme(t)});var n=a.setCopyTheme(a.props.theme);return a.state={copyTheme:n},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ce(e,t)}(t,c.a.Component),function(e,t,a){t&&Ne(e.prototype,t),a&&Ne(e,a)}(t,[{key:"componentDidMount",value:function(){ae()(".group--code").on("change",this.onCodeThemeChange)}},{key:"componentWillUnmount",value:function(){ae()(".group--code").off("change",this.onCodeThemeChange)}},{key:"setCopyTheme",value:function(e){var t=Object.assign({},e);return delete t.type,delete t.image,JSON.stringify(t)}},{key:"toggleSection",value:function(e){ce.f()?ae()(e).toggleClass("open"):ae()(e).slideToggle()}},{key:"render",value:function(){var e=this,t=this.props.intl.formatMessage,a=this.props.theme,n=[],s=[],i=[];d.D.THEME_ELEMENTS.forEach(function(r,o){if("codeTheme"===r.id){var l=[],u="";r.themes.forEach(function(e,t){e.id===a[r.id]&&(u=e.iconURL),l.push(c.a.createElement("option",{key:"code-theme-key"+t,value:e.id},e.uiName))});var d=c.a.createElement(re.a,{bsStyle:"info",id:"code-popover",className:"code-popover"},c.a.createElement("img",{width:"200",src:u}));s.push(c.a.createElement("div",{className:"col-sm-6 form-group",key:"custom-theme-key"+o},c.a.createElement("label",{className:"custom-label"},t(Pe[r.id])),c.a.createElement("div",{className:"input-group theme-group group--code dropdown",id:r.id},c.a.createElement("select",{className:"form-control",type:"text",defaultValue:a[r.id]},l),c.a.createElement(oe.a,{trigger:["hover","focus"],placement:"top",overlay:d,ref:"headerOverlay"},c.a.createElement("span",{className:"input-group-addon"},c.a.createElement("img",{src:u}))))))}else if("centerChannelElements"===r.group)s.push(c.a.createElement("div",{className:"col-sm-6 form-group element",key:"custom-theme-key"+o},c.a.createElement(we,{id:r.id,label:t(Pe[r.id]),color:a[r.id],onChange:e.handleColorChange})));else if("sidebarElements"===r.group){var m=a[r.id];m||"mentionBg"!==r.id||(m=a.mentionBj),n.push(c.a.createElement("div",{className:"col-sm-6 form-group element",key:"custom-theme-key"+o},c.a.createElement(we,{id:r.id,label:t(Pe[r.id]),color:m,onChange:e.handleColorChange})))}else i.push(c.a.createElement("div",{className:"col-sm-6 form-group element",key:"custom-theme-key"+o},c.a.createElement(we,{id:r.id,label:t(Pe[r.id]),color:a[r.id],onChange:e.handleColorChange})))});var r=c.a.createElement("div",{className:"col-sm-12"},c.a.createElement("label",{className:"custom-label"},c.a.createElement(m.c,{id:"user.settings.custom_theme.copyPaste",defaultMessage:"Copy and paste to share theme colors:"})),c.a.createElement("textarea",{ref:"textarea",className:"form-control",value:this.state.copyTheme,onPaste:this.pasteBoxChange,onChange:this.onChangeHandle,onClick:this.selectTheme}));return c.a.createElement("div",{className:"appearance-section padding-top"},c.a.createElement("div",{className:"theme-elements row"},c.a.createElement("div",{ref:"sidebarStylesHeader",className:"theme-elements__header",onClick:this.toggleSidebarStyles},c.a.createElement(m.c,{id:"user.settings.custom_theme.sidebarTitle",defaultMessage:"Sidebar Styles"}),c.a.createElement("div",{className:"header__icon"},c.a.createElement("i",{className:"fa fa-plus",title:Object(h.localizeMessage)("generic_icons.expand","Expand Icon")}),c.a.createElement("i",{className:"fa fa-minus",title:Object(h.localizeMessage)("generic_icons.collapse","Collapse Icon")}))),c.a.createElement("div",{ref:"sidebarStyles",className:"theme-elements__body"},n)),c.a.createElement("div",{className:"theme-elements row"},c.a.createElement("div",{ref:"centerChannelStylesHeader",className:"theme-elements__header",onClick:this.toggleCenterChannelStyles},c.a.createElement(m.c,{id:"user.settings.custom_theme.centerChannelTitle",defaultMessage:"Center Channel Styles"}),c.a.createElement("div",{className:"header__icon"},c.a.createElement("i",{className:"fa fa-plus",title:Object(h.localizeMessage)("generic_icons.expand","Expand Icon")}),c.a.createElement("i",{className:"fa fa-minus",title:Object(h.localizeMessage)("generic_icons.collapse","Collapse Icon")}))),c.a.createElement("div",{ref:"centerChannelStyles",className:"theme-elements__body"},s)),c.a.createElement("div",{className:"theme-elements row form-group"},c.a.createElement("div",{ref:"linkAndButtonStylesHeader",className:"theme-elements__header",onClick:this.toggleLinkAndButtonStyles},c.a.createElement(m.c,{id:"user.settings.custom_theme.linkButtonTitle",defaultMessage:"Link and Button Styles"}),c.a.createElement("div",{className:"header__icon"},c.a.createElement("i",{className:"fa fa-plus",title:Object(h.localizeMessage)("generic_icons.expand","Expand Icon")}),c.a.createElement("i",{className:"fa fa-minus",title:Object(h.localizeMessage)("generic_icons.collapse","Collapse Icon")}))),c.a.createElement("div",{ref:"linkAndButtonStyles",className:"theme-elements__body"},i)),c.a.createElement("div",{className:"row"},r))}}]),t}();Re.propTypes={intl:m.i.isRequired,theme:r.a.object.isRequired,updateTheme:r.a.func.isRequired};var Ie=Object(m.h)(Re);a(235);function De(e){return(De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Le(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ue(e,t){return!t||"object"!==De(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xe(e){return(xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Fe(e,t){return(Fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qe=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ue(this,xe(t).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fe(e,t)}(t,c.a.Component),function(e,t,a){t&&Le(e.prototype,t),a&&Le(e,a)}(t,[{key:"render",value:function(){var e=this,t=this.props.theme,a=[],n=this.props.allowedThemes,s=n.length>1||n[0]&&n[0].trim().length>0;for(var i in d.D.THEMES){if(d.D.THEMES.hasOwnProperty(i))if("continue"===function(){if(s&&n.indexOf(i)<0)return"continue";var r=ae.a.extend(!0,{},d.D.THEMES[i]),o="";r.type===t.type&&(o="active"),a.push(c.a.createElement("div",{className:"col-xs-6 col-sm-3 premade-themes",key:"premade-theme-key"+i},c.a.createElement("div",{className:o,onClick:function(){return e.props.updateTheme(r)}},c.a.createElement("label",null,c.a.createElement("img",{className:"img-responsive",src:r.image}),c.a.createElement("div",{className:"theme-label"},h.toTitleCase(r.type))))))}())continue}return c.a.createElement("div",{className:"row appearance-section"},c.a.createElement("div",{className:"clearfix"},a))}}]),t}();qe.propTypes={theme:r.a.object.isRequired,updateTheme:r.a.func.isRequired,allowedThemes:r.a.arrayOf(r.a.string)},qe.defaultProps={allowedThemes:[]};var ze=Object(n.connect)(function(e){var t=Object(l.getConfig)(e);return{allowedThemes:t.AllowedThemes&&t.AllowedThemes.split(",")||[]}})(qe);function Ge(e){return(Ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Be(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){Ke(e,t,a[t])})}return e}function Ve(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function He(e){return(He=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ye(e,t){return(Ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function We(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ke(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Je=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ke(We(We(a=function(e,t){return!t||"object"!==Ge(t)&&"function"!=typeof t?We(e):t}(this,He(t).call(this,e)))),"submitTheme",function(){var e=a.state.applyToAllTeams?"":a.props.currentTeamId;a.setState({isSaving:!0}),p.C(e,a.state.theme,function(){a.props.setRequireConfirm(!1),a.originalTheme=Object.assign({},a.state.theme),a.scrollToTop(),a.props.updateSection(""),a.setState({isSaving:!1})})}),Ke(We(We(a)),"updateTheme",function(e){var t=a.state.theme.length===e.length;if(!t)for(var n in e)if(e.hasOwnProperty(n)&&a.state.theme[n]!==e[n]){t=!0;break}a.props.setRequireConfirm(t),a.setState({theme:e}),h.applyTheme(e)}),Ke(We(We(a)),"resetFields",function(){var e=a.getStateFromProps();e.serverError=null,a.setState(e),a.scrollToTop(),h.applyTheme(e.theme),a.props.setRequireConfirm(!1)}),Ke(We(We(a)),"handleImportModal",function(){ie.a.handleViewAction({type:d.a.TOGGLE_IMPORT_THEME_MODAL,value:!0,callback:a.updateTheme}),a.props.setEnforceFocus(!1)}),Ke(We(We(a)),"handleUpdateSection",function(e){a.props.updateSection(e)}),a.state=Be({},a.getStateFromProps(e),{isSaving:!1}),a.originalTheme=Object.assign({},a.state.theme),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ye(e,t)}(t,c.a.Component),function(e,t,a){t&&Ve(e.prototype,t),a&&Ve(e,a)}(t,[{key:"componentDidMount",value:function(){this.props.selected&&ae()(se.a.findDOMNode(this.refs[this.state.theme])).addClass("active-border")}},{key:"componentDidUpdate",value:function(){this.props.selected&&(ae()(".color-btn").removeClass("active-border"),ae()(se.a.findDOMNode(this.refs[this.state.theme])).addClass("active-border"))}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){this.props.selected&&!e.selected&&this.resetFields()}},{key:"componentWillUnmount",value:function(){this.props.selected&&h.applyTheme(this.props.theme)}},{key:"getStateFromProps",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=Be({},e.theme);return t.codeTheme||(t.codeTheme=d.e.DEFAULT_CODE_THEME),{theme:t,type:t.type||"premade",showAllTeamsCheckbox:e.showAllTeamsCheckbox,applyToAllTeams:e.applyToAllTeams}}},{key:"scrollToTop",value:function(){ae()(".ps-container.modal-body").scrollTop(0)}},{key:"updateType",value:function(e){this.setState({type:e})}},{key:"render",value:function(){var e,t=this;this.state.serverError&&(e=this.state.serverError);var a,n,s,i="custom"===this.state.type;if(i&&this.props.allowCustomThemes?a=c.a.createElement("div",{key:"customThemeChooser"},c.a.createElement(Ie,{theme:this.state.theme,updateTheme:this.updateTheme})):n=c.a.createElement("div",{key:"premadeThemeChooser"},c.a.createElement("br",null),c.a.createElement(ze,{theme:this.state.theme,updateTheme:this.updateTheme})),this.props.selected){var r=[];this.props.allowCustomThemes&&r.push(c.a.createElement("div",{className:"radio",key:"premadeThemeColorLabel"},c.a.createElement("label",null,c.a.createElement("input",{id:"standardThemes",type:"radio",name:"theme",checked:!i,onChange:this.updateType.bind(this,"premade")}),c.a.createElement(m.c,{id:"user.settings.display.theme.themeColors",defaultMessage:"Theme Colors"})),c.a.createElement("br",null))),r.push(n),this.props.allowCustomThemes&&(r.push(c.a.createElement("div",{className:"radio",key:"customThemeColorLabel"},c.a.createElement("label",null,c.a.createElement("input",{id:"customThemes",type:"radio",name:"theme",checked:i,onChange:this.updateType.bind(this,"custom")}),c.a.createElement(m.c,{id:"user.settings.display.theme.customTheme",defaultMessage:"Custom Theme"})))),r.push(a),r.push(c.a.createElement("div",{key:"otherThemes"},c.a.createElement("br",null),c.a.createElement("a",{id:"otherThemes",href:"http://docs.mattermost.com/help/settings/theme-colors.html#custom-theme-examples",target:"_blank",rel:"noopener noreferrer"},c.a.createElement(m.c,{id:"user.settings.display.theme.otherThemes",defaultMessage:"See other themes"})))),r.push(c.a.createElement("div",{key:"importSlackThemeButton",className:"padding-top"},c.a.createElement("a",{id:"slackImportTheme",className:"theme",onClick:this.handleImportModal},c.a.createElement(m.c,{id:"user.settings.display.theme.import",defaultMessage:"Import theme colors from Slack"})))));var o=null;this.state.showAllTeamsCheckbox&&(o=c.a.createElement("div",{className:"checkbox user-settings__submit-checkbox"},c.a.createElement("label",null,c.a.createElement("input",{id:"applyThemeToAllTeams",type:"checkbox",checked:this.state.applyToAllTeams,onChange:function(e){return t.setState({applyToAllTeams:e.target.checked})}}),c.a.createElement(m.c,{id:"user.settings.display.theme.applyToAllTeams",defaultMessage:"Apply new theme to all my teams"})))),s=c.a.createElement(g.a,{inputs:r,submitExtra:o,submit:this.submitTheme,saving:this.state.isSaving,server_error:e,width:"full",updateSection:this.handleUpdateSection})}else s=c.a.createElement(b.a,{title:c.a.createElement(m.c,{id:"user.settings.display.theme.title",defaultMessage:"Theme"}),describe:c.a.createElement(m.c,{id:"user.settings.display.theme.describe",defaultMessage:"Open to manage your theme"}),section:"theme",updateSection:this.handleUpdateSection});return s}}]),t}();Ke(Je,"propTypes",{currentTeamId:r.a.string.isRequired,theme:r.a.object,selected:r.a.bool.isRequired,updateSection:r.a.func.isRequired,setRequireConfirm:r.a.func.isRequired,setEnforceFocus:r.a.func.isRequired,allowCustomThemes:r.a.bool,showAllTeamsCheckbox:r.a.bool,applyToAllTeams:r.a.bool});var Xe=Object(n.connect)(function(){var e=Object(u.makeGetCategory)();return function(t){return{currentTeamId:Object(ee.getCurrentTeamId)(t),theme:Object(u.getTheme)(t),applyToAllTeams:e(t,d.q.CATEGORY_THEME).length<=1,showAllTeamsCheckbox:Object(ee.getMyTeamsCount)(t)>1}}})(Je),Qe=(a(96),a(670)),Ze=a(671),$e=(a(74),a(93),a(608)),et=a(596);function tt(e,t,a,n,s,i,r){try{var o=e[i](r),c=o.value}catch(e){return void a(e)}o.done?t(c):Promise.resolve(c).then(n,s)}function at(e){return function(){var t=this,a=arguments;return new Promise(function(n,s){var i=e.apply(t,a);function r(e){tt(i,n,s,r,o,"next",e)}function o(e){tt(i,n,s,r,o,"throw",e)}r(void 0)})}}function nt(e){return(nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function st(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function it(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function rt(e,t,a){return t&&it(e.prototype,t),a&&it(e,a),e}function ot(e,t){return!t||"object"!==nt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ct(e){return(ct=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lt(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ut(e,t)}function ut(e,t){return(ut=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var dt=function(e){function t(){return st(this,t),ot(this,ct(t).apply(this,arguments))}return lt(t,et["a"]),rt(t,[{key:"render",value:function(){var e=this.props,t=e.item,a="mentions__name";return e.isSelection&&(a+=" suggestion--selected"),c.a.createElement("div",Object.assign({onClick:this.handleClick,className:a},et.a.baseProps),t)}}]),t}(),mt=function(e){function t(){return st(this,t),ot(this,ct(t).apply(this,arguments))}return lt(t,$e["a"]),rt(t,[{key:"handlePretextChanged",value:function(e,t){return 0===t.length?(this.displayAllTimezones(e,t),!0):!!t&&(this.filterTimezones(e,t),!0)}},{key:"displayAllTimezones",value:function(){var e=at(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:setTimeout(function(){ie.a.handleServerAction({type:d.a.SUGGESTION_RECEIVED_SUGGESTIONS,id:t,matchedPretext:"",terms:Object(Q.c)(),items:Object(Q.c)(),component:dt})},0);case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"filterTimezones",value:function(){var e=at(regeneratorRuntime.mark(function e(t,a){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=Object(Q.c)().filter(function(e){return Object(X.getTimezoneRegion)(e).toLowerCase().indexOf(a)>=0||e.toLowerCase().indexOf(a)>=0}),setTimeout(function(){ie.a.handleServerAction({type:d.a.SUGGESTION_RECEIVED_SUGGESTIONS,id:t,matchedPretext:a,terms:n,items:n,component:dt})},0);case 2:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()}]),t}();function pt(e){return(pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ft(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ht(e){return(ht=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gt(e,t){return(gt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Et=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),vt(bt(bt(a=function(e,t){return!t||"object"!==pt(t)&&"function"!=typeof t?bt(e):t}(this,ht(t).call(this,e)))),"onChange",function(e){a.setState({manualTimezoneInput:e.target.value})}),vt(bt(bt(a)),"handleTimezoneSelected",function(e){e&&a.setState({manualTimezone:e,manualTimezoneInput:e})}),vt(bt(bt(a)),"timezoneNotChanged",function(){var e=a.state,t=e.useAutomaticTimezone,n=e.automaticTimezone,s=e.manualTimezone,i=a.props,r=i.useAutomaticTimezone,o=i.automaticTimezone,c=i.manualTimezone;return t===r&&n===o&&s===c}),vt(bt(bt(a)),"changeTimezone",function(){a.timezoneNotChanged()?a.props.updateSection(""):a.submitUser()}),vt(bt(bt(a)),"submitUser",function(){var e=a.props.user,t=a.state,n=t.useAutomaticTimezone,s=t.automaticTimezone,i=t.manualTimezone,r=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){vt(e,t,a[t])})}return e}({},e,{timezone:{useAutomaticTimezone:n.toString(),automaticTimezone:s,manualTimezone:i}});Object(p.J)(r,function(){return a.props.updateSection("")},function(e){var t;t=e.message?e.message:e,a.setState({serverError:t,isSaving:!1})})}),vt(bt(bt(a)),"handleAutomaticTimezone",function(e){var t=e.target.checked,n="";t&&(n=Object(Q.a)()),a.setState({useAutomaticTimezone:t,automaticTimezone:n})}),vt(bt(bt(a)),"handleManualTimezone",function(e){a.setState({manualTimezone:e.target.value})}),a.state={useAutomaticTimezone:e.useAutomaticTimezone,automaticTimezone:e.automaticTimezone,manualTimezone:e.manualTimezone,manualTimezoneInput:e.manualTimezone,isSaving:!1},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gt(e,t)}(t,c.a.PureComponent),function(e,t,a){t&&ft(e.prototype,t),a&&ft(e,a)}(t,[{key:"render",value:function(){var e,t=this.props.timezones,a=this.state,n=a.useAutomaticTimezone,s=a.automaticTimezone;this.state.serverError&&(e=c.a.createElement("label",{className:"has-error"},this.state.serverError));var i=[],r=c.a.createElement("div",{className:"section-describe padding-top"},n&&Object(X.getTimezoneRegion)(s)),o=0===t.length,l=c.a.createElement("div",{className:"checkbox"},c.a.createElement("label",null,c.a.createElement("input",{id:"automaticTimezoneInput",type:"checkbox",checked:n,onChange:this.handleAutomaticTimezone,disabled:o}),c.a.createElement(m.c,{id:"user.settings.timezones.automatic",defaultMessage:"Set automatically"}),r)),u=[new mt],d=c.a.createElement("div",{key:"changeTimezone"},c.a.createElement("label",{className:"control-label"},c.a.createElement(m.c,{id:"user.settings.timezones.change",defaultMessage:"Change timezone"})),c.a.createElement("div",{className:"padding-top"},c.a.createElement(Qe.a,{ref:this.setSwitchBoxRef,className:"form-control focused",type:"search",onChange:this.onChange,value:this.state.manualTimezoneInput,onItemSelected:this.handleTimezoneSelected,listComponent:Ze.a,maxLength:"64",requiredCharacters:0,providers:u,listStyle:"bottom",completeOnTab:!1,renderDividers:!1,openOnFocus:!0,disabled:o}),e));return i.push(l),n||i.push(d),i.push(c.a.createElement("div",null,c.a.createElement("br",null),c.a.createElement(m.b,{id:"user.settings.timezones.promote",defaultMessage:"Select the time zone used for timestamps in the user interface and email notifications."}))),c.a.createElement(g.a,{title:c.a.createElement(m.c,{id:"user.settings.display.timezone",defaultMessage:"Timezone"}),containerStyle:"timezone-container",width:"medium",submit:this.changeTimezone,saving:this.state.isSaving,inputs:i,updateSection:this.props.updateSection})}}]),t}();Et.propTypes={user:r.a.object.isRequired,updateSection:r.a.func.isRequired,useAutomaticTimezone:r.a.bool.isRequired,automaticTimezone:r.a.string.isRequired,manualTimezone:r.a.string.isRequired,timezones:r.a.array.isRequired};var yt=a(550);function St(e){return(St="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _t(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ot(e){return(Ot=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kt(e,t){return(kt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Nt=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Mt(wt(wt(a=function(e,t){return!t||"object"!==St(t)&&"function"!=typeof t?wt(e):t}(this,Ot(t).call(this,e)))),"setLanguage",function(e){a.setState({locale:e.target.value})}),Mt(wt(wt(a)),"changeLanguage",function(){a.props.user.locale===a.state.locale?a.props.updateSection(""):a.submitUser(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){Mt(e,t,a[t])})}return e}({},a.props.user,{locale:a.state.locale}))}),Mt(wt(wt(a)),"submitUser",function(e){a.setState({isSaving:!0}),Object(p.J)(e,function(){},function(e){var t;t=e.message?e.message:e,a.setState({serverError:t,isSaving:!1})})}),a.state={locale:e.locale,isSaving:!1},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kt(e,t)}(t,c.a.Component),function(e,t,a){t&&_t(e.prototype,t),a&&_t(e,a)}(t,[{key:"render",value:function(){var e;this.state.serverError&&(e=c.a.createElement("label",{className:"has-error"},this.state.serverError));var t=[],a=Z.d();Object.keys(a).map(function(e){return{value:a[e].value,name:a[e].name,order:a[e].order}}).sort(function(e,t){return e.order-t.order}).forEach(function(e){t.push(c.a.createElement("option",{key:e.value,value:e.value},e.name))});var n=c.a.createElement("div",{key:"changeLanguage"},c.a.createElement("br",null),c.a.createElement("label",{className:"control-label"},c.a.createElement(m.c,{id:"user.settings.languages.change",defaultMessage:"Change interface language"})),c.a.createElement("div",{className:"padding-top"},c.a.createElement("select",{id:"displayLanguage",ref:"language",className:"form-control",value:this.state.locale,onChange:this.setLanguage},t),e),c.a.createElement("div",null,c.a.createElement("br",null),c.a.createElement(yt.a,{id:"user.settings.languages.promote",defaultMessage:"Select which language Mattermost displays in the user interface.\\n \\nWould you like to help with translations? Join the [Mattermost Translation Server](!http://translate.mattermost.com/) to contribute."})));return c.a.createElement(g.a,{title:c.a.createElement(m.c,{id:"user.settings.display.language",defaultMessage:"Language"}),width:"medium",submit:this.changeLanguage,saving:this.state.isSaving,inputs:[n],updateSection:this.props.updateSection})}}]),t}();function Tt(e){return(Tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ct(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{},n=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),n.forEach(function(t){It(e,t,a[t])})}return e}function At(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function jt(e){return(jt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pt(e,t){return(Pt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function It(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}Nt.propTypes={user:r.a.object.isRequired,locale:r.a.string.isRequired,updateSection:r.a.func.isRequired};var Dt=d.D.Preferences;function Lt(e){return{militaryTime:e.militaryTime,teammateNameDisplay:e.teammateNameDisplay,channelDisplayMode:e.channelDisplayMode,messageDisplay:e.messageDisplay,collapseDisplay:e.collapseDisplay,linkPreviewDisplay:e.linkPreviewDisplay}}var Ut=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),It(Rt(Rt(a=function(e,t){return!t||"object"!==Tt(t)&&"function"!=typeof t?Rt(e):t}(this,jt(t).call(this,e)))),"handleSubmit",function(){var e=a.props.user.id,t={user_id:e,category:Dt.CATEGORY_DISPLAY_SETTINGS,name:Dt.USE_MILITARY_TIME,value:a.state.militaryTime},n={user_id:e,category:Dt.CATEGORY_DISPLAY_SETTINGS,name:Dt.NAME_NAME_FORMAT,value:a.state.teammateNameDisplay},s={user_id:e,category:Dt.CATEGORY_DISPLAY_SETTINGS,name:Dt.CHANNEL_DISPLAY_MODE,value:a.state.channelDisplayMode},i={user_id:e,category:Dt.CATEGORY_DISPLAY_SETTINGS,name:Dt.MESSAGE_DISPLAY,value:a.state.messageDisplay},r={user_id:e,category:Dt.CATEGORY_DISPLAY_SETTINGS,name:Dt.COLLAPSE_DISPLAY,value:a.state.collapseDisplay},o={user_id:e,category:Dt.CATEGORY_DISPLAY_SETTINGS,name:Dt.LINK_PREVIEW_DISPLAY,value:a.state.linkPreviewDisplay};a.setState({isSaving:!0});var c=[t,s,i,r,o,n];Object(p.B)(c,function(){a.updateSection("")})}),It(Rt(Rt(a)),"handleClockRadio",function(e){a.setState({militaryTime:e})}),It(Rt(Rt(a)),"handleTeammateNameDisplayRadio",function(e){a.setState({teammateNameDisplay:e})}),It(Rt(Rt(a)),"updateSection",function(e){a.updateState(),a.props.updateSection(e)}),It(Rt(Rt(a)),"updateState",function(){var e=Lt(a.props);h.areObjectsEqual(e,a.state)||a.setState(e),a.setState({isSaving:!1})}),a.state=Ct({},Lt(e),{isSaving:!1}),0===e.timezones.length&&e.actions.getSupportedTimezones(),a.prevSections={theme:"dummySectionName",clock:"theme",linkpreview:"clock",message_display:"linkpreview",channel_display_mode:"message_display",languages:"channel_display_mode"},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pt(e,t)}(t,c.a.Component),function(e,t,a){t&&At(e.prototype,t),a&&At(e,a)}(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.actions,a=e.enableTimezone,n=e.shouldAutoUpdateTimezone;a&&n&&t.autoUpdateTimezone(Object(Q.a)())}},{key:"handleChannelDisplayModeRadio",value:function(e){this.setState({channelDisplayMode:e})}},{key:"handlemessageDisplayRadio",value:function(e){this.setState({messageDisplay:e})}},{key:"handleCollapseRadio",value:function(e){this.setState({collapseDisplay:e})}},{key:"handleLinkPreviewRadio",value:function(e){this.setState({linkPreviewDisplay:e})}},{key:"handleOnChange",value:function(e){this.setState(Ct({},e))}},{key:"createSection",value:function(e){var t,a,n=this,s=e.section,i=e.display,r=e.value,o=e.title,l=e.firstOption,u=e.secondOption,d=e.thirdOption,p=e.description,f=c.a.createElement(m.c,{id:l.radionButtonText.id,defaultMessage:l.radionButtonText.message});l.radionButtonText.moreId&&(t=": ",a=c.a.createElement("span",{className:"font-weight--normal"},c.a.createElement(m.c,{id:l.radionButtonText.moreId,defaultMessage:l.radionButtonText.moreMessage})));var h,v,E=c.a.createElement(m.c,{id:u.radionButtonText.id,defaultMessage:u.radionButtonText.message});u.radionButtonText.moreId&&(h=c.a.createElement("span",{className:"font-weight--normal"},c.a.createElement(m.c,{id:u.radionButtonText.moreId,defaultMessage:u.radionButtonText.moreMessage}))),d&&(v=c.a.createElement(m.c,{id:d.radionButtonText.id,defaultMessage:d.radionButtonText.message}));var y,S=c.a.createElement(m.c,{id:o.id,defaultMessage:o.message}),_=c.a.createElement(m.c,{id:p.id,defaultMessage:p.message});if(this.props.activeSection===s){var O=[!1,!1,!1];r===l.value?O[0]=!0:r===u.value?O[1]=!0:O[2]=!0;var k=s+"Format",w=s+"UserDisplay",M={};M[i]=l.value;var N={};N[i]=u.value;var T,C={};d&&(C[i]=d.value),v&&(T=c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:k+"C",type:"radio",name:k,checked:O[2],onChange:function(){return n.handleOnChange(C)}}),v),c.a.createElement("br",null)));var A=[c.a.createElement("div",{key:w},c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:k+"A",type:"radio",name:k,checked:O[0],onChange:function(){return n.handleOnChange(M)}}),f,t,a),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:k+"B",type:"radio",name:k,checked:O[1],onChange:function(){return n.handleOnChange(N)}}),E,t,h),c.a.createElement("br",null)),T,c.a.createElement("div",null,c.a.createElement("br",null),_))];return c.a.createElement("div",null,c.a.createElement(g.a,{title:S,inputs:A,submit:this.handleSubmit,saving:this.state.isSaving,server_error:this.state.serverError,updateSection:this.updateSection}),c.a.createElement("div",{className:"divider-dark"}))}return y=r===l.value?f:r===u.value?E:v,c.a.createElement("div",null,c.a.createElement(b.a,{title:S,describe:y,focused:this.props.prevActiveSection===this.prevSections[s],section:s,updateSection:this.updateSection}),c.a.createElement("div",{className:"divider-dark"}))}},{key:"render",value:function(){var e=this.createSection({section:"collapse",display:"collapseDisplay",value:this.state.collapseDisplay,defaultDisplay:"false",title:{id:Object($.b)("user.settings.display.collapseDisplay"),message:"Default appearance of image previews"},firstOption:{value:"false",radionButtonText:{id:Object($.b)("user.settings.display.collapseOn"),message:"On"}},secondOption:{value:"true",radionButtonText:{id:Object($.b)("user.settings.display.collapseOff"),message:"Off"}},description:{id:Object($.b)("user.settings.display.collapseDesc"),message:"Set whether previews of image links and image attachment thumbnails show as expanded or collapsed by default. This setting can also be controlled using the slash commands /expand and /collapse."}}),t=null;this.props.enableLinkPreviews?(t=this.createSection({section:"linkpreview",display:"linkPreviewDisplay",value:this.state.linkPreviewDisplay,defaultDisplay:"true",title:{id:Object($.b)("user.settings.display.linkPreviewDisplay"),message:"Website Link Previews"},firstOption:{value:"true",radionButtonText:{id:Object($.b)("user.settings.display.linkPreviewOn"),message:"On"}},secondOption:{value:"false",radionButtonText:{id:Object($.b)("user.settings.display.linkPreviewOff"),message:"Off"}},description:{id:Object($.b)("user.settings.display.linkPreviewDesc"),message:"When available, the first web link in a message will show a preview of the website content below the message."}}),this.prevSections.message_display="linkpreview"):this.prevSections.message_display=this.prevSections.linkpreview;var a,n=this.createSection({section:"clock",display:"militaryTime",value:this.state.militaryTime,defaultDisplay:"false",title:{id:Object($.b)("user.settings.display.clockDisplay"),message:"Clock Display"},firstOption:{value:"false",radionButtonText:{id:Object($.b)("user.settings.display.normalClock"),message:"12-hour clock (example: 4:00 PM)"}},secondOption:{value:"true",radionButtonText:{id:Object($.b)("user.settings.display.militaryClock"),message:"24-hour clock (example: 16:00)"}},description:{id:Object($.b)("user.settings.display.preferTime"),message:"Select how you prefer time displayed."}}),s=this.createSection({section:Dt.NAME_NAME_FORMAT,display:"teammateNameDisplay",value:this.state.teammateNameDisplay,defaultDisplay:this.props.configTeammateNameDisplay,title:{id:Object($.b)("user.settings.display.teammateNameDisplayTitle"),message:"Teammate Name Display"},firstOption:{value:d.D.TEAMMATE_NAME_DISPLAY.SHOW_USERNAME,radionButtonText:{id:Object($.b)("user.settings.display.teammateNameDisplayUsername"),message:"Show username"}},secondOption:{value:d.D.TEAMMATE_NAME_DISPLAY.SHOW_NICKNAME_FULLNAME,radionButtonText:{id:Object($.b)("user.settings.display.teammateNameDisplayNicknameFullname"),message:"Show nickname if one exists, otherwise show first and last name"}},thirdOption:{value:d.D.TEAMMATE_NAME_DISPLAY.SHOW_FULLNAME,radionButtonText:{id:Object($.b)("user.settings.display.teammateNameDisplayFullname"),message:"Show first and last name"}},description:{id:Object($.b)("user.settings.display.teammateNameDisplayDescription"),message:"Set how to display other user's names in posts and the Direct Messages list."}});if(this.props.enableTimezone&&!this.props.shouldAutoUpdateTimezone){var i=this.props.userTimezone;a="timezone"===this.props.activeSection?c.a.createElement("div",null,c.a.createElement(Et,{user:this.props.user,timezones:this.props.timezones,useAutomaticTimezone:i.useAutomaticTimezone,automaticTimezone:i.automaticTimezone,manualTimezone:i.manualTimezone,updateSection:this.updateSection}),c.a.createElement("div",{className:"divider-dark"})):c.a.createElement("div",null,c.a.createElement(b.a,{title:c.a.createElement(m.c,{id:"user.settings.display.timezone",defaultMessage:"Timezone"}),width:"medium",describe:Object(X.getTimezoneRegion)(this.props.currentUserTimezone),section:"timezone",updateSection:this.updateSection}),c.a.createElement("div",{className:"divider-dark"}))}var r,o,l,u=this.createSection({section:Dt.MESSAGE_DISPLAY,display:"messageDisplay",value:this.state.messageDisplay,defaultDisplay:Dt.MESSAGE_DISPLAY_CLEAN,title:{id:Object($.b)("user.settings.display.messageDisplayTitle"),message:"Message Display"},firstOption:{value:Dt.MESSAGE_DISPLAY_CLEAN,radionButtonText:{id:Object($.b)("user.settings.display.messageDisplayClean"),message:"Standard",moreId:Object($.b)("user.settings.display.messageDisplayCleanDes"),moreMessage:"Easy to scan and read."}},secondOption:{value:Dt.MESSAGE_DISPLAY_COMPACT,radionButtonText:{id:Object($.b)("user.settings.display.messageDisplayCompact"),message:"Compact",moreId:Object($.b)("user.settings.display.messageDisplayCompactDes"),moreMessage:"Fit as many messages on the screen as we can."}},description:{id:Object($.b)("user.settings.display.messageDisplayDescription"),message:"Select how messages in a channel should be displayed."}}),p=this.createSection({section:Dt.CHANNEL_DISPLAY_MODE,display:"channelDisplayMode",value:this.state.channelDisplayMode,defaultDisplay:Dt.CHANNEL_DISPLAY_MODE_FULL_SCREEN,title:{id:Object($.b)("user.settings.display.channelDisplayTitle"),message:"Channel Display Mode"},firstOption:{value:Dt.CHANNEL_DISPLAY_MODE_FULL_SCREEN,radionButtonText:{id:Object($.b)("user.settings.display.fullScreen"),message:"Full width"}},secondOption:{value:Dt.CHANNEL_DISPLAY_MODE_CENTERED,radionButtonText:{id:Object($.b)("user.settings.display.fixedWidthCentered"),message:"Fixed width, centered"}},description:{id:Object($.b)("user.settings.display.channeldisplaymode"),message:"Select the width of the center channel."}}),f=this.props.user.locale;"languages"===this.props.activeSection?(Z.e(f)||(f=this.props.defaultClientLocale),r=c.a.createElement("div",null,c.a.createElement(Nt,{user:this.props.user,locale:f,updateSection:this.updateSection}),c.a.createElement("div",{className:"divider-dark"}))):(o=Z.e(f)?Z.c(f).name:Z.c(this.props.defaultClientLocale).name,r=c.a.createElement("div",null,c.a.createElement(b.a,{title:c.a.createElement(m.c,{id:"user.settings.display.language",defaultMessage:"Language"}),width:"medium",describe:o,focused:this.props.prevActiveSection===this.prevSections.languages,section:"languages",updateSection:this.updateSection}),c.a.createElement("div",{className:"divider-dark"})));return 1===Object.keys(Z.d()).length&&(r=null),this.props.enableThemeSelection&&(l=c.a.createElement("div",null,c.a.createElement(Xe,{selected:"theme"===this.props.activeSection,updateSection:this.updateSection,setRequireConfirm:this.props.setRequireConfirm,setEnforceFocus:this.props.setEnforceFocus,allowCustomThemes:this.props.allowCustomThemes}),c.a.createElement("div",{className:"divider-dark"}))),c.a.createElement("div",{id:"displaySettings"},c.a.createElement("div",{className:"modal-header"},c.a.createElement("button",{id:"closeButton",type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:this.props.closeModal},c.a.createElement("span",{"aria-hidden":"true"},"×")),c.a.createElement("h4",{className:"modal-title",ref:"title"},c.a.createElement("div",{className:"modal-back"},c.a.createElement("i",{className:"fa fa-angle-left",title:h.localizeMessage("generic_icons.back","Back Icon"),onClick:this.props.collapseModal})),c.a.createElement(m.c,{id:"user.settings.display.title",defaultMessage:"Display Settings"}))),c.a.createElement("div",{className:"user-settings"},c.a.createElement("h3",{id:"displaySettingsTitle",className:"tab-header"},c.a.createElement(m.c,{id:"user.settings.display.title",defaultMessage:"Display Settings"})),c.a.createElement("div",{className:"divider-dark first"}),l,n,s,a,t,e,u,p,r))}}]),t}();It(Ut,"propTypes",{user:r.a.object,updateSection:r.a.func,activeSection:r.a.string,prevActiveSection:r.a.string,closeModal:r.a.func.isRequired,collapseModal:r.a.func.isRequired,setRequireConfirm:r.a.func.isRequired,setEnforceFocus:r.a.func.isRequired,timezones:r.a.array.isRequired,userTimezone:r.a.object.isRequired,allowCustomThemes:r.a.bool,enableLinkPreviews:r.a.bool,defaultClientLocale:r.a.string,enableThemeSelection:r.a.bool,configTeammateNameDisplay:r.a.string,currentUserTimezone:r.a.string,enableTimezone:r.a.bool,shouldAutoUpdateTimezone:r.a.bool,militaryTime:r.a.string,teammateNameDisplay:r.a.string,channelDisplayMode:r.a.string,messageDisplay:r.a.string,collapseDisplay:r.a.string,linkPreviewDisplay:r.a.string,actions:r.a.shape({getSupportedTimezones:r.a.func.isRequired,autoUpdateTimezone:r.a.func.isRequired}).isRequired});var xt=Object(n.connect)(function(e){var t=Object(l.getConfig)(e),a=Object(l.getSupportedTimezones)(e),n=Object(s.getCurrentUserId)(e),i=Object(J.getUserTimezone)(e,n),r=i&&i.useAutomaticTimezone&&!i.automaticTimezone,o=!i||r,c="true"===t.AllowCustomThemes,m="true"===t.EnableLinkPreviews,p=t.DefaultClientLocale,f="true"===t.EnableThemeSelection,h="true"===t.ExperimentalTimezone,g=t.TeammateNameDisplay;return{allowCustomThemes:c,configTeammateNameDisplay:g,enableLinkPreviews:m,defaultClientLocale:p,enableThemeSelection:f,enableTimezone:h,timezones:a,userTimezone:i,shouldAutoUpdateTimezone:o,currentUserTimezone:Object(X.getUserCurrentTimezone)(i),militaryTime:Object(u.get)(e,d.q.CATEGORY_DISPLAY_SETTINGS,d.q.USE_MILITARY_TIME,d.q.USE_MILITARY_TIME_DEFAULT),teammateNameDisplay:Object(u.get)(e,d.q.CATEGORY_DISPLAY_SETTINGS,d.q.NAME_NAME_FORMAT,g),channelDisplayMode:Object(u.get)(e,d.q.CATEGORY_DISPLAY_SETTINGS,d.q.CHANNEL_DISPLAY_MODE,d.q.CHANNEL_DISPLAY_MODE_DEFAULT),messageDisplay:Object(u.get)(e,d.q.CATEGORY_DISPLAY_SETTINGS,d.q.MESSAGE_DISPLAY,d.q.MESSAGE_DISPLAY_DEFAULT),collapseDisplay:Object(u.get)(e,d.q.CATEGORY_DISPLAY_SETTINGS,d.q.COLLAPSE_DISPLAY,d.q.COLLAPSE_DISPLAY_DEFAULT),linkPreviewDisplay:Object(u.get)(e,d.q.CATEGORY_DISPLAY_SETTINGS,d.q.LINK_PREVIEW_DISPLAY,d.q.LINK_PREVIEW_DISPLAY_DEFAULT)}},function(e){return{actions:Object(E.bindActionCreators)({getSupportedTimezones:W.getSupportedTimezones,autoUpdateTimezone:K.autoUpdateTimezone},e)}})(Ut),Ft=a(551),qt=(a(140),a(76)),zt=a(561),Gt=a(606),Bt=a(1075);function Vt(e){return(Vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ht(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Yt(e){return(Yt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Wt(e,t){return(Wt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Kt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Jt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Xt=Object(m.g)({usernameReserved:{id:Object($.b)("user.settings.general.usernameReserved"),defaultMessage:"This username is reserved, please choose a new one."},usernameRestrictions:{id:Object($.b)("user.settings.general.usernameRestrictions"),defaultMessage:"Username must begin with a letter, and contain between {min} to {max} lowercase characters made up of numbers, letters, and the symbols '.', '-', and '_'."},validEmail:{id:Object($.b)("user.settings.general.validEmail"),defaultMessage:"Please enter a valid email address."},emailMatch:{id:Object($.b)("user.settings.general.emailMatch"),defaultMessage:"The new emails you entered do not match."},validImage:{id:Object($.b)("user.settings.general.validImage"),defaultMessage:"Only BMP, JPG or PNG images may be used for profile pictures"},imageTooLarge:{id:Object($.b)("user.settings.general.imageTooLarge"),defaultMessage:"Unable to upload profile image. File is too large."},uploadImage:{id:Object($.b)("user.settings.general.uploadImage"),defaultMessage:"Click 'Edit' to upload an image."},uploadImageMobile:{id:Object($.b)("user.settings.general.mobile.uploadImage"),defaultMessage:"Click to upload an image."},fullName:{id:Object($.b)("user.settings.general.fullName"),defaultMessage:"Full Name"},nickname:{id:Object($.b)("user.settings.general.nickname"),defaultMessage:"Nickname"},username:{id:Object($.b)("user.settings.general.username"),defaultMessage:"Username"},profilePicture:{id:Object($.b)("user.settings.general.profilePicture"),defaultMessage:"Profile Picture"},close:{id:Object($.b)("user.settings.general.close"),defaultMessage:"Close"},position:{id:Object($.b)("user.settings.general.position"),defaultMessage:"Position"}}),Qt="dummySectionName",Zt="name",$t="username",ea="nickname",ta="position",aa="email",na=["image/jpeg","image/png","image/bmp"],sa=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Jt(Kt(Kt(a=function(e,t){return!t||"object"!==Vt(t)&&"function"!=typeof t?Kt(e):t}(this,Yt(t).call(this,e)))),"handleEmailVerificationError",function(){Gt.a.storeLastError({notification:!0,message:d.D.AnnouncementBarMessages.EMAIL_VERIFICATION_REQUIRED}),Gt.a.emitChange()}),Jt(Kt(Kt(a)),"handleEmailResend",function(e){a.setState({resendStatus:"sending",showSpinner:!0},function(){a.handleEmailVerificationError()}),a.props.actions.sendVerificationEmail(e).then(function(e){var t=e.data,n=e.error;t?a.setState({resendStatus:"success"}):n&&a.setState({resendStatus:"failure"})})}),Jt(Kt(Kt(a)),"createEmailResendLink",function(e){return a.state.showSpinner?c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{className:"fa-wrapper"},c.a.createElement("span",{className:"fa fa-spinner icon--rotate",title:h.localizeMessage("generic_icons.loading","Loading Icon")})),c.a.createElement(m.c,{id:"user.settings.general.sending",defaultMessage:"Sending"})):c.a.createElement("span",{className:"resend-verification-wrapper"},c.a.createElement("a",{onClick:function(){a.handleEmailResend(e),setTimeout(function(){a.setState({showSpinner:!1},function(){a.handleEmailVerificationError()})},500)}},c.a.createElement(m.c,{id:"user.settings.general.sendAgain",defaultMessage:"Send again"})))}),Jt(Kt(Kt(a)),"submitUsername",function(){var e=Object.assign({},a.props.user),t=a.state.username.trim().toLowerCase(),n=a.props.intl.formatMessage,s=h.isValidUsername(t);"Cannot use a reserved word as a username."!==s?s?a.setState({clientError:n(Xt.usernameRestrictions,{min:d.D.MIN_USERNAME_LENGTH,max:d.D.MAX_USERNAME_LENGTH}),serverError:""}):e.username!==t?(e.username=t,Object(zt.d)("settings","user_settings_update",{field:"username"}),a.submitUser(e,!1)):a.updateSection(""):a.setState({clientError:n(Xt.usernameReserved),serverError:""})}),Jt(Kt(Kt(a)),"submitNickname",function(){var e=Object.assign({},a.props.user),t=a.state.nickname.trim();e.nickname!==t?(e.nickname=t,Object(zt.d)("settings","user_settings_update",{field:"nickname"}),a.submitUser(e,!1)):a.updateSection("")}),Jt(Kt(Kt(a)),"submitName",function(){var e=Object.assign({},a.props.user),t=a.state.firstName.trim(),n=a.state.lastName.trim();e.first_name!==t||e.last_name!==n?(e.first_name=t,e.last_name=n,Object(zt.d)("settings","user_settings_update",{field:"fullname"}),a.submitUser(e,!1)):a.updateSection("")}),Jt(Kt(Kt(a)),"submitEmail",function(){var e=Object.assign({},a.props.user),t=a.state.email.trim().toLowerCase(),n=a.state.confirmEmail.trim().toLowerCase(),s=a.props.intl.formatMessage;t!==e.email||""!==n&&n!==e.email?""!==t&&Object(qt.isEmail)(t)?t===n?(e.email=t,Object(zt.d)("settings","user_settings_update",{field:"email"}),a.submitUser(e,!0)):a.setState({emailError:s(Xt.emailMatch),clientError:"",serverError:""}):a.setState({emailError:s(Xt.validEmail),clientError:"",serverError:""}):a.updateSection("")}),Jt(Kt(Kt(a)),"submitUser",function(e,t){a.setState({sectionIsSaving:!0}),Object(p.J)(e,function(){a.updateSection(""),a.props.actions.getMe(),a.props.sendEmailNotifications&&a.props.requireEmailVerification&&t&&(a.handleEmailVerificationError(),a.setState({emailChangeInProgress:!0}))},function(e){var t;t=e.message?e.message:e,a.setState({serverError:t,emailError:"",clientError:"",sectionIsSaving:!1})})}),Jt(Kt(Kt(a)),"submitPicture",function(e){if(e.preventDefault(),a.state.pictureFile&&a.submitActive){Object(zt.d)("settings","user_settings_update",{field:"picture"});var t=a.props.intl.formatMessage,n=a.state.pictureFile;na.includes(n.type)?n.size>a.props.maxFileSize?a.setState({clientError:t(Xt.imageTooLarge),serverError:""}):(a.setState({loadingPicture:!0}),Object(p.L)(n,function(){a.updateSection(""),a.submitActive=!1},function(e){var t=a.setupInitialState(a.props);t.serverError=e.message,a.setState(t)})):a.setState({clientError:t(Xt.validImage),serverError:""})}}),Jt(Kt(Kt(a)),"submitPosition",function(){var e=Object.assign({},a.props.user),t=a.state.position.trim();e.position!==t?(e.position=t,Object(zt.d)("settings","user_settings_update",{field:"position"}),a.submitUser(e,!1)):a.updateSection("")}),Jt(Kt(Kt(a)),"updateUsername",function(e){a.setState({username:e.target.value})}),Jt(Kt(Kt(a)),"updateFirstName",function(e){a.setState({firstName:e.target.value})}),Jt(Kt(Kt(a)),"updateLastName",function(e){a.setState({lastName:e.target.value})}),Jt(Kt(Kt(a)),"updateNickname",function(e){a.setState({nickname:e.target.value})}),Jt(Kt(Kt(a)),"updatePosition",function(e){a.setState({position:e.target.value})}),Jt(Kt(Kt(a)),"updateEmail",function(e){a.setState({email:e.target.value})}),Jt(Kt(Kt(a)),"updateConfirmEmail",function(e){a.setState({confirmEmail:e.target.value})}),Jt(Kt(Kt(a)),"updatePicture",function(e){e.target.files&&e.target.files[0]?(a.setState({pictureFile:e.target.files[0]}),a.submitActive=!0,a.setState({clientError:null})):a.setState({pictureFile:null})}),Jt(Kt(Kt(a)),"updateSection",function(e){var t=a.state.emailChangeInProgress;a.setState(Object.assign({},a.setupInitialState(a.props),{emailChangeInProgress:t,clientError:"",serverError:"",emailError:"",sectionIsSaving:!1})),a.submitActive=!1,a.props.updateSection(e)}),a.submitActive=!1,a.state=a.setupInitialState(e),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wt(e,t)}(t,c.a.Component),function(e,t,a){t&&Ht(e.prototype,t),a&&Ht(e,a)}(t,[{key:"setupInitialState",value:function(e){var t=e.user;return{username:t.username,firstName:t.first_name,lastName:t.last_name,nickname:t.nickname,position:t.position,originalEmail:t.email,email:"",confirmEmail:"",pictureFile:null,loadingPicture:!1,emailChangeInProgress:e.sendEmailNotifications&&e.requireEmailVerification&&!t.email_verified,sectionIsSaving:!1}}},{key:"createEmailSection",value:function(){var e;if("email"===this.props.activeSection){var t=this.props.sendEmailNotifications,a=this.props.requireEmailVerification,n=[],s=c.a.createElement(m.c,{id:"user.settings.general.emailHelp1",defaultMessage:"Email is used for sign-in, notifications, and password reset. Email requires verification if changed."});if(t)if(a){if(this.state.emailChangeInProgress){var i=this.props.user.email;i&&(s=c.a.createElement(c.a.Fragment,null,c.a.createElement(yt.a,{id:"user.settings.general.emailHelp4",defaultMessage:"A verification email was sent to {email}. \\nCannot find the email?",values:{email:i}}),this.createEmailResendLink(i)))}}else s=c.a.createElement(m.c,{id:"user.settings.general.emailHelp3",defaultMessage:"Email is used for sign-in, notifications, and password reset."});else s=c.a.createElement("div",{className:"setting-list__hint col-sm-12 text-danger"},c.a.createElement(m.c,{id:"user.settings.general.emailHelp2",defaultMessage:"Email has been disabled by your System Administrator. No notification emails will be sent until it is enabled."}));var r=null;""===this.props.user.auth_service?(n.push(c.a.createElement("div",{key:"currentEmailSetting"},c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{className:"col-sm-5 control-label"},c.a.createElement(m.c,{id:"user.settings.general.currentEmail",defaultMessage:"Current Email"})),c.a.createElement("div",{className:"col-sm-7"},c.a.createElement("label",{className:"control-label word-break--all text-left"},this.state.originalEmail))))),n.push(c.a.createElement("div",{key:"emailSetting"},c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{className:"col-sm-5 control-label"},c.a.createElement(m.c,{id:"user.settings.general.newEmail",defaultMessage:"New Email"})),c.a.createElement("div",{className:"col-sm-7"},c.a.createElement("input",{autoFocus:!0,id:"primaryEmail",className:"form-control",type:"email",onChange:this.updateEmail,value:this.state.email}))))),n.push(c.a.createElement("div",{key:"confirmEmailSetting"},c.a.createElement("div",{className:"form-group"},c.a.createElement("label",{className:"col-sm-5 control-label"},c.a.createElement(m.c,{id:"user.settings.general.confirmEmail",defaultMessage:"Confirm Email"})),c.a.createElement("div",{className:"col-sm-7"},c.a.createElement("input",{id:"confirmEmail",className:"form-control",type:"email",onChange:this.updateConfirmEmail,value:this.state.confirmEmail}))),s)),r=this.submitEmail):this.props.user.auth_service===d.D.GITLAB_SERVICE?n.push(c.a.createElement("div",{key:"oauthEmailInfo",className:"form-group"},c.a.createElement("div",{className:"setting-list__hint col-sm-12"},c.a.createElement(m.c,{id:"user.settings.general.emailGitlabCantUpdate",defaultMessage:"Login occurs through GitLab. Email cannot be updated. Email address used for notifications is {email}.",values:{email:this.state.originalEmail}})),s)):this.props.user.auth_service===d.D.GOOGLE_SERVICE?n.push(c.a.createElement("div",{key:"oauthEmailInfo",className:"form-group"},c.a.createElement("div",{className:"setting-list__hint col-sm-12"},c.a.createElement(m.c,{id:"user.settings.general.emailGoogleCantUpdate",defaultMessage:"Login occurs through Google Apps. Email cannot be updated. Email address used for notifications is {email}.",values:{email:this.state.originalEmail}})),s)):this.props.user.auth_service===d.D.OFFICE365_SERVICE?n.push(c.a.createElement("div",{key:"oauthEmailInfo",className:"form-group"},c.a.createElement("div",{className:"setting-list__hint col-sm-12"},c.a.createElement(m.c,{id:"user.settings.general.emailOffice365CantUpdate",defaultMessage:"Login occurs through Office 365. Email cannot be updated. Email address used for notifications is {email}.",values:{email:this.state.originalEmail}})),s)):this.props.user.auth_service===d.D.LDAP_SERVICE?n.push(c.a.createElement("div",{key:"oauthEmailInfo",className:"padding-bottom"},c.a.createElement("div",{className:"setting-list__hint col-sm-12"},c.a.createElement(m.c,{id:"user.settings.general.emailLdapCantUpdate",defaultMessage:"Login occurs through AD/LDAP. Email cannot be updated. Email address used for notifications is {email}.",values:{email:this.state.originalEmail}})))):this.props.user.auth_service===d.D.SAML_SERVICE&&n.push(c.a.createElement("div",{key:"oauthEmailInfo",className:"padding-bottom"},c.a.createElement("div",{className:"setting-list__hint col-sm-12"},c.a.createElement(m.c,{id:"user.settings.general.emailSamlCantUpdate",defaultMessage:"Login occurs through SAML. Email cannot be updated. Email address used for notifications is {email}.",values:{email:this.state.originalEmail}})),s)),e=c.a.createElement(g.a,{title:c.a.createElement(m.c,{id:"user.settings.general.email",defaultMessage:"Email"}),inputs:n,submit:r,saving:this.state.sectionIsSaving,serverError:this.state.serverError,clientError:this.state.emailError,updateSection:this.updateSection})}else{var o="";if(""===this.props.user.auth_service)if(this.state.emailChangeInProgress){var l=this.props.user.email;o=l?c.a.createElement(c.a.Fragment,null,c.a.createElement(m.b,{id:"user.settings.general.newAddress",defaultMessage:"Check your email to verify {email}",values:{email:l}})):c.a.createElement(m.c,{id:"user.settings.general.checkEmailNoAddress",defaultMessage:"Check your email to verify your new address"})}else o=this.props.user.email;else this.props.user.auth_service===d.D.GITLAB_SERVICE?o=c.a.createElement(m.c,{id:"user.settings.general.loginGitlab",defaultMessage:"Login done through GitLab ({email})",values:{email:this.state.originalEmail}}):this.props.user.auth_service===d.D.GOOGLE_SERVICE?o=c.a.createElement(m.c,{id:"user.settings.general.loginGoogle",defaultMessage:"Login done through Google Apps ({email})",values:{email:this.state.originalEmail}}):this.props.user.auth_service===d.D.OFFICE365_SERVICE?o=c.a.createElement(m.c,{id:"user.settings.general.loginOffice365",defaultMessage:"Login done through Office 365 ({email})",values:{email:this.state.originalEmail}}):this.props.user.auth_service===d.D.LDAP_SERVICE?o=c.a.createElement(m.c,{id:"user.settings.general.loginLdap",defaultMessage:"Login done through AD/LDAP ({email})",values:{email:this.state.originalEmail}}):this.props.user.auth_service===d.D.SAML_SERVICE&&(o=c.a.createElement(m.c,{id:"user.settings.general.loginSaml",defaultMessage:"Login done through SAML ({email})",values:{email:this.state.originalEmail}}));e=c.a.createElement(b.a,{title:c.a.createElement(m.c,{id:"user.settings.general.email",defaultMessage:"Email"}),describe:o,focused:this.props.prevActiveSection===ta,section:"email",updateSection:this.updateSection})}return e}},{key:"render",value:function(){var e=this,t=this.props.user,a=this.props.intl.formatMessage,n=null;this.state.clientError&&(n=this.state.clientError);var s,i=null;this.state.serverError&&(i=this.state.serverError);var r,o,l,u=[];if("name"===this.props.activeSection){var p,f=null;if("ldap"===this.props.user.auth_service&&(this.props.ldapFirstNameAttributeSet||this.props.ldapLastNameAttributeSet)||this.props.user.auth_service===d.D.SAML_SERVICE&&(this.props.samlFirstNameAttributeSet||this.props.samlLastNameAttributeSet))p=c.a.createElement("span",null,c.a.createElement(m.c,{id:"user.settings.general.field_handled_externally",defaultMessage:"This field is handled through your login provider. If you want to change it, you need to do so through your login provider."}));else{u.push(c.a.createElement("div",{key:"firstNameSetting",className:"form-group"},c.a.createElement("label",{className:"col-sm-5 control-label"},c.a.createElement(m.c,{id:"user.settings.general.firstName",defaultMessage:"First Name"})),c.a.createElement("div",{className:"col-sm-7"},c.a.createElement("input",{id:"firstName",autoFocus:!0,className:"form-control",type:"text",onChange:this.updateFirstName,value:this.state.firstName,onFocus:h.moveCursorToEnd})))),u.push(c.a.createElement("div",{key:"lastNameSetting",className:"form-group"},c.a.createElement("label",{className:"col-sm-5 control-label"},c.a.createElement(m.c,{id:"user.settings.general.lastName",defaultMessage:"Last Name"})),c.a.createElement("div",{className:"col-sm-7"},c.a.createElement("input",{id:"lastName",className:"form-control",type:"text",onChange:this.updateLastName,value:this.state.lastName}))));var v=c.a.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),this.updateSection(""),this.props.updateTab("notifications")}.bind(this)},c.a.createElement(m.c,{id:"user.settings.general.notificationsLink",defaultMessage:"Notifications"}));p=c.a.createElement("span",null,c.a.createElement(m.c,{id:"user.settings.general.notificationsExtra",defaultMessage:"By default, you will receive mention notifications when someone types your first name. Go to {notify} settings to change this default.",values:{notify:v}})),f=this.submitName}s=c.a.createElement(g.a,{title:a(Xt.fullName),inputs:u,submit:f,saving:this.state.sectionIsSaving,serverError:i,clientError:n,updateSection:this.updateSection,extraInfo:p})}else{var E="";t.first_name&&t.last_name?E=t.first_name+" "+t.last_name:t.first_name?E=t.first_name:t.last_name?E=t.last_name:(E=c.a.createElement(m.c,{id:"user.settings.general.emptyName",defaultMessage:"Click 'Edit' to add your full name"}),h.isMobile()&&(E=c.a.createElement(m.c,{id:"user.settings.general.mobile.emptyName",defaultMessage:"Click to add your full name"}))),s=c.a.createElement(b.a,{title:a(Xt.fullName),describe:E,focused:this.props.prevActiveSection===Qt,section:"name",updateSection:this.updateSection})}if("nickname"===this.props.activeSection){var y,S=null;if("ldap"===this.props.user.auth_service&&this.props.ldapNicknameAttributeSet||this.props.user.auth_service===d.D.SAML_SERVICE&&this.props.samlNicknameAttributeSet)y=c.a.createElement("span",null,c.a.createElement(m.c,{id:"user.settings.general.field_handled_externally",defaultMessage:"This field is handled through your login provider. If you want to change it, you need to do so though your login provider."}));else{var _=c.a.createElement(m.c,{id:"user.settings.general.nickname",defaultMessage:"Nickname"});h.isMobile()&&(_=""),u.push(c.a.createElement("div",{key:"nicknameSetting",className:"form-group"},c.a.createElement("label",{className:"col-sm-5 control-label"},_),c.a.createElement("div",{className:"col-sm-7"},c.a.createElement("input",{id:"nickname",autoFocus:!0,className:"form-control",type:"text",onChange:this.updateNickname,value:this.state.nickname,maxLength:d.D.MAX_NICKNAME_LENGTH,autoCapitalize:"off"})))),y=c.a.createElement("span",null,c.a.createElement(m.c,{id:"user.settings.general.nicknameExtra",defaultMessage:"Use Nickname for a name you might be called that is different from your first name and username. This is most often used when two or more people have similar sounding names and usernames."})),S=this.submitNickname}r=c.a.createElement(g.a,{title:a(Xt.nickname),inputs:u,submit:S,saving:this.state.sectionIsSaving,serverError:i,clientError:n,updateSection:this.updateSection,extraInfo:y})}else{var O="";t.nickname?O=t.nickname:(O=c.a.createElement(m.c,{id:"user.settings.general.emptyNickname",defaultMessage:"Click 'Edit' to add a nickname"}),h.isMobile()&&(O=c.a.createElement(m.c,{id:"user.settings.general.mobile.emptyNickname",defaultMessage:"Click to add a nickname"}))),r=c.a.createElement(b.a,{title:a(Xt.nickname),describe:O,focused:this.props.prevActiveSection===$t,section:"nickname",updateSection:this.updateSection})}if("username"===this.props.activeSection){var k,w=null;if(""===this.props.user.auth_service){var M=c.a.createElement(m.c,{id:"user.settings.general.username",defaultMessage:"Username"});h.isMobile()&&(M=""),u.push(c.a.createElement("div",{key:"usernameSetting",className:"form-group"},c.a.createElement("label",{className:"col-sm-5 control-label"},M),c.a.createElement("div",{className:"col-sm-7"},c.a.createElement("input",{id:"username",autoFocus:!0,maxLength:d.D.MAX_USERNAME_LENGTH,className:"form-control",type:"text",onChange:this.updateUsername,value:this.state.username,autoCapitalize:"off",onFocus:h.moveCursorToEnd})))),k=c.a.createElement("span",null,c.a.createElement(m.c,{id:"user.settings.general.usernameInfo",defaultMessage:"Pick something easy for teammates to recognize and recall."})),w=this.submitUsername}else k=c.a.createElement("span",null,c.a.createElement(m.c,{id:"user.settings.general.field_handled_externally",defaultMessage:"This field is handled through your login provider. If you want to change it, you need to do so though your login provider."}));o=c.a.createElement(g.a,{title:a(Xt.username),inputs:u,submit:w,saving:this.state.sectionIsSaving,serverError:i,clientError:n,updateSection:this.updateSection,extraInfo:k})}else o=c.a.createElement(b.a,{title:a(Xt.username),describe:this.props.user.username,focused:this.props.prevActiveSection===Zt,section:"username",updateSection:this.updateSection});if("position"===this.props.activeSection){var N,T=null;if("ldap"!==this.props.user.auth_service&&this.props.user.auth_service!==d.D.SAML_SERVICE||!this.props.positionAttributeSet){var C=c.a.createElement(m.c,{id:"user.settings.general.position",defaultMessage:"Position"});h.isMobile()&&(C=""),u.push(c.a.createElement("div",{key:"positionSetting",className:"form-group"},c.a.createElement("label",{className:"col-sm-5 control-label"},C),c.a.createElement("div",{className:"col-sm-7"},c.a.createElement("input",{id:"position",autoFocus:!0,className:"form-control",type:"text",onChange:this.updatePosition,value:this.state.position,maxLength:d.D.MAX_POSITION_LENGTH,autoCapitalize:"off",onFocus:h.moveCursorToEnd})))),N=c.a.createElement("span",null,c.a.createElement(m.c,{id:"user.settings.general.positionExtra",defaultMessage:"Use Position for your role or job title. This will be shown in your profile popover."})),T=this.submitPosition}else N=c.a.createElement("span",null,c.a.createElement(m.c,{id:"user.settings.general.field_handled_externally",defaultMessage:"This field is handled through your login provider. If you want to change it, you need to do so though your login provider."}));l=c.a.createElement(g.a,{title:a(Xt.position),inputs:u,submit:T,saving:this.state.sectionIsSaving,serverError:i,clientError:n,updateSection:this.updateSection,extraInfo:N})}else{var A="";t.position?A=t.position:(A=c.a.createElement(m.c,{id:"user.settings.general.emptyPosition",defaultMessage:"Click 'Edit' to add your job title / position"}),h.isMobile()&&(A=c.a.createElement(m.c,{id:"user.settings.general.mobile.emptyPosition",defaultMessage:"Click to add your job title / position"}))),l=c.a.createElement(b.a,{title:a(Xt.position),describe:A,focused:this.props.prevActiveSection===ea,section:"position",updateSection:this.updateSection})}var j,P=this.createEmailSection();if("picture"===this.props.activeSection)j=c.a.createElement(Bt.a,{title:a(Xt.profilePicture),onSubmit:this.submitPicture,src:h.imageURLForUser(t),serverError:i,clientError:n,updateSection:function(t){e.updateSection(""),t.preventDefault()},file:this.state.pictureFile,onFileChange:this.updatePicture,submitActive:this.submitActive,loadingPicture:this.state.loadingPicture,maxFileSize:this.props.maxFileSize});else{var R=a(Xt.uploadImage);h.isMobile()&&(R=a(Xt.uploadImageMobile)),t.last_picture_update&&(R=c.a.createElement(m.c,{id:"user.settings.general.imageUpdated",defaultMessage:"Image last updated {date}",values:{date:c.a.createElement(m.a,{value:new Date(t.last_picture_update),day:"2-digit",month:"short",year:"numeric"})}})),j=c.a.createElement(b.a,{title:a(Xt.profilePicture),describe:R,focused:this.props.prevActiveSection===aa,section:"picture",updateSection:this.updateSection})}return c.a.createElement("div",{id:"generalSettings"},c.a.createElement("div",{className:"modal-header"},c.a.createElement("button",{id:"closeUserSettings",type:"button",className:"close","data-dismiss":"modal","aria-label":a(Xt.close),onClick:this.props.closeModal},c.a.createElement("span",{"aria-hidden":"true"},"×")),c.a.createElement("h4",{className:"modal-title",ref:"title"},c.a.createElement("div",{className:"modal-back"},c.a.createElement("i",{className:"fa fa-angle-left",title:h.localizeMessage("generic_icons.collapse","Collapse Icon"),onClick:this.props.collapseModal})),c.a.createElement(m.c,{id:"user.settings.general.title",defaultMessage:"General Settings"}))),c.a.createElement("div",{className:"user-settings"},c.a.createElement("h3",{id:"generalSettingsTitle",className:"tab-header"},c.a.createElement(m.c,{id:"user.settings.general.title",defaultMessage:"General Settings"})),c.a.createElement("div",{className:"divider-dark first"}),s,c.a.createElement("div",{className:"divider-light"}),o,c.a.createElement("div",{className:"divider-light"}),r,c.a.createElement("div",{className:"divider-light"}),l,c.a.createElement("div",{className:"divider-light"}),P,c.a.createElement("div",{className:"divider-light"}),j,c.a.createElement("div",{className:"divider-dark"})))}}]),t}();Jt(sa,"propTypes",{intl:m.i.isRequired,user:r.a.object.isRequired,updateSection:r.a.func.isRequired,updateTab:r.a.func.isRequired,activeSection:r.a.string.isRequired,prevActiveSection:r.a.string.isRequired,closeModal:r.a.func.isRequired,collapseModal:r.a.func.isRequired,actions:r.a.shape({getMe:r.a.func.isRequired,sendVerificationEmail:r.a.func.isRequred}).isRequired,sendEmailNotifications:r.a.bool,requireEmailVerification:r.a.bool,maxFileSize:r.a.number,ldapFirstNameAttributeSet:r.a.bool,ldapLastNameAttributeSet:r.a.bool,samlFirstNameAttributeSet:r.a.bool,samlLastNameAttributeSet:r.a.bool,ldapNicknameAttributeSet:r.a.bool,samlNicknameAttributeSet:r.a.bool,positionAttributeSet:r.a.bool});var ia=Object(m.h)(sa);var ra=Object(n.connect)(function(e){var t=Object(l.getConfig)(e);return{sendEmailNotifications:"true"===t.SendEmailNotifications,requireEmailVerification:"true"===t.RequireEmailVerification,maxFileSize:parseInt(t.MaxFileSize,10),ldapFirstNameAttributeSet:"true"===t.LdapFirstNameAttributeSet,ldapLastNameAttributeSet:"true"===t.LdapLastNameAttributeSet,samlFirstNameAttributeSet:"true"===t.SamlFirstNameAttributeSet,samlLastNameAttributeSet:"true"===t.SamlLastNameAttributeSet,ldapNicknameAttributeSet:"true"===t.LdapNicknameAttributeSet,samlNicknameAttributeSet:"true"===t.SamlNicknameAttributeSet,positionAttributeSet:"true"===t.PositionAttributeSet}},function(e){return{actions:Object(E.bindActionCreators)({getMe:Ft.getMe,sendVerificationEmail:Ft.sendVerificationEmail},e)}})(ia);a(233);function oa(e){return(oa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ca(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function la(e){return(la=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ua(e,t){return(ua=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function da(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ma(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var pa=function(e){function t(){var e,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return ma(da(da(a=function(e,t){return!t||"object"!==oa(t)&&"function"!=typeof t?da(e):t}(this,(e=la(t)).call.apply(e,[this].concat(s))))),"handleMinUpdateSection",function(e){a.props.updateSection(e),a.props.cancel()}),ma(da(da(a)),"handleMaxUpdateSection",function(e){a.props.updateSection(e)}),ma(da(da(a)),"handleOnChange",function(e){var t=e.currentTarget.getAttribute("data-key"),n=e.currentTarget.getAttribute("data-value");a.props.setParentState(t,n)}),ma(da(da(a)),"buildMaximizedSetting",function(){var e,t=[],n=[!1,!1,!1];if(a.props.activity===d.m.MENTION?n[1]=!0:a.props.activity===d.m.NONE?n[2]=!0:n[0]=!0,a.props.activity!==d.m.NONE){var s=[!1,!1];"false"===a.props.sound?s[1]=!0:s[0]=!0,e=h.hasSoundOptions()?c.a.createElement("div",null,c.a.createElement("hr",null),c.a.createElement("label",null,c.a.createElement(m.c,{id:"user.settings.notifications.desktop.sound",defaultMessage:"Notification sound"})),c.a.createElement("br",null),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"soundOn",type:"radio",name:"notificationSounds",checked:s[0],"data-key":"desktopSound","data-value":"true",onChange:a.handleOnChange}),c.a.createElement(m.c,{id:"user.settings.notifications.on",defaultMessage:"On"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"soundOff",type:"radio",name:"notificationSounds",checked:s[1],"data-key":"desktopSound","data-value":"false",onChange:a.handleOnChange}),c.a.createElement(m.c,{id:"user.settings.notifications.off",defaultMessage:"Off"})),c.a.createElement("br",null)),c.a.createElement("br",null),c.a.createElement("span",null,c.a.createElement(m.c,{id:"user.settings.notifications.sounds_info",defaultMessage:"Notification sounds are available on IE11, Safari, Chrome and Mattermost Desktop Apps."}))):c.a.createElement("div",null,c.a.createElement("hr",null),c.a.createElement("label",null,c.a.createElement(m.c,{id:"user.settings.notifications.desktop.sound",defaultMessage:"Notification sound"})),c.a.createElement("br",null),c.a.createElement(m.c,{id:"user.settings.notifications.soundConfig",defaultMessage:"Please configure notification sounds in your browser settings"}))}return t.push(c.a.createElement("div",{key:"userNotificationLevelOption"},c.a.createElement("label",null,c.a.createElement(m.c,{id:"user.settings.notifications.desktop",defaultMessage:"Send desktop notifications"})),c.a.createElement("br",null),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"desktopNotificationAllActivity",type:"radio",name:"desktopNotificationLevel",checked:n[0],"data-key":"desktopActivity","data-value":d.m.ALL,onChange:a.handleOnChange}),c.a.createElement(m.c,{id:"user.settings.notifications.allActivity",defaultMessage:"For all activity"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"desktopNotificationMentions",type:"radio",name:"desktopNotificationLevel",checked:n[1],"data-key":"desktopActivity","data-value":d.m.MENTION,onChange:a.handleOnChange}),c.a.createElement(m.c,{id:"user.settings.notifications.onlyMentions",defaultMessage:"Only for mentions and direct messages"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"desktopNotificationNever",type:"radio",name:"desktopNotificationLevel",checked:n[2],"data-key":"desktopActivity","data-value":d.m.NONE,onChange:a.handleOnChange}),c.a.createElement(m.c,{id:"user.settings.notifications.never",defaultMessage:"Never"}))),c.a.createElement("br",null),c.a.createElement("span",null,c.a.createElement(m.c,{id:"user.settings.notifications.info",defaultMessage:"Desktop notifications are available on Edge, Firefox, Safari, Chrome and Mattermost Desktop Apps."})),e)),c.a.createElement(g.a,{title:h.localizeMessage("user.settings.notifications.desktop.title","Desktop notifications"),inputs:t,submit:a.props.submit,saving:a.props.saving,server_error:a.props.error,updateSection:a.handleMaxUpdateSection})}),ma(da(da(a)),"buildMinimizedSetting",function(){var e="";return e=a.props.activity===d.m.MENTION?h.hasSoundOptions()&&"false"!==a.props.sound?c.a.createElement(m.c,{id:"user.settings.notifications.desktop.mentionsSoundTimed",defaultMessage:"For mentions and direct messages, with sound, shown for {seconds} seconds",values:{seconds:d.D.DEFAULT_NOTIFICATION_DURATION/1e3}}):h.hasSoundOptions()&&"false"===a.props.sound?c.a.createElement(m.c,{id:"user.settings.notifications.desktop.mentionsNoSoundTimed",defaultMessage:"For mentions and direct messages, without sound, shown for {seconds} seconds",values:{seconds:d.D.DEFAULT_NOTIFICATION_DURATION/1e3}}):c.a.createElement(m.c,{id:"user.settings.notifications.desktop.mentionsSoundHiddenTimed",defaultMessage:"For mentions and direct messages, shown for {seconds} seconds",values:{seconds:d.D.DEFAULT_NOTIFICATION_DURATION/1e3}}):a.props.activity===d.m.NONE?c.a.createElement(m.c,{id:"user.settings.notifications.off",defaultMessage:"Off"}):h.hasSoundOptions()&&"false"!==a.props.sound?c.a.createElement(m.c,{id:"user.settings.notifications.desktop.allSoundTimed",defaultMessage:"For all activity, with sound, shown for {seconds} seconds",values:{seconds:d.D.DEFAULT_NOTIFICATION_DURATION/1e3}}):h.hasSoundOptions()&&"false"===a.props.sound?c.a.createElement(m.c,{id:"user.settings.notifications.desktop.allNoSoundTimed",defaultMessage:"For all activity, without sound, shown for {seconds} seconds",values:{seconds:d.D.DEFAULT_NOTIFICATION_DURATION/1e3}}):c.a.createElement(m.c,{id:"user.settings.notifications.desktop.allSoundHiddenTimed",defaultMessage:"For all activity, shown for {seconds} seconds",values:{seconds:d.D.DEFAULT_NOTIFICATION_DURATION/1e3}}),c.a.createElement(b.a,{title:h.localizeMessage("user.settings.notifications.desktop.title","Desktop notifications"),describe:e,focused:a.props.focused,section:"desktop",updateSection:a.handleMinUpdateSection})}),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ua(e,t)}(t,c.a.Component),function(e,t,a){t&&ca(e.prototype,t),a&&ca(e,a)}(t,[{key:"render",value:function(){return this.props.active?this.buildMaximizedSetting():this.buildMinimizedSetting()}}]),t}();function fa(e){return(fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ha(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ga(e){return(ga=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ba(e,t){return(ba=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function va(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ea(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}pa.propTypes={activity:r.a.string.isRequired,sound:r.a.string.isRequired,updateSection:r.a.func,setParentState:r.a.func,submit:r.a.func,cancel:r.a.func,error:r.a.string,active:r.a.bool,saving:r.a.bool,focused:r.a.bool};var ya=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ea(va(va(a=function(e,t){return!t||"object"!==fa(t)&&"function"!=typeof t?va(e):t}(this,ga(t).call(this,e)))),"handleChange",function(e){var t=e.currentTarget.getAttribute("data-enable-email"),n=parseInt(e.currentTarget.getAttribute("data-email-interval"),10);a.setState({enableEmail:t,emailInterval:n})}),Ea(va(va(a)),"handleSubmit",function(){var e=a.state,t=e.enableEmail,n=e.emailInterval;a.props.enableEmail!==t||a.props.emailInterval!==n?(Object(p.A)(d.q.CATEGORY_NOTIFICATIONS,d.q.EMAIL_INTERVAL,n.toString()),a.props.onSubmit(t)):a.props.updateSection("")}),Ea(va(va(a)),"handleUpdateSection",function(e){e?a.props.updateSection(e):(a.props.updateSection(""),a.setState({enableEmail:a.props.enableEmail,emailInterval:a.props.emailInterval}),a.props.onCancel())}),a.state={enableEmail:e.enableEmail,emailInterval:e.emailInterval},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ba(e,t)}(t,c.a.Component),function(e,t,a){t&&ha(e.prototype,t),a&&ha(e,a)}(t,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.saving||e.enableEmail===this.props.enableEmail&&e.emailInterval===this.props.emailInterval||this.setState({enableEmail:e.enableEmail,emailInterval:e.emailInterval})}},{key:"render",value:function(){if(!this.props.sendEmailNotifications&&"email"===this.props.activeSection){var e=[];return e.push(c.a.createElement("div",{key:"oauthEmailInfo",className:"padding-top"},c.a.createElement(m.c,{id:"user.settings.notifications.email.disabled_long",defaultMessage:"Email notifications have not been enabled by your System Administrator."}))),c.a.createElement(g.a,{title:Object(h.localizeMessage)("user.settings.notifications.emailNotifications","Email notifications"),inputs:e,server_error:this.state.serverError,section:"email",updateSection:this.handleUpdateSection})}if("email"!==this.props.activeSection){var t;if(this.props.sendEmailNotifications)if(this.props.enableEmail)switch(this.state.emailInterval){case d.q.INTERVAL_IMMEDIATE:t=c.a.createElement(m.c,{id:"user.settings.notifications.email.immediately",defaultMessage:"Immediately"});break;case d.q.INTERVAL_HOUR:t=c.a.createElement(m.c,{id:"user.settings.notifications.email.everyHour",defaultMessage:"Every hour"});break;default:t=c.a.createElement(m.c,{id:"user.settings.notifications.email.everyXMinutes",defaultMessage:"Every {count, plural, one {minute} other {{count, number} minutes}}",values:{count:this.state.emailInterval/60}})}else t=c.a.createElement(m.c,{id:"user.settings.notifications.email.never",defaultMessage:"Never"});else t=c.a.createElement(m.c,{id:"user.settings.notifications.email.disabled",defaultMessage:"Email notifications are not enabled"});return c.a.createElement(b.a,{title:Object(h.localizeMessage)("user.settings.notifications.emailNotifications","Email notifications"),describe:t,focused:this.props.focused,section:"email",updateSection:this.handleUpdateSection})}var a=null,n=null;return this.props.enableEmailBatching&&(a=c.a.createElement("div",null,c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"emailNotificationMinutes",type:"radio",name:"emailNotifications",checked:this.state.emailInterval===d.q.INTERVAL_FIFTEEN_MINUTES,"data-enable-email":"true","data-email-interval":d.q.INTERVAL_FIFTEEN_MINUTES,onChange:this.handleChange}),c.a.createElement(m.c,{id:"user.settings.notifications.email.everyXMinutes",defaultMessage:"Every {count} minutes",values:{count:d.q.INTERVAL_FIFTEEN_MINUTES/60}}))),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"emailNotificationHour",type:"radio",name:"emailNotifications",checked:this.state.emailInterval===d.q.INTERVAL_HOUR,"data-enable-email":"true","data-email-interval":d.q.INTERVAL_HOUR,onChange:this.handleChange}),c.a.createElement(m.c,{id:"user.settings.notifications.email.everyHour",defaultMessage:"Every hour"})))),n=c.a.createElement(m.c,{id:"user.settings.notifications.emailBatchingInfo",defaultMessage:"Notifications received over the time period selected are combined and sent in a single email."})),c.a.createElement(g.a,{title:Object(h.localizeMessage)("user.settings.notifications.emailNotifications","Email notifications"),inputs:[c.a.createElement("div",{key:"userNotificationEmailOptions"},c.a.createElement("label",null,c.a.createElement(m.c,{id:"user.settings.notifications.email.send",defaultMessage:"Send email notifications"})),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"emailNotificationImmediately",type:"radio",name:"emailNotifications",checked:this.state.emailInterval===d.q.INTERVAL_IMMEDIATE,"data-enable-email":"true","data-email-interval":d.q.INTERVAL_IMMEDIATE,onChange:this.handleChange}),c.a.createElement(m.c,{id:"user.settings.notifications.email.immediately",defaultMessage:"Immediately"}))),a,c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"emailNotificationNever",type:"radio",name:"emailNotifications",checked:this.state.emailInterval===d.q.INTERVAL_NEVER,"data-enable-email":"false","data-email-interval":d.q.INTERVAL_NEVER,onChange:this.handleChange}),c.a.createElement(m.c,{id:"user.settings.notifications.email.never",defaultMessage:"Never"}))),c.a.createElement("br",null),c.a.createElement("div",null,c.a.createElement(m.c,{id:"user.settings.notifications.emailInfo",defaultMessage:"Email notifications are sent for mentions and direct messages when you are offline or away from {siteName} for more than 5 minutes.",values:{siteName:this.props.siteName}})," ",n))],submit:this.handleSubmit,saving:this.props.saving,server_error:this.props.serverError,updateSection:this.handleUpdateSection})}}]),t}();Ea(ya,"propTypes",{activeSection:r.a.string.isRequired,updateSection:r.a.func.isRequired,enableEmail:r.a.bool.isRequired,emailInterval:r.a.number.isRequired,onSubmit:r.a.func.isRequired,onCancel:r.a.func.isRequired,serverError:r.a.string,saving:r.a.bool,focused:r.a.bool,sendEmailNotifications:r.a.bool,enableEmailBatching:r.a.bool,siteName:r.a.string});var Sa=a(1066);function _a(e){return(_a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oa(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ka(e){return(ka=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wa(e,t){return(wa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ma(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Na(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Ta=function(e){function t(){var e,a;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return Na(Ma(Ma(a=function(e,t){return!t||"object"!==_a(t)&&"function"!=typeof t?Ma(e):t}(this,(e=ka(t)).call.apply(e,[this].concat(s))))),"handleAutoResponderChecked",function(e){a.props.setParentState("autoResponderActive",e.target.checked)}),Na(Ma(Ma(a)),"onMessageChanged",function(e){a.props.setParentState("autoResponderMessage",e.target.value)}),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wa(e,t)}(t,c.a.PureComponent),function(e,t,a){t&&Oa(e.prototype,t),a&&Oa(e,a)}(t,[{key:"render",value:function(){var e,t=this.props,a=t.autoResponderActive,n=t.autoResponderMessage;this.props.error&&(e=c.a.createElement("label",{className:"has-error"},this.props.error));var s=[],i=c.a.createElement("div",{id:"autoResponderCheckbox",key:"autoResponderCheckbox",className:"checkbox"},c.a.createElement("label",null,c.a.createElement("input",{id:"autoResponderActive",type:"checkbox",checked:a,onChange:this.handleAutoResponderChecked}),c.a.createElement(m.c,{id:"user.settings.notifications.autoResponderEnabled",defaultMessage:"Enabled"}))),r=c.a.createElement("div",{id:"autoResponderMessage",key:"autoResponderMessage"},c.a.createElement("div",{className:"padding-top"},c.a.createElement(Sa.a,{style:{resize:"none"},id:"autoResponderMessageInput",className:"form-control",rows:"5",placeholder:Object(h.localizeMessage)("user.settings.notifications.autoResponderPlaceholder","Message"),value:n,maxLength:200,onChange:this.onMessageChanged}),e));return s.push(i),a&&s.push(r),s.push(c.a.createElement("div",{key:"autoResponderHint"},c.a.createElement("br",null),c.a.createElement(m.b,{id:"user.settings.notifications.autoResponderHint",defaultMessage:"Set a custom message that will be automatically sent in response to Direct Messages. Mentions in Public and Private Channels will not trigger the automated reply. Enabling Automatic Replies sets your status to Out of Office and disables email and push notifications."}))),c.a.createElement(g.a,{title:c.a.createElement(m.c,{id:"user.settings.notifications.autoResponder",defaultMessage:"Automatic Direct Message Replies"}),width:"medium",shiftEnter:!0,submit:this.props.submit,saving:this.props.saving,inputs:s,updateSection:this.props.updateSection})}}]),t}();function Ca(e){return(Ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Aa(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ja(e){return(ja=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pa(e,t){return(Pa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ra(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ia(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Da(e){var t=e.user,a=d.m.MENTION,n="true",s="never",i="true",r=d.m.MENTION,o=d.D.UserStatuses.AWAY,c=!1,l=h.localizeMessage("user.settings.notifications.autoResponderDefault","Hello, I am out of office and unable to respond to messages.");t.notify_props&&(t.notify_props.desktop&&(a=t.notify_props.desktop),t.notify_props.desktop_sound&&(n=t.notify_props.desktop_sound),t.notify_props.comments&&(s=t.notify_props.comments),t.notify_props.email&&(i=t.notify_props.email),t.notify_props.push&&(r=t.notify_props.push),t.notify_props.push_status&&(o=t.notify_props.push_status),t.notify_props.auto_responder_active&&(c="true"===t.notify_props.auto_responder_active),t.notify_props.auto_responder_message&&(l=t.notify_props.auto_responder_message));var u=!1,m="",p=!1,f=!1;if(t.notify_props){if(t.notify_props.mention_keys){var g=t.notify_props.mention_keys.split(",");-1===g.indexOf(t.username)?u=!1:(u=!0,g.splice(g.indexOf(t.username),1),-1!==g.indexOf("@".concat(t.username))&&g.splice(g.indexOf("@".concat(t.username)),1)),m=g.join(",")}t.notify_props.first_name&&(p="true"===t.notify_props.first_name),t.notify_props.channel&&(f="true"===t.notify_props.channel)}return{desktopActivity:a,enableEmail:i,pushActivity:r,pushStatus:o,desktopSound:n,usernameKey:u,customKeys:m,customKeysChecked:m.length>0,firstNameKey:p,channelKey:f,autoResponderActive:c,autoResponderMessage:l,notifyCommentsLevel:s,isSaving:!1}}Na(Ta,"propTypes",{autoResponderActive:r.a.bool.isRequired,autoResponderMessage:r.a.string.isRequired,updateSection:r.a.func.isRequired,setParentState:r.a.func.isRequired,submit:r.a.func.isRequired,saving:r.a.bool.isRequired,error:r.a.string});var La={desktop:"dummySectionName",email:"desktop",push:"email",keys:"push",comments:"keys"},Ua=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ia(Ra(Ra(a=function(e,t){return!t||"object"!==Ca(t)&&"function"!=typeof t?Ra(e):t}(this,ja(t).call(this,e)))),"handleSubmit",function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.state.enableEmail,t={};t.email=e,t.desktop_sound=a.state.desktopSound,t.desktop=a.state.desktopActivity,t.push=a.state.pushActivity,t.push_status=a.state.pushStatus,t.comments=a.state.notifyCommentsLevel,t.auto_responder_active=a.state.autoResponderActive.toString(),t.auto_responder_message=a.state.autoResponderMessage,t.auto_responder_message&&""!==t.auto_responder_message||(t.auto_responder_message=h.localizeMessage("user.settings.notifications.autoResponderDefault","Hello, I am out of office and unable to respond to messages."));var n=[];a.state.usernameKey&&n.push(a.props.user.username);var s=n.join(",");a.state.customKeys.length>0&&a.state.customKeysChecked&&(s+=","+a.state.customKeys),t.mention_keys=s,t.first_name=a.state.firstNameKey.toString(),t.channel=a.state.channelKey.toString(),a.setState({isSaving:!0}),Object(p.K)(t,function(){a.updateSection(""),a.setState(Da(a.props))},function(e){a.setState({serverError:e.message,isSaving:!1})})}),Ia(Ra(Ra(a)),"handleCancel",function(e){e&&e.preventDefault(),a.setState({isSaving:!1})}),Ia(Ra(Ra(a)),"handleUpdateSection",function(e){e?a.props.updateSection(e):(a.props.updateSection(""),a.handleCancel())}),Ia(Ra(Ra(a)),"setStateValue",function(e,t){var n={};n[e]=t,a.setState(n)}),Ia(Ra(Ra(a)),"updateSection",function(e){a.setState({isSaving:!1}),a.props.updateSection(e)}),Ia(Ra(Ra(a)),"handleEmailRadio",function(e){a.setState({enableEmail:e}),a.refs.wrapper.focus()}),Ia(Ra(Ra(a)),"updateUsernameKey",function(e){a.setState({usernameKey:e})}),Ia(Ra(Ra(a)),"updateFirstNameKey",function(e){a.setState({firstNameKey:e})}),Ia(Ra(Ra(a)),"updateChannelKey",function(e){a.setState({channelKey:e})}),Ia(Ra(Ra(a)),"updateCustomMentionKeys",function(){if(a.refs.customcheck.checked){var e=a.refs.custommentions.value;a.setState({customKeys:e.replace(/ /g,""),customKeysChecked:!0})}else a.setState({customKeys:"",customKeysChecked:!1})}),Ia(Ra(Ra(a)),"onCustomChange",function(){a.refs.customcheck.checked=!0,a.updateCustomMentionKeys()}),Ia(Ra(Ra(a)),"createPushNotificationSection",function(){if("push"===a.props.activeSection){var e=[],t=null,n=null;if(a.props.sendPushNotifications){var s=[!1,!1,!1];a.state.pushActivity===d.m.ALL?s[0]=!0:a.state.pushActivity===d.m.NONE?s[2]=!0:s[1]=!0;var i,r=[!1,!1,!1];a.state.pushStatus===d.D.UserStatuses.ONLINE?r[0]=!0:a.state.pushStatus===d.D.UserStatuses.AWAY?r[1]=!0:r[2]=!0,a.state.pushActivity!==d.m.NONE&&(i=c.a.createElement("div",null,c.a.createElement("hr",null),c.a.createElement("label",null,c.a.createElement(m.c,{id:"user.settings.notifications.push_notification.status",defaultMessage:"Trigger push notifications when"})),c.a.createElement("br",null),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"pushNotificationOnline",type:"radio",name:"pushNotificationStatus",checked:r[0],onChange:a.handlePushStatusRadio.bind(Ra(Ra(a)),d.D.UserStatuses.ONLINE)}),c.a.createElement(m.c,{id:"user.settings.push_notification.online",defaultMessage:"Online, away or offline"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"pushNotificationAway",type:"radio",name:"pushNotificationStatus",checked:r[1],onChange:a.handlePushStatusRadio.bind(Ra(Ra(a)),d.D.UserStatuses.AWAY)}),c.a.createElement(m.c,{id:"user.settings.push_notification.away",defaultMessage:"Away or offline"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"pushNotificationOffline",type:"radio",name:"pushNotificationStatus",checked:r[2],onChange:a.handlePushStatusRadio.bind(Ra(Ra(a)),d.D.UserStatuses.OFFLINE)}),c.a.createElement(m.c,{id:"user.settings.push_notification.offline",defaultMessage:"Offline"})))),t=c.a.createElement("span",null,c.a.createElement(m.c,{id:"user.settings.push_notification.status_info",defaultMessage:"Notification alerts are only pushed to your mobile device when your online status matches the selection above."}))),e.push(c.a.createElement("div",{key:"userNotificationLevelOption"},c.a.createElement("label",null,c.a.createElement(m.c,{id:"user.settings.push_notification.send",defaultMessage:"Send mobile push notifications"})),c.a.createElement("br",null),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"pushNotificationAllActivity",type:"radio",name:"pushNotificationLevel",checked:s[0],onChange:a.handlePushRadio.bind(Ra(Ra(a)),d.m.ALL)}),c.a.createElement(m.c,{id:"user.settings.push_notification.allActivity",defaultMessage:"For all activity"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"pushNotificationMentions",type:"radio",name:"pushNotificationLevel",checked:s[1],onChange:a.handlePushRadio.bind(Ra(Ra(a)),d.m.MENTION)}),c.a.createElement(m.c,{id:"user.settings.push_notification.onlyMentions",defaultMessage:"For mentions and direct messages"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"pushNotificationNever",type:"radio",name:"pushNotificationLevel",checked:s[2],onChange:a.handlePushRadio.bind(Ra(Ra(a)),d.m.NONE)}),c.a.createElement(m.c,{id:"user.settings.notifications.never",defaultMessage:"Never"}))),c.a.createElement("br",null),c.a.createElement("span",null,c.a.createElement(m.c,{id:"user.settings.push_notification.info",defaultMessage:"Notification alerts are pushed to your mobile device when there is activity in Mattermost."})),i)),n=a.handleSubmit}else e.push(c.a.createElement("div",{key:"oauthEmailInfo",className:"padding-top"},c.a.createElement(m.c,{id:"user.settings.push_notification.disabled_long",defaultMessage:"Push notifications have not been enabled by your System Administrator."})));return c.a.createElement(g.a,{title:h.localizeMessage("user.settings.notifications.push","Mobile push notifications"),extraInfo:t,inputs:e,submit:n,server_error:a.state.serverError,updateSection:a.handleUpdateSection})}var o="";return o=a.state.pushActivity===d.m.ALL?a.state.pushStatus===d.D.UserStatuses.AWAY?c.a.createElement(m.c,{id:"user.settings.push_notification.allActivityAway",defaultMessage:"For all activity when away or offline"}):a.state.pushStatus===d.D.UserStatuses.OFFLINE?c.a.createElement(m.c,{id:"user.settings.push_notification.allActivityOffline",defaultMessage:"For all activity when offline"}):c.a.createElement(m.c,{id:"user.settings.push_notification.allActivityOnline",defaultMessage:"For all activity when online, away or offline"}):a.state.pushActivity===d.m.NONE?c.a.createElement(m.c,{id:"user.settings.notifications.never",defaultMessage:"Never"}):a.props.sendPushNotifications?a.state.pushStatus===d.D.UserStatuses.AWAY?c.a.createElement(m.c,{id:"user.settings.push_notification.onlyMentionsAway",defaultMessage:"For mentions and direct messages when away or offline"}):a.state.pushStatus===d.D.UserStatuses.OFFLINE?c.a.createElement(m.c,{id:"user.settings.push_notification.onlyMentionsOffline",defaultMessage:"For mentions and direct messages when offline"}):c.a.createElement(m.c,{id:"user.settings.push_notification.onlyMentionsOnline",defaultMessage:"For mentions and direct messages when online, away or offline"}):c.a.createElement(m.c,{id:"user.settings.push_notification.disabled",defaultMessage:"Push notifications are not enabled"}),c.a.createElement(b.a,{title:h.localizeMessage("user.settings.notifications.push","Mobile push notifications"),describe:o,focused:a.props.prevActiveSection===La.push,section:"push",updateSection:a.handleUpdateSection})}),a.state=Da(e),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pa(e,t)}(t,c.a.Component),function(e,t,a){t&&Aa(e.prototype,t),a&&Aa(e,a)}(t,[{key:"handleNotifyCommentsRadio",value:function(e){this.setState({notifyCommentsLevel:e}),this.refs.wrapper.focus()}},{key:"handlePushRadio",value:function(e){this.setState({pushActivity:e}),this.refs.wrapper.focus()}},{key:"handlePushStatusRadio",value:function(e){this.setState({pushStatus:e}),this.refs.wrapper.focus()}},{key:"render",value:function(){var e,t,a,n=this,s=this.state.serverError,i=this.props.user;if("keys"===this.props.activeSection){var r=[];if(i.first_name){r.push(c.a.createElement("div",{key:"userNotificationFirstNameOption"},c.a.createElement("div",{className:"checkbox"},c.a.createElement("label",null,c.a.createElement("input",{id:"notificationTriggerFirst",type:"checkbox",checked:this.state.firstNameKey,onChange:function(e){n.updateFirstNameKey(e.target.checked)}}),c.a.createElement(m.c,{id:"user.settings.notifications.sensitiveName",defaultMessage:'Your case sensitive first name "{first_name}"',values:{first_name:i.first_name}})))))}r.push(c.a.createElement("div",{key:"userNotificationUsernameOption"},c.a.createElement("div",{className:"checkbox"},c.a.createElement("label",null,c.a.createElement("input",{id:"notificationTriggerUsername",type:"checkbox",checked:this.state.usernameKey,onChange:function(e){n.updateUsernameKey(e.target.checked)}}),c.a.createElement(m.c,{id:"user.settings.notifications.sensitiveUsername",defaultMessage:'Your non-case sensitive username "{username}"',values:{username:i.username}})))));r.push(c.a.createElement("div",{key:"userNotificationChannelOption"},c.a.createElement("div",{className:"checkbox"},c.a.createElement("label",null,c.a.createElement("input",{id:"notificationTriggerShouts",type:"checkbox",checked:this.state.channelKey,onChange:function(e){n.updateChannelKey(e.target.checked)}}),c.a.createElement(m.c,{id:"user.settings.notifications.channelWide",defaultMessage:'Channel-wide mentions "@channel", "@all", "@here"'}))))),r.push(c.a.createElement("div",{key:"userNotificationCustomOption"},c.a.createElement("div",{className:"checkbox"},c.a.createElement("label",null,c.a.createElement("input",{id:"notificationTriggerCustom",ref:"customcheck",type:"checkbox",checked:this.state.customKeysChecked,onChange:this.updateCustomMentionKeys}),c.a.createElement(m.c,{id:"user.settings.notifications.sensitiveWords",defaultMessage:"Other non-case sensitive words, separated by commas:"}))),c.a.createElement("input",{id:"notificationTriggerCustomText",autoFocus:this.state.customKeysChecked,ref:"custommentions",className:"form-control mentions-input",type:"text",defaultValue:this.state.customKeys,onChange:this.onCustomChange,onFocus:h.moveCursorToEnd})));var o=c.a.createElement("span",null,c.a.createElement(m.c,{id:"user.settings.notifications.mentionsInfo",defaultMessage:"Mentions trigger when someone sends a message that includes your username (@{username}) or any of the options selected above.",values:{username:i.username}}));e=c.a.createElement(g.a,{title:h.localizeMessage("user.settings.notifications.wordsTrigger","Words that trigger mentions"),inputs:r,submit:this.handleSubmit,saving:this.state.isSaving,server_error:s,updateSection:this.handleUpdateSection,extraInfo:o})}else{var l=["@"+i.username];this.state.firstNameKey&&l.push(i.first_name),this.state.usernameKey&&l.push(i.username),this.state.channelKey&&(l.push("@channel"),l.push("@all"),l.push("@here")),this.state.customKeys.length>0&&(l=l.concat(this.state.customKeys.split(",")));for(var u="",d=0;d<l.length;d++)""!==l[d]&&(u+='"'+l[d]+'", ');u=u.length>0?u.substring(0,u.length-2):c.a.createElement(m.c,{id:"user.settings.notifications.noWords",defaultMessage:"No words configured"}),e=c.a.createElement(b.a,{title:h.localizeMessage("user.settings.notifications.wordsTrigger","Words that trigger mentions"),describe:u,focused:this.props.prevActiveSection===La.keys,section:"keys",updateSection:this.handleUpdateSection})}if("comments"===this.props.activeSection){var p=[!1,!1,!1];"never"===this.state.notifyCommentsLevel?p[2]=!0:"root"===this.state.notifyCommentsLevel?p[1]=!0:p[0]=!0;var f=[];f.push(c.a.createElement("div",{key:"userNotificationLevelOption"},c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"notificationCommentsAny",type:"radio",name:"commentsNotificationLevel",checked:p[0],onChange:this.handleNotifyCommentsRadio.bind(this,"any")}),c.a.createElement(m.c,{id:"user.settings.notifications.commentsAny",defaultMessage:"Mention any comments in a thread you participated in (This will include both mentions to your root post and any comments after you commented on a post)"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"notificationCommentsRoot",type:"radio",name:"commentsNotificationLevel",checked:p[1],onChange:this.handleNotifyCommentsRadio.bind(this,"root")}),c.a.createElement(m.c,{id:"user.settings.notifications.commentsRoot",defaultMessage:"Mention any comments on your post"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"notificationCommentsNever",type:"radio",name:"commentsNotificationLevel",checked:p[2],onChange:this.handleNotifyCommentsRadio.bind(this,"never")}),c.a.createElement(m.c,{id:"user.settings.notifications.commentsNever",defaultMessage:"No mentions for comments"})))));var v=c.a.createElement("span",null,c.a.createElement(m.c,{id:"user.settings.notifications.commentsInfo",defaultMessage:"In addition to notifications for when you're mentioned, select if you would like to receive notifications on reply threads."}));t=c.a.createElement(g.a,{title:h.localizeMessage("user.settings.notifications.comments","Reply notifications"),extraInfo:v,inputs:f,submit:this.handleSubmit,saving:this.state.isSaving,server_error:s,updateSection:this.handleUpdateSection})}else{var E="";E="never"===this.state.notifyCommentsLevel?c.a.createElement(m.c,{id:"user.settings.notifications.commentsNever",defaultMessage:"Do not trigger notifications on messages in reply threads unless I'm mentioned"}):"root"===this.state.notifyCommentsLevel?c.a.createElement(m.c,{id:"user.settings.notifications.commentsRoot",defaultMessage:"Trigger notifications on messages in threads that I start"}):c.a.createElement(m.c,{id:"user.settings.notifications.commentsAny",defaultMessage:"Trigger notifications on messages in reply threads that I start or participate in"}),t=c.a.createElement(b.a,{title:h.localizeMessage("user.settings.notifications.comments","Reply notifications"),describe:E,focused:this.props.prevActiveSection===La.comments,section:"comments",updateSection:this.handleUpdateSection})}if(this.props.enableAutoResponder)if("auto-responder"===this.props.activeSection)a=c.a.createElement("div",null,c.a.createElement(Ta,{autoResponderActive:this.state.autoResponderActive,autoResponderMessage:this.state.autoResponderMessage,updateSection:this.updateSection,setParentState:this.setStateValue,submit:this.handleSubmit,error:this.state.serverError,saving:this.state.isSaving}),c.a.createElement("div",{className:"divider-dark"}));else{var y=this.state.autoResponderActive?c.a.createElement(m.c,{id:"user.settings.notifications.autoResponderEnabled",defaultMessage:"Enabled"}):c.a.createElement(m.c,{id:"user.settings.notifications.autoResponderDisabled",defaultMessage:"Disabled"});a=c.a.createElement("div",null,c.a.createElement(b.a,{title:c.a.createElement(m.c,{id:"user.settings.notifications.autoResponder",defaultMessage:"Automatic Direct Message Replies"}),width:"medium",describe:y,section:"auto-responder",updateSection:this.updateSection}),c.a.createElement("div",{className:"divider-dark"}))}var S=this.createPushNotificationSection(),_="true"===this.state.enableEmail;return c.a.createElement("div",{id:"notificationSettings"},c.a.createElement("div",{className:"modal-header"},c.a.createElement("button",{id:"closeButton",type:"button",className:"close","data-dismiss":"modal",onClick:this.props.closeModal},c.a.createElement("span",{"aria-hidden":"true"},"×")),c.a.createElement("h4",{className:"modal-title",ref:"title"},c.a.createElement("div",{className:"modal-back"},c.a.createElement("i",{className:"fa fa-angle-left",title:h.localizeMessage("generic_icons.collapse","Collapse Icon"),onClick:this.props.collapseModal})),c.a.createElement(m.c,{id:"user.settings.notifications.title",defaultMessage:"Notification Settings"}))),c.a.createElement("div",{ref:"wrapper",className:"user-settings"},c.a.createElement("h3",{id:"notificationSettingsTitle",className:"tab-header"},c.a.createElement(m.c,{id:"user.settings.notifications.header",defaultMessage:"Notifications"})),c.a.createElement("div",{className:"divider-dark first"}),c.a.createElement(pa,{activity:this.state.desktopActivity,sound:this.state.desktopSound,updateSection:this.updateSection,setParentState:this.setStateValue,submit:this.handleSubmit,saving:this.state.isSaving,cancel:this.handleCancel,error:this.state.serverError,active:"desktop"===this.props.activeSection,focused:this.props.prevActiveSection===La.desktop}),c.a.createElement("div",{className:"divider-light"}),c.a.createElement(ya,{activeSection:this.props.activeSection,updateSection:this.props.updateSection,enableEmail:_,emailInterval:h.getEmailInterval(this.props.enableEmailBatching,_),onSubmit:this.handleSubmit,onCancel:this.handleCancel,saving:this.state.isSaving,serverError:this.state.serverError,focused:this.props.prevActiveSection===La.email,sendEmailNotifications:this.props.sendEmailNotifications,enableEmailBatching:this.props.enableEmailBatching,siteName:this.props.siteName}),c.a.createElement("div",{className:"divider-light"}),S,c.a.createElement("div",{className:"divider-light"}),e,c.a.createElement("div",{className:"divider-light"}),t,c.a.createElement("div",{className:"divider-light"}),a,c.a.createElement("div",{className:"divider-dark"})))}}]),t}();Ia(Ua,"propTypes",{user:r.a.object,updateSection:r.a.func,activeSection:r.a.string,prevActiveSection:r.a.string,closeModal:r.a.func.isRequired,collapseModal:r.a.func.isRequired,sendEmailNotifications:r.a.bool,enableEmailBatching:r.a.bool,siteName:r.a.string,sendPushNotifications:r.a.bool,enableAutoResponder:r.a.bool}),Ia(Ua,"defaultProps",{user:null,activeSection:"",prevActiveSection:"",activeTab:""});var xa=Object(n.connect)(function(e){var t=Object(l.getConfig)(e);return{sendEmailNotifications:"true"===t.SendEmailNotifications,enableEmailBatching:"true"===t.EnableEmailBatching,siteName:t.SiteName,sendPushNotifications:"true"===t.SendPushNotifications,enableAutoResponder:"true"===t.ExperimentalEnableAutomaticReplies}})(Ua),Fa=a(143),qa=a(1064),za=a(137),Ga=a(717),Ba=a.n(Ga),Va=a(1022),Ha=a(850),Ya=a(555);function Wa(e){return(Wa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ka(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ja(e){return(Ja=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xa(e,t){return(Xa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qa(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Za(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var $a=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Za(Qa(Qa(a=function(e,t){return!t||"object"!==Wa(t)&&"function"!=typeof t?Qa(e):t}(this,Ja(t).call(this,e)))),"onShow",function(){a.props.actions.getUserAudits(a.props.currentUserId,0,200),Object(h.isMobile)()||ae()(".modal-body").perfectScrollbar()}),Za(Qa(Qa(a)),"onHide",function(){a.setState({show:!1})}),a.state={show:!0},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xa(e,t)}(t,c.a.PureComponent),function(e,t,a){t&&Ka(e.prototype,t),a&&Ka(e,a)}(t,[{key:"componentDidMount",value:function(){this.onShow()}},{key:"render",value:function(){var e;return e=0===this.props.userAudits.length?c.a.createElement(Ya.a,null):c.a.createElement(Ha.a,{audits:this.props.userAudits,showIp:!0,showSession:!0}),c.a.createElement(Va.a,{dialogClassName:"modal--scroll",show:this.state.show,onHide:this.onHide,onExited:this.props.onHide,bsSize:"large"},c.a.createElement(Va.a.Header,{closeButton:!0},c.a.createElement(Va.a.Title,null,c.a.createElement(m.c,{id:"access_history.title",defaultMessage:"Access History"}))),c.a.createElement(Va.a.Body,{ref:"modalBody"},e))}}]),t}();Za($a,"propTypes",{onHide:r.a.func.isRequired,actions:r.a.shape({getUserAudits:r.a.func.isRequired}).isRequired,userAudits:r.a.array.isRequired,currentUserId:r.a.string.isRequired});var en=Object(n.connect)(function(e){return{currentUserId:Object(s.getCurrentUserId)(e),userAudits:Object(s.getUserAudits)(e)||[]}},function(e){return{actions:Object(E.bindActionCreators)({getUserAudits:Ft.getUserAudits},e)}})($a),tn=a(586);a(142);function an(e){var t=e.locale,a=e.currentSession,n=e.moreInfo,s=e.handleMoreInfo;if(n){var i=new Date(a.create_at);return c.a.createElement("div",null,c.a.createElement("div",null,c.a.createElement(m.c,{id:"activity_log.firstTime",defaultMessage:"First time active: {date}, {time}",values:{date:c.a.createElement(m.a,{value:i,day:"2-digit",month:Object($.a)(t),year:"numeric"}),time:c.a.createElement(m.d,{value:i,hour:"2-digit",minute:"2-digit"})}})),c.a.createElement("div",null,c.a.createElement(m.c,{id:"activity_log.os",defaultMessage:"OS: {os}",values:{os:a.props.os}})),c.a.createElement("div",null,c.a.createElement(m.c,{id:"activity_log.browser",defaultMessage:"Browser: {browser}",values:{browser:a.props.browser}})),c.a.createElement("div",null,c.a.createElement(m.c,{id:"activity_log.sessionId",defaultMessage:"Session ID: {id}",values:{id:a.id}})))}return c.a.createElement("a",{className:"theme",href:"#",onClick:s},c.a.createElement(m.c,{id:"activity_log.moreInfo",defaultMessage:"More info"}))}function nn(e){return(nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sn(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function rn(e){return(rn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function on(e,t){return(on=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ln(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}an.propTypes={locale:r.a.string.isRequired,currentSession:r.a.object.isRequired,handleMoreInfo:r.a.func.isRequired,moreInfo:r.a.bool.isRequired};var un=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ln(cn(cn(a=function(e,t){return!t||"object"!==nn(t)&&"function"!=typeof t?cn(e):t}(this,rn(t).call(this,e)))),"handleMoreInfo",function(){a.setState({moreInfo:!0})}),ln(cn(cn(a)),"submitRevoke",function(e){a.props.submitRevoke(a.props.currentSession.id,e)}),ln(cn(cn(a)),"isMobileSession",function(e){return e.device_id&&(e.device_id.includes("apple")||e.device_id.includes("android"))}),ln(cn(cn(a)),"mobileSessionInfo",function(e){var t,a,n,s;return e.device_id.includes("apple")?(n="fa fa-apple",s=Object(h.localizeMessage)("device_icons.apple","Apple Icon"),t=Object($.b)("activity_log_modal.iphoneNativeClassicApp"),a="iPhone Native Classic App",e.device_id.includes(S.General.PUSH_NOTIFY_APPLE_REACT_NATIVE)&&(t=Object($.b)("activity_log_modal.iphoneNativeApp"),a="iPhone Native App")):e.device_id.includes("android")&&(n="fa fa-android",s=Object(h.localizeMessage)("device_icons.android","Android Icon"),t=Object($.b)("activity_log_modal.androidNativeClassicApp"),a="Android Native Classic App",e.device_id.includes(S.General.PUSH_NOTIFY_ANDROID_REACT_NATIVE)&&(t=Object($.b)("activity_log_modal.androidNativeApp"),a="Android Native App")),{devicePicture:n,deviceTitle:s,devicePlatform:c.a.createElement(m.c,{id:t,defaultMessage:a})}}),a.state={moreInfo:!1},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&on(e,t)}(t,c.a.PureComponent),function(e,t,a){t&&sn(e.prototype,t),a&&sn(e,a)}(t,[{key:"render",value:function(){var e=this.props,t=e.index,a=e.locale,n=e.currentSession,s=new Date(n.last_activity_at),i=n.props.platform,r="",o="";if("Windows"===n.props.platform)r="fa fa-windows",o=Object(h.localizeMessage)("device_icons.windows","Windows Icon");else if(this.isMobileSession(n)){var l=this.mobileSessionInfo(n);r=l.devicePicture,i=l.devicePlatform}else"Macintosh"===n.props.platform||"iPhone"===n.props.platform?(r="fa fa-apple",o=Object(h.localizeMessage)("device_icons.apple","Apple Icon")):"Linux"===n.props.platform?n.props.os.indexOf("Android")>=0?(i=c.a.createElement(m.c,{id:"activity_log_modal.android",defaultMessage:"Android"}),r="fa fa-android",o=Object(h.localizeMessage)("device_icons.android","Android Icon")):(r="fa fa-linux",o=Object(h.localizeMessage)("device_icons.linux","Linux Icon")):-1!==n.props.os.indexOf("Linux")&&(r="fa fa-linux",o=Object(h.localizeMessage)("device_icons.linux","Linux Icon"));return-1!==n.props.browser.indexOf("Desktop App")&&(i=c.a.createElement(m.c,{id:"activity_log_modal.desktop",defaultMessage:"Native Desktop App"})),c.a.createElement("div",{key:"activityLogEntryKey"+t,className:"activity-log__table"},c.a.createElement("div",{className:"activity-log__report"},c.a.createElement("div",{className:"report__platform"},c.a.createElement("i",{className:r,title:o}),i),c.a.createElement("div",{className:"report__info"},c.a.createElement("div",null,c.a.createElement(m.c,{id:"activity_log.lastActivity",defaultMessage:"Last activity: {date}, {time}",values:{date:c.a.createElement(m.a,{value:s,day:"2-digit",month:Object($.a)(a),year:"numeric"}),time:c.a.createElement(m.d,{value:s,hour:"2-digit",minute:"2-digit"})}})),c.a.createElement(an,{locale:a,currentSession:n,moreInfo:this.state.moreInfo,handleMoreInfo:this.handleMoreInfo}))),c.a.createElement("div",{className:"activity-log__action"},c.a.createElement("button",{onClick:this.submitRevoke,className:"btn btn-primary"},c.a.createElement(m.c,{id:"activity_log.logout",defaultMessage:"Logout"}))))}}]),t}();function dn(e){return(dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mn(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pn(e){return(pn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fn(e,t){return(fn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gn(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}ln(un,"propTypes",{index:r.a.number.isRequired,locale:r.a.string.isRequired,currentSession:r.a.object.isRequired,submitRevoke:r.a.func.isRequired});var bn=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),gn(hn(hn(a=function(e,t){return!t||"object"!==dn(t)&&"function"!=typeof t?hn(e):t}(this,pn(t).call(this,e)))),"submitRevoke",function(e,t){t.preventDefault();var n=ae()(t.target).closest(".modal-content");n.addClass("animation--highlight"),setTimeout(function(){n.removeClass("animation--highlight")},1500),a.props.actions.revokeSession(a.props.currentUserId,e).then(function(){a.props.actions.getSessions(a.props.currentUserId)})}),gn(hn(hn(a)),"onShow",function(){a.props.actions.getSessions(a.props.currentUserId),Object(h.isMobile)()||ae()(".modal-body").perfectScrollbar()}),gn(hn(hn(a)),"onHide",function(){a.setState({show:!1})}),a.state={show:!0},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fn(e,t)}(t,c.a.PureComponent),function(e,t,a){t&&mn(e.prototype,t),a&&mn(e,a)}(t,[{key:"componentDidMount",value:function(){this.onShow()}},{key:"render",value:function(){var e,t=this;if(this.props.sessions.loading)e=c.a.createElement(Ya.a,null);else{var a=this.props.sessions.reduce(function(e,a,n){return"UserAccessToken"===a.props.type?e:(e.push(c.a.createElement(un,{key:a.id,index:n,locale:t.props.locale,currentSession:a,submitRevoke:t.submitRevoke})),e)},[]);e=c.a.createElement("form",{role:"form"},a)}return c.a.createElement(Va.a,{dialogClassName:"modal--scroll",show:this.state.show,onHide:this.onHide,onExited:this.props.onHide,bsSize:"large"},c.a.createElement(Va.a.Header,{closeButton:!0},c.a.createElement(Va.a.Title,null,c.a.createElement(m.c,{id:"activity_log.activeSessions",defaultMessage:"Active Sessions"}))),c.a.createElement(Va.a.Body,{ref:"modalBody"},c.a.createElement("p",{className:"session-help-text"},c.a.createElement(m.c,{id:"activity_log.sessionsDescription",defaultMessage:"Sessions are created when you log in to a new browser on a device. Sessions let you use Mattermost without having to log in again for a time period specified by the System Admin. If you want to log out sooner, use the 'Logout' button below to end a session."})),e))}}]),t}();gn(bn,"propTypes",{currentUserId:r.a.string.isRequired,sessions:r.a.oneOfType([r.a.array,r.a.object]).isRequired,locale:r.a.string.isRequired,onHide:r.a.func.isRequired,actions:r.a.shape({getSessions:r.a.func.isRequired,revokeSession:r.a.func.isRequired}).isRequired});var vn=Object(n.connect)(function(e){return{currentUserId:Object(s.getCurrentUserId)(e),sessions:Object(s.getUserSessions)(e),locale:Object(tn.a)(e)}},function(e){return{actions:Object(E.bindActionCreators)({getSessions:Ft.getSessions,revokeSession:Ft.revokeSession},e)}})(bn),En=a(745),yn=(a(237),a(616));function Sn(e){return(Sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _n(e,t,a,n,s,i,r){try{var o=e[i](r),c=o.value}catch(e){return void a(e)}o.done?t(c):Promise.resolve(c).then(n,s)}function On(e){return function(){var t=this,a=arguments;return new Promise(function(n,s){var i=e.apply(t,a);function r(e){_n(i,n,s,r,o,"next",e)}function o(e){_n(i,n,s,r,o,"throw",e)}r(void 0)})}}function kn(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function wn(e){return(wn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mn(e,t){return(Mn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Nn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Tn(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Cn="creating",An="created",jn="not_creating",Pn=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Tn(Nn(Nn(a=function(e,t){return!t||"object"!==Sn(t)&&"function"!=typeof t?Nn(e):t}(this,wn(t).call(this,e)))),"startCreatingToken",function(){a.setState({tokenCreationState:Cn})}),Tn(Nn(Nn(a)),"stopCreatingToken",function(){a.setState({tokenCreationState:jn,saving:!1})}),Tn(Nn(Nn(a)),"handleCreateToken",On(regeneratorRuntime.mark(function e(){var t,n,s,i,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a.handleCancelConfirm(),""!==(t=a.refs.newtokendescription?a.refs.newtokendescription.value:"")){e.next=5;break}return a.setState({tokenError:h.localizeMessage("user.settings.tokens.nameRequired","Please enter a description.")}),e.abrupt("return");case 5:return a.setState({tokenError:"",saving:!0}),a.props.setRequireConfirm(!0,a.confirmCopyToken),n=a.props.user?a.props.user.id:"",e.next=10,a.props.actions.createUserAccessToken(n,t);case 10:s=e.sent,i=s.data,r=s.error,i&&a.state.tokenCreationState===Cn?a.setState({tokenCreationState:An,newToken:i,saving:!1}):r&&a.setState({serverError:r.message,saving:!1});case 14:case"end":return e.stop()}},e,this)}))),Tn(Nn(Nn(a)),"confirmCopyToken",function(e){a.setState({showConfirmModal:!0,confirmTitle:c.a.createElement(m.c,{id:"user.settings.tokens.confirmCopyTitle",defaultMessage:"Have you copied your token?"}),confirmMessage:function(e){return c.a.createElement("div",null,c.a.createElement(m.b,{id:"user.settings.tokens.confirmCopyMessage",defaultMessage:"Make sure you have copied and saved the access token below. You won't be able to see it again!"}),c.a.createElement("br",null),c.a.createElement("br",null),e.tokenCreationState===Cn?c.a.createElement("div",null,c.a.createElement("strong",{className:"word-break--all"},c.a.createElement(m.c,{id:"user.settings.tokens.token",defaultMessage:"Access Token: "})),c.a.createElement(m.c,{id:"user.settings.tokens.tokenLoading",defaultMessage:"Loading..."})):c.a.createElement("strong",{className:"word-break--all"},c.a.createElement(m.c,{id:"user.settings.tokens.token",defaultMessage:"Access Token: "}),e.newToken.token))},confirmButton:c.a.createElement(m.c,{id:"user.settings.tokens.confirmCopyButton",defaultMessage:"Yes, I have copied the token"}),confirmComplete:function(){a.handleCancelConfirm(),e()},confirmHideCancel:!0})}),Tn(Nn(Nn(a)),"handleCancelConfirm",function(){a.setState({showConfirmModal:!1,confirmTitle:null,confirmMessage:null,confirmButton:null,confirmComplete:null,confirmHideCancel:!1})}),Tn(Nn(Nn(a)),"confirmCreateToken",function(){Fa.isSystemAdmin(a.props.user.roles)?a.setState({showConfirmModal:!0,confirmTitle:c.a.createElement(m.c,{id:"user.settings.tokens.confirmCreateTitle",defaultMessage:"Create System Admin Personal Access Token"}),confirmMessage:function(){return c.a.createElement("div",{className:"alert alert-danger"},c.a.createElement(m.b,{id:"user.settings.tokens.confirmCreateMessage",defaultMessage:"You are generating a personal access token with System Admin permissions. Are you sure want to create this token?"}))},confirmButton:c.a.createElement(m.c,{id:"user.settings.tokens.confirmCreateButton",defaultMessage:"Yes, Create"}),confirmComplete:function(){a.handleCreateToken(),Object(zt.d)("settings","system_admin_create_user_access_token")}}):a.handleCreateToken()}),Tn(Nn(Nn(a)),"saveTokenKeyPress",function(e){h.isKeyPressed(e,d.D.KeyCodes.ENTER)&&a.confirmCreateToken()}),Tn(Nn(Nn(a)),"confirmRevokeToken",function(e){var t=a.props.userAccessTokens[e];a.setState({showConfirmModal:!0,confirmTitle:c.a.createElement(m.c,{id:"user.settings.tokens.confirmDeleteTitle",defaultMessage:"Delete Token?"}),confirmMessage:function(){return c.a.createElement("div",{className:"alert alert-danger"},c.a.createElement(yt.a,{id:"user.settings.tokens.confirmDeleteMessage",defaultMessage:"Any integrations using this token will no longer be able to access the Mattermost API. You cannot undo this action. \\n \\nAre you sure want to delete the **{description}** token?",values:{description:t.description}}))},confirmButton:c.a.createElement(m.c,{id:"user.settings.tokens.confirmDeleteButton",defaultMessage:"Yes, Delete"}),confirmComplete:function(){a.revokeToken(e),Object(zt.d)("settings","revoke_user_access_token")}})}),Tn(Nn(Nn(a)),"revokeToken",function(){var e=On(regeneratorRuntime.mark(function e(t){var n,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.actions.revokeUserAccessToken(t);case 2:n=e.sent,(s=n.error)&&a.setState({serverError:s.message}),a.handleCancelConfirm();case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()),Tn(Nn(Nn(a)),"activateToken",function(){var e=On(regeneratorRuntime.mark(function e(t){var n,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.actions.enableUserAccessToken(t);case 2:n=e.sent,(s=n.error)?a.setState({serverError:s.message}):Object(zt.d)("settings","activate_user_access_token");case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()),Tn(Nn(Nn(a)),"deactivateToken",function(){var e=On(regeneratorRuntime.mark(function e(t){var n,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.actions.disableUserAccessToken(t);case 2:n=e.sent,(s=n.error)?a.setState({serverError:s.message}):Object(zt.d)("settings","deactivate_user_access_token");case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()),a.state={showConfirmModal:!1,newToken:null,tokenCreationState:jn,tokenError:"",serverError:null,saving:!1},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mn(e,t)}(t,c.a.Component),function(e,t,a){t&&kn(e.prototype,t),a&&kn(e,a)}(t,[{key:"componentDidMount",value:function(){this.props.actions.clearUserAccessTokens();var e=this.props.user?this.props.user.id:"";this.props.actions.getUserAccessTokensForUser(e,0,200)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){!e.active&&this.props.active&&this.setState({showConfirmModal:!1,newToken:null,tokenCreationState:jn,tokenError:"",serverError:null,saving:!1})}},{key:"render",value:function(){var e=this,t="";if(!this.props.active){var a=h.localizeMessage("user.settings.tokens.clickToEdit","Click 'Edit' to manage your personal access tokens");return c.a.createElement(b.a,{title:h.localizeMessage("user.settings.tokens.title","Personal Access Tokens"),describe:a,section:"tokens",updateSection:this.props.updateSection})}var n,s,i,r=[];Object.values(this.props.userAccessTokens).forEach(function(t){var a,n;e.state.newToken&&e.state.newToken.id===t.id||(t.is_active?a=c.a.createElement("a",{name:t.id+"_deactivate",href:"#",onClick:function(a){a.preventDefault(),e.deactivateToken(t.id)}},c.a.createElement(m.c,{id:"user.settings.tokens.deactivate",defaultMessage:"Deactivate"})):(n=c.a.createElement("span",{className:"has-error setting-box__inline-error"},c.a.createElement(m.c,{id:"user.settings.tokens.deactivatedWarning",defaultMessage:"(Inactive)"})),a=c.a.createElement("a",{name:t.id+"_activate",href:"#",onClick:function(a){a.preventDefault(),e.activateToken(t.id)}},c.a.createElement(m.c,{id:"user.settings.tokens.activate",defaultMessage:"Activate"}))),r.push(c.a.createElement("div",{key:t.id,className:"setting-box__item"},c.a.createElement("div",{className:"whitespace--nowrap overflow--ellipsis"},c.a.createElement(m.c,{id:"user.settings.tokens.tokenDesc",defaultMessage:"Token Description: "}),t.description,n),c.a.createElement("div",{className:"setting-box__token-id whitespace--nowrap overflow--ellipsis"},c.a.createElement(m.c,{id:"user.settings.tokens.tokenId",defaultMessage:"Token ID: "}),t.id),c.a.createElement("div",null,a," - ",c.a.createElement("a",{name:t.id+"_delete",href:"#",onClick:function(a){a.preventDefault(),e.confirmRevokeToken(t.id)}},c.a.createElement(m.c,{id:"user.settings.tokens.delete",defaultMessage:"Delete"}))),c.a.createElement("hr",{className:"margin-bottom margin-top x2"}))))}),0===r.length&&(n=c.a.createElement(m.c,{key:"notokens",id:"user.settings.tokens.userAccessTokensNone",defaultMessage:"No personal access tokens."})),s=Object(ce.k)()?c.a.createElement("span",null,c.a.createElement(yt.a,{id:"user.settings.tokens.description_mobile",defaultMessage:"[Personal access tokens](!https://about.mattermost.com/default-user-access-tokens) function similarly to session tokens and can be used by integrations to [authenticate against the REST API](!https://about.mattermost.com/default-api-authentication). Create new tokens on your desktop."})):c.a.createElement("span",null,c.a.createElement(yt.a,{id:"user.settings.tokens.description",defaultMessage:"[Personal access tokens](!https://about.mattermost.com/default-user-access-tokens) function similarly to session tokens and can be used by integrations to [authenticate against the REST API](!https://about.mattermost.com/default-api-authentication)."})),this.state.tokenCreationState===Cn?i=c.a.createElement("div",{className:"padding-left x2"},c.a.createElement("div",{className:"row"},c.a.createElement("label",{className:"col-sm-auto control-label padding-right x2"},c.a.createElement(m.c,{id:"user.settings.tokens.name",defaultMessage:"Token Description: "})),c.a.createElement("div",{className:"col-sm-5"},c.a.createElement("input",{autoFocus:!0,ref:"newtokendescription",className:"form-control",type:"text",maxLength:64,onKeyPress:this.saveTokenKeyPress}))),c.a.createElement("div",null,c.a.createElement("div",{className:"padding-top x2"},c.a.createElement(m.c,{id:"user.settings.tokens.nameHelp",defaultMessage:"Enter a description for your token to remember what it does."})),c.a.createElement("div",null,c.a.createElement("label",{id:"clientError",className:"has-error margin-top margin-bottom"},this.state.tokenError)),c.a.createElement(yn.a,{btnClass:"btn-primary",savingMessage:c.a.createElement(m.c,{id:"user.settings.tokens.save",defaultMessage:"Save"}),saving:this.state.saving,onClick:this.confirmCreateToken}),c.a.createElement("button",{className:"btn btn-default",onClick:this.stopCreatingToken},c.a.createElement(m.c,{id:"user.settings.tokens.cancel",defaultMessage:"Cancel"})))):this.state.tokenCreationState===An?(0===r.length&&(t=" hidden"),i=c.a.createElement("div",{className:"alert alert-warning"},c.a.createElement("i",{className:"fa fa-warning margin-right",title:h.localizeMessage("generic_icons.warning","Warning Icon")}),c.a.createElement(m.c,{id:"user.settings.tokens.copy",defaultMessage:"Please copy the access token below. You won't be able to see it again!"}),c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("div",{className:"whitespace--nowrap overflow--ellipsis"},c.a.createElement(m.c,{id:"user.settings.tokens.name",defaultMessage:"Token Description: "}),this.state.newToken.description),c.a.createElement("div",{className:"whitespace--nowrap overflow--ellipsis"},c.a.createElement(m.c,{id:"user.settings.tokens.id",defaultMessage:"Token ID: "}),this.state.newToken.id),c.a.createElement("strong",{className:"word-break--all"},c.a.createElement(m.c,{id:"user.settings.tokens.token",defaultMessage:"Access Token: "}),this.state.newToken.token))):i=c.a.createElement("a",{className:"btn btn-primary",href:"#",onClick:this.startCreatingToken},c.a.createElement(m.c,{id:"user.settings.tokens.create",defaultMessage:"Create New Token"}));var o=[];return o.push(c.a.createElement("div",{key:"tokensSetting",className:"padding-top"},c.a.createElement("div",{key:"tokenList"},c.a.createElement("div",{className:"alert alert-transparent"+t},r,n),i))),c.a.createElement("div",null,c.a.createElement(g.a,{title:h.localizeMessage("user.settings.tokens.title","Personal Access Tokens"),inputs:o,extraInfo:s,infoPosition:"top",serverError:this.state.serverError,updateSection:this.props.updateSection,width:"full",saving:this.state.saving,cancelButtonText:c.a.createElement(m.c,{id:"user.settings.security.close",defaultMessage:"Close"})}),c.a.createElement(v.a,{title:this.state.confirmTitle,message:this.state.confirmMessage?this.state.confirmMessage(this.state):null,confirmButtonText:this.state.confirmButton,show:this.state.showConfirmModal,onConfirm:this.state.confirmComplete||function(){},onCancel:this.handleCancelConfirm,hideCancel:this.state.confirmHideCancel}))}}]),t}();Tn(Pn,"propTypes",{user:r.a.object,active:r.a.bool,updateSection:r.a.func,userAccessTokens:r.a.object,setRequireConfirm:r.a.func.isRequired,actions:r.a.shape({getUserAccessTokensForUser:r.a.func.isRequired,createUserAccessToken:r.a.func.isRequired,revokeUserAccessToken:r.a.func.isRequired,enableUserAccessToken:r.a.func.isRequired,disableUserAccessToken:r.a.func.isRequired,clearUserAccessTokens:r.a.func.isRequired}).isRequired}),Tn(Pn,"defaultProps",{user:{},active:!1});var Rn=Object(n.connect)(function(e){return{userAccessTokens:e.entities.users.myUserAccessTokens}},function(e){return{actions:Object(E.bindActionCreators)({getUserAccessTokensForUser:Ft.getUserAccessTokensForUser,createUserAccessToken:Ft.createUserAccessToken,revokeUserAccessToken:Ft.revokeUserAccessToken,enableUserAccessToken:Ft.enableUserAccessToken,disableUserAccessToken:Ft.disableUserAccessToken,clearUserAccessTokens:Ft.clearUserAccessTokens},e)}})(Pn);function In(e){return(In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dn(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ln(e){return(Ln=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Un(e,t){return(Un=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fn(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var qn="mfa",zn="password",Gn="signin",Bn="apps",Vn="tokens",Hn=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Fn(xn(xn(a=function(e,t){return!t||"object"!==In(t)&&"function"!=typeof t?xn(e):t}(this,Ln(t).call(this,e)))),"submitPassword",function(){var e=a.props.user,t=a.state.currentPassword,n=a.state.newPassword,s=a.state.confirmPassword;if(""!==t){var i=h.isValidPassword(n,a.props.passwordConfig),r=i.valid,o=i.error;if(r||!o)if(n===s)a.setState({savingPassword:!0}),Object(p.H)(e.id,t,n,function(){a.props.updateSection(""),a.props.actions.getMe(),a.setState(a.getDefaultState())},function(e){var t=a.getDefaultState();e.message?t.serverError=e.message:t.serverError=e,t.passwordError="",a.setState(t)});else{var c=Object.assign(a.getDefaultState(),{passwordError:h.localizeMessage("user.settings.security.passwordMatchError","The new passwords you entered do not match."),serverError:""});a.setState(c)}else a.setState({passwordError:o,serverError:""})}else a.setState({passwordError:h.localizeMessage("user.settings.security.currentPasswordError","Please enter your current password."),serverError:""})}),Fn(xn(xn(a)),"setupMfa",function(e){e.preventDefault(),za.a.push("/mfa/setup")}),Fn(xn(xn(a)),"removeMfa",function(){Object(p.h)(function(){a.props.mfaLicensed&&a.props.enableMultifactorAuthentication&&a.props.enforceMultifactorAuthentication?za.a.push("/mfa/setup"):(a.props.updateSection(""),a.setState(a.getDefaultState()))},function(e){var t=a.getDefaultState();e.message?t.serverError=e.message:t.serverError=e,a.setState(t)})}),Fn(xn(xn(a)),"updateCurrentPassword",function(e){a.setState({currentPassword:e.target.value})}),Fn(xn(xn(a)),"updateNewPassword",function(e){a.setState({newPassword:e.target.value})}),Fn(xn(xn(a)),"updateConfirmPassword",function(e){a.setState({confirmPassword:e.target.value})}),Fn(xn(xn(a)),"deauthorizeApp",function(e){e.preventDefault();var t=e.currentTarget.getAttribute("data-app");Object(p.i)(t,function(){var e=a.state.authorizedApps.filter(function(e){return e.id!==t});a.setState({authorizedApps:e,serverError:null})},function(e){a.setState({serverError:e.message})})}),Fn(xn(xn(a)),"handleUpdateSection",function(e){if(e)a.props.updateSection(e);else{switch(a.props.activeSection){case qn:case Gn:case Vn:case Bn:a.setState({serverError:null});break;case zn:a.setState({currentPassword:"",newPassword:"",confirmPassword:"",serverError:null,passwordError:null})}a.props.updateSection("")}}),Fn(xn(xn(a)),"createMfaSection",function(){if(a.props.activeSection===qn){var e,t,n,s;if(a.props.user.mfa_active)a.props.enforceMultifactorAuthentication?(n=c.a.createElement(m.c,{id:"user.settings.mfa.requiredHelp",defaultMessage:"Multi-factor authentication is required on this server. Resetting is only recommended when you need to switch code generation to a new mobile device. You will be required to set it up again immediately."}),s=c.a.createElement(m.c,{id:"user.settings.mfa.reset",defaultMessage:"Reset MFA on your account"})):(n=c.a.createElement(m.c,{id:"user.settings.mfa.removeHelp",defaultMessage:"Removing multi-factor authentication means you will no longer require a phone-based passcode to sign-in to your account."}),s=c.a.createElement(m.c,{id:"user.settings.mfa.remove",defaultMessage:"Remove MFA from your account"})),e=c.a.createElement("div",{key:"mfaQrCode"},c.a.createElement("a",{className:"btn btn-primary",href:"#",onClick:a.removeMfa},s),c.a.createElement("br",null)),t=c.a.createElement("span",null,n);else e=c.a.createElement("div",{key:"mfaQrCode"},c.a.createElement("a",{className:"btn btn-primary",href:"#",onClick:a.setupMfa},c.a.createElement(m.c,{id:"user.settings.mfa.add",defaultMessage:"Add MFA to your account"})),c.a.createElement("br",null)),t=c.a.createElement("span",null,c.a.createElement(m.c,{id:"user.settings.mfa.addHelp",defaultMessage:"Adding multi-factor authentication will make your account more secure by requiring a code from your mobile phone each time you sign in."}));var i=[];return i.push(c.a.createElement("div",{key:"mfaSetting",className:"padding-top"},e)),c.a.createElement(g.a,{title:h.localizeMessage("user.settings.mfa.title","Multi-factor Authentication"),inputs:i,extraInfo:t,serverError:a.state.serverError,updateSection:a.handleUpdateSection,width:"medium"})}var r;return r=a.props.user.mfa_active?h.localizeMessage("user.settings.security.active","Active"):h.localizeMessage("user.settings.security.inactive","Inactive"),c.a.createElement(b.a,{title:h.localizeMessage("user.settings.mfa.title","Multi-factor Authentication"),describe:r,section:qn,updateSection:a.handleUpdateSection})}),Fn(xn(xn(a)),"createPasswordSection",function(){if(a.props.activeSection===zn){var e,t=[];return""===a.props.user.auth_service?(e=a.submitPassword,t.push(c.a.createElement("div",{key:"currentPasswordUpdateForm",className:"form-group"},c.a.createElement("label",{className:"col-sm-5 control-label"},c.a.createElement(m.c,{id:"user.settings.security.currentPassword",defaultMessage:"Current Password"})),c.a.createElement("div",{className:"col-sm-7"},c.a.createElement("input",{id:"currentPassword",autoFocus:!0,className:"form-control",type:"password",onChange:a.updateCurrentPassword,value:a.state.currentPassword})))),t.push(c.a.createElement("div",{key:"newPasswordUpdateForm",className:"form-group"},c.a.createElement("label",{className:"col-sm-5 control-label"},c.a.createElement(m.c,{id:"user.settings.security.newPassword",defaultMessage:"New Password"})),c.a.createElement("div",{className:"col-sm-7"},c.a.createElement("input",{id:"newPassword",className:"form-control",type:"password",onChange:a.updateNewPassword,value:a.state.newPassword})))),t.push(c.a.createElement("div",{key:"retypeNewPasswordUpdateForm",className:"form-group"},c.a.createElement("label",{className:"col-sm-5 control-label"},c.a.createElement(m.c,{id:"user.settings.security.retypePassword",defaultMessage:"Retype New Password"})),c.a.createElement("div",{className:"col-sm-7"},c.a.createElement("input",{id:"confirmPassword",className:"form-control",type:"password",onChange:a.updateConfirmPassword,value:a.state.confirmPassword}))))):a.props.user.auth_service===d.D.GITLAB_SERVICE?t.push(c.a.createElement("div",{key:"oauthEmailInfo",className:"form-group"},c.a.createElement("div",{className:"setting-list__hint col-sm-12"},c.a.createElement(m.c,{id:"user.settings.security.passwordGitlabCantUpdate",defaultMessage:"Login occurs through GitLab. Password cannot be updated."})))):a.props.user.auth_service===d.D.LDAP_SERVICE?t.push(c.a.createElement("div",{key:"oauthEmailInfo",className:"form-group"},c.a.createElement("div",{className:"setting-list__hint col-sm-12"},c.a.createElement(m.c,{id:"user.settings.security.passwordLdapCantUpdate",defaultMessage:"Login occurs through AD/LDAP. Password cannot be updated."})))):a.props.user.auth_service===d.D.SAML_SERVICE?t.push(c.a.createElement("div",{key:"oauthEmailInfo",className:"form-group"},c.a.createElement("div",{className:"setting-list__hint col-sm-12"},c.a.createElement(m.c,{id:"user.settings.security.passwordSamlCantUpdate",defaultMessage:"This field is handled through your login provider. If you want to change it, you need to do so through your login provider."})))):a.props.user.auth_service===d.D.GOOGLE_SERVICE?t.push(c.a.createElement("div",{key:"oauthEmailInfo",className:"form-group"},c.a.createElement("div",{className:"setting-list__hint col-sm-12"},c.a.createElement(m.c,{id:"user.settings.security.passwordGoogleCantUpdate",defaultMessage:"Login occurs through Google Apps. Password cannot be updated."})))):a.props.user.auth_service===d.D.OFFICE365_SERVICE&&t.push(c.a.createElement("div",{key:"oauthEmailInfo",className:"form-group"},c.a.createElement("div",{className:"setting-list__hint col-sm-12"},c.a.createElement(m.c,{id:"user.settings.security.passwordOffice365CantUpdate",defaultMessage:"Login occurs through Office 365. Password cannot be updated."})))),c.a.createElement(g.a,{title:c.a.createElement(m.c,{id:"user.settings.security.password",defaultMessage:"Password"}),inputs:t,submit:e,saving:a.state.savingPassword,serverError:a.state.serverError,clientError:a.state.passwordError,updateSection:a.handleUpdateSection})}var n;if(""===a.props.user.auth_service){var s=new Date(a.props.user.last_password_update);n=c.a.createElement(m.c,{id:"user.settings.security.lastUpdated",defaultMessage:"Last updated {date} at {time}",values:{date:c.a.createElement(m.a,{value:s,day:"2-digit",month:"short",year:"numeric"}),time:c.a.createElement(m.d,{value:s,hour12:!a.props.militaryTime,hour:"2-digit",minute:"2-digit"})}})}else a.props.user.auth_service===d.D.GITLAB_SERVICE?n=c.a.createElement(m.c,{id:"user.settings.security.loginGitlab",defaultMessage:"Login done through GitLab"}):a.props.user.auth_service===d.D.LDAP_SERVICE?n=c.a.createElement(m.c,{id:"user.settings.security.loginLdap",defaultMessage:"Login done through AD/LDAP"}):a.props.user.auth_service===d.D.SAML_SERVICE?n=c.a.createElement(m.c,{id:"user.settings.security.loginSaml",defaultMessage:"Login done through SAML"}):a.props.user.auth_service===d.D.GOOGLE_SERVICE?n=c.a.createElement(m.c,{id:"user.settings.security.loginGoogle",defaultMessage:"Login done through Google Apps"}):a.props.user.auth_service===d.D.OFFICE365_SERVICE&&(n=c.a.createElement(m.c,{id:"user.settings.security.loginOffice365",defaultMessage:"Login done through Office 365"}));return c.a.createElement(b.a,{title:c.a.createElement(m.c,{id:"user.settings.security.password",defaultMessage:"Password"}),describe:n,section:zn,updateSection:a.handleUpdateSection})}),Fn(xn(xn(a)),"createSignInSection",function(){var e=a.props.user;if(a.props.activeSection===Gn){var t,n,s,i,r,o;if(""===e.auth_service)a.props.enableSignUpWithGitLab&&(n=c.a.createElement("div",{className:"padding-bottom x2"},c.a.createElement(qa.a,{className:"btn btn-primary",to:"/claim/email_to_oauth?email="+encodeURIComponent(e.email)+"&old_type="+e.auth_service+"&new_type="+d.D.GITLAB_SERVICE},c.a.createElement(m.c,{id:"user.settings.security.switchGitlab",defaultMessage:"Switch to using GitLab SSO"})),c.a.createElement("br",null))),a.props.enableSignUpWithGoogle&&(s=c.a.createElement("div",{className:"padding-bottom x2"},c.a.createElement(qa.a,{className:"btn btn-primary",to:"/claim/email_to_oauth?email="+encodeURIComponent(e.email)+"&old_type="+e.auth_service+"&new_type="+d.D.GOOGLE_SERVICE},c.a.createElement(m.c,{id:"user.settings.security.switchGoogle",defaultMessage:"Switch to using Google SSO"})),c.a.createElement("br",null))),a.props.enableSignUpWithOffice365&&(i=c.a.createElement("div",{className:"padding-bottom x2"},c.a.createElement(qa.a,{className:"btn btn-primary",to:"/claim/email_to_oauth?email="+encodeURIComponent(e.email)+"&old_type="+e.auth_service+"&new_type="+d.D.OFFICE365_SERVICE},c.a.createElement(m.c,{id:"user.settings.security.switchOffice365",defaultMessage:"Switch to using Office 365 SSO"})),c.a.createElement("br",null))),a.props.enableLdap&&(r=c.a.createElement("div",{className:"padding-bottom x2"},c.a.createElement(qa.a,{className:"btn btn-primary",to:"/claim/email_to_ldap?email="+encodeURIComponent(e.email)},c.a.createElement(m.c,{id:"user.settings.security.switchLdap",defaultMessage:"Switch to using AD/LDAP"})),c.a.createElement("br",null))),a.props.enableSaml&&(o=c.a.createElement("div",{className:"padding-bottom x2"},c.a.createElement(qa.a,{className:"btn btn-primary",to:"/claim/email_to_oauth?email="+encodeURIComponent(e.email)+"&old_type="+e.auth_service+"&new_type="+d.D.SAML_SERVICE},c.a.createElement(m.c,{id:"user.settings.security.switchSaml",defaultMessage:"Switch to using SAML SSO"})),c.a.createElement("br",null)));else if(a.props.enableSignUpWithEmail){var l;l=e.auth_service===d.D.LDAP_SERVICE?"/claim/ldap_to_email?email="+encodeURIComponent(e.email):"/claim/oauth_to_email?email="+encodeURIComponent(e.email)+"&old_type="+e.auth_service,t=c.a.createElement("div",{className:"padding-bottom x2"},c.a.createElement(qa.a,{className:"btn btn-primary",to:l},c.a.createElement(m.c,{id:"user.settings.security.switchEmail",defaultMessage:"Switch to using email and password"})),c.a.createElement("br",null))}var u=[];u.push(c.a.createElement("div",{key:"userSignInOption"},t,n,s,i,r,o));var p=c.a.createElement("span",null,c.a.createElement(m.c,{id:"user.settings.security.oneSignin",defaultMessage:"You may only have one sign-in method at a time. Switching sign-in method will send an email notifying you if the change was successful."}));return c.a.createElement(g.a,{title:h.localizeMessage("user.settings.security.method","Sign-in Method"),extraInfo:p,inputs:u,serverError:a.state.serverError,updateSection:a.handleUpdateSection})}var f=c.a.createElement(m.c,{id:"user.settings.security.emailPwd",defaultMessage:"Email and Password"});return a.props.user.auth_service===d.D.GITLAB_SERVICE?f=c.a.createElement(m.c,{id:"user.settings.security.gitlab",defaultMessage:"GitLab"}):a.props.user.auth_service===d.D.GOOGLE_SERVICE?f=c.a.createElement(m.c,{id:"user.settings.security.google",defaultMessage:"Google"}):a.props.user.auth_service===d.D.OFFICE365_SERVICE?f=c.a.createElement(m.c,{id:"user.settings.security.office365",defaultMessage:"Office 365"}):a.props.user.auth_service===d.D.LDAP_SERVICE?f=c.a.createElement(m.c,{id:"user.settings.security.ldap",defaultMessage:"AD/LDAP"}):a.props.user.auth_service===d.D.SAML_SERVICE&&(f=c.a.createElement(m.c,{id:"user.settings.security.saml",defaultMessage:"SAML"})),c.a.createElement(b.a,{title:h.localizeMessage("user.settings.security.method","Sign-in Method"),describe:f,section:Gn,updateSection:a.handleUpdateSection})}),Fn(xn(xn(a)),"createOAuthAppsSection",function(){if(a.props.activeSection===Bn){var e;e=a.state.authorizedApps&&a.state.authorizedApps.length>0?a.state.authorizedApps.map(function(e){var t=c.a.createElement("a",{href:e.homepage,target:"_blank",rel:"noopener noreferrer"},e.homepage);return c.a.createElement("div",{key:e.id,className:"padding-bottom x2 authorized-app"},c.a.createElement("div",{className:"col-sm-10"},c.a.createElement("div",{className:"authorized-app__name"},e.name,c.a.createElement("span",{className:"authorized-app__url"}," -"," ",t)),c.a.createElement("div",{className:"authorized-app__description"},e.description),c.a.createElement("div",{className:"authorized-app__deauthorize"},c.a.createElement("a",{href:"#","data-app":e.id,onClick:a.deauthorizeApp},c.a.createElement(m.c,{id:"user.settings.security.deauthorize",defaultMessage:"Deauthorize"})))),c.a.createElement("div",{className:"col-sm-2 pull-right"},c.a.createElement("img",{alt:e.name,src:e.icon_url||Ba.a})),c.a.createElement("br",null))}):c.a.createElement("div",{className:"padding-bottom x2 authorized-app"},c.a.createElement("div",{className:"setting-list__hint"},c.a.createElement(m.c,{id:"user.settings.security.noApps",defaultMessage:"No OAuth 2.0 Applications are authorized."})));var t,n,s=[];Array.isArray(e)&&(t="authorized-apps__wrapper",n=c.a.createElement("div",{className:"authorized-apps__help"},c.a.createElement(m.c,{id:"user.settings.security.oauthAppsHelp",defaultMessage:"Applications act on your behalf to access your data based on the permissions you grant them."}))),s.push(c.a.createElement("div",{className:t,key:"authorizedApps"},e));var i=c.a.createElement("div",null,c.a.createElement(m.c,{id:"user.settings.security.oauthApps",defaultMessage:"OAuth 2.0 Applications"}),n);return c.a.createElement(g.a,{title:i,inputs:s,serverError:a.state.serverError,updateSection:a.handleUpdateSection,width:"full",cancelButtonText:c.a.createElement(m.c,{id:"user.settings.security.close",defaultMessage:"Close"})})}return c.a.createElement(b.a,{title:h.localizeMessage("user.settings.security.oauthApps","OAuth 2.0 Applications"),describe:c.a.createElement(m.c,{id:"user.settings.security.oauthAppsDescription",defaultMessage:"Click 'Edit' to manage your OAuth 2.0 Applications"}),section:Bn,updateSection:a.handleUpdateSection})}),a.state=a.getDefaultState(),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Un(e,t)}(t,c.a.Component),function(e,t,a){t&&Dn(e.prototype,t),a&&Dn(e,a)}(t,[{key:"getDefaultState",value:function(){return{currentPassword:"",newPassword:"",confirmPassword:"",passwordError:"",serverError:"",tokenError:"",authService:this.props.user.auth_service,savingPassword:!1}}},{key:"componentDidMount",value:function(){var e=this;this.props.enableOAuthServiceProvider&&Object(p.k)(function(t){e.setState({authorizedApps:t,serverError:null})},function(t){e.setState({serverError:t.message})})}},{key:"render",value:function(){var e,t,a,n,s=this.props.user,i=this.createPasswordSection(),r=0;return r=this.props.enableSignUpWithGitLab?r+1:r,r=this.props.enableSignUpWithGoogle?r+1:r,r=this.props.enableSignUpWithOffice365?r+1:r,r=this.props.enableLdap?r+1:r,r=this.props.enableSaml?r+1:r,(this.props.enableSignUpWithEmail||""===s.auth_service)&&r>0&&this.props.experimentalEnableAuthenticationTransfer&&(e=this.createSignInSection()),this.props.enableMultifactorAuthentication&&this.props.isLicensed&&(""===s.auth_service||s.auth_service===d.D.LDAP_SERVICE)&&(t=this.createMfaSection()),this.props.enableOAuthServiceProvider&&(a=this.createOAuthAppsSection()),this.props.canUseAccessTokens&&(n=c.a.createElement(Rn,{user:this.props.user,active:this.props.activeSection===Vn,updateSection:this.handleUpdateSection,setRequireConfirm:this.props.setRequireConfirm})),c.a.createElement("div",null,c.a.createElement("div",{className:"modal-header"},c.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":h.localizeMessage("user.settings.security.close","Close"),onClick:this.props.closeModal},c.a.createElement("span",{"aria-hidden":"true"},"×")),c.a.createElement("h4",{className:"modal-title",ref:"title"},c.a.createElement("div",{className:"modal-back"},c.a.createElement("i",{className:"fa fa-angle-left",title:h.localizeMessage("generic_icons.collapse","Collapse Icon"),onClick:this.props.collapseModal})),c.a.createElement(m.c,{id:"user.settings.security.title",defaultMessage:"Security Settings"}))),c.a.createElement("div",{className:"user-settings"},c.a.createElement("h3",{className:"tab-header"},c.a.createElement(m.c,{id:"user.settings.security.title",defaultMessage:"Security Settings"})),c.a.createElement("div",{className:"divider-dark first"}),i,c.a.createElement("div",{className:"divider-light"}),t,c.a.createElement("div",{className:"divider-light"}),a,c.a.createElement("div",{className:"divider-light"}),n,c.a.createElement("div",{className:"divider-light"}),e,c.a.createElement("div",{className:"divider-dark"}),c.a.createElement("br",null),c.a.createElement(En.a,{className:"security-links color--link",dialogType:en},c.a.createElement("i",{className:"fa fa-clock-o",title:h.localizeMessage("user.settings.security.viewHistory.icon","Access History Icon")}),c.a.createElement(m.c,{id:"user.settings.security.viewHistory",defaultMessage:"View Access History"})),c.a.createElement(En.a,{className:"security-links color--link margin-top",dialogType:vn},c.a.createElement("i",{className:"fa fa-clock-o",title:h.localizeMessage("user.settings.security.logoutActiveSessions.icon","Active Sessions Icon")}),c.a.createElement(m.c,{id:"user.settings.security.logoutActiveSessions",defaultMessage:"View and Logout of Active Sessions"}))))}}]),t}();Fn(Hn,"propTypes",{user:r.a.object,activeSection:r.a.string,updateSection:r.a.func,closeModal:r.a.func.isRequired,collapseModal:r.a.func.isRequired,setRequireConfirm:r.a.func.isRequired,canUseAccessTokens:r.a.bool,isLicensed:r.a.bool,mfaLicensed:r.a.bool,enableOAuthServiceProvider:r.a.bool,enableMultifactorAuthentication:r.a.bool,enforceMultifactorAuthentication:r.a.bool,enableSignUpWithEmail:r.a.bool,enableSignUpWithGitLab:r.a.bool,enableSignUpWithGoogle:r.a.bool,enableLdap:r.a.bool,enableSaml:r.a.bool,enableSignUpWithOffice365:r.a.bool,experimentalEnableAuthenticationTransfer:r.a.bool,passwordConfig:r.a.object,militaryTime:r.a.bool,actions:r.a.shape({getMe:r.a.func.isRequired}).isRequired}),Hn.defaultProps={user:{},activeSection:""};var Yn=Object(n.connect)(function(e,t){var a=Object(l.getLicense)(e),n=Object(l.getConfig)(e),s="true"===n.EnableUserAccessTokens,i=Fa.hasUserAccessTokenRole(t.user.roles)||Fa.isSystemAdmin(t.user.roles),r=a&&"true"===a.IsLicensed,o=a&&"true"===a.MFA,c="true"===n.EnableOAuthServiceProvider,m="true"===n.EnableMultifactorAuthentication,p="true"===n.EnforceMultifactorAuthentication,f="true"===n.EnableSignUpWithEmail,g="true"===n.EnableSignUpWithGitLab,b="true"===n.EnableSignUpWithGoogle,v="true"===n.EnableLdap,E="true"===n.EnableSaml,y="true"===n.EnableSignUpWithOffice365,S="true"===n.ExperimentalEnableAuthenticationTransfer;return{canUseAccessTokens:s&&i,isLicensed:r,mfaLicensed:o,enableOAuthServiceProvider:c,enableMultifactorAuthentication:m,enforceMultifactorAuthentication:p,enableSignUpWithEmail:f,enableSignUpWithGitLab:g,enableSignUpWithGoogle:b,enableLdap:v,enableSaml:E,enableSignUpWithOffice365:y,experimentalEnableAuthenticationTransfer:S,passwordConfig:Object(h.getPasswordConfig)(n),militaryTime:Object(u.getBool)(e,d.q.CATEGORY_DISPLAY_SETTINGS,d.q.USE_MILITARY_TIME,!1)}},function(e){return{actions:Object(E.bindActionCreators)({getMe:Ft.getMe},e)}})(Hn);function Wn(e){return(Wn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kn(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Jn(e){return(Jn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xn(e,t){return(Xn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Qn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Zn(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var $n=function(e){function t(e){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Zn(Qn(Qn(a=function(e,t){return!t||"object"!==Wn(t)&&"function"!=typeof t?Qn(e):t}(this,Jn(t).call(this,e)))),"getStateFromProps",function(){var e=a.props;return{settings:{close_unused_direct_messages:e.closeUnusedDirectMessages,show_unread_section:e.displayUnreadSection,channel_switcher_section:e.channelSwitcherOption},isSaving:!1}}),Zn(Qn(Qn(a)),"updateSetting",function(e,t){var n=a.state.settings;n[e]=t,a.setState(n)}),Zn(Qn(Qn(a)),"handleSubmit",function(e){var t=a.props,n=t.actions,s=t.user,i=[];i.push({user_id:s.id,category:d.D.Preferences.CATEGORY_SIDEBAR_SETTINGS,name:e,value:a.state.settings[e]}),a.setState({isSaving:!0}),n.savePreferences(s.id,i).then(function(){a.updateSection("")})}),Zn(Qn(Qn(a)),"updateSection",function(e){e||a.setState(a.getStateFromProps()),a.setState({isSaving:!1}),a.props.updateSection(e)}),Zn(Qn(Qn(a)),"renderAutoCloseDMLabel",function(e){return"after_seven_days"===e?c.a.createElement(m.c,{id:"user.settings.sidebar.after_seven_days",defaultMessage:"After 7 days with no new messages"}):c.a.createElement(m.c,{id:"user.settings.sidebar.never",defaultMessage:"Never"})}),Zn(Qn(Qn(a)),"renderAutoCloseDMSection",function(){return"autoCloseDM"===a.props.activeSection?c.a.createElement(g.a,{title:c.a.createElement(m.c,{id:"user.settings.sidebar.autoCloseDMTitle",defaultMessage:"Automatically Close Direct Messages"}),inputs:[c.a.createElement("div",{key:"autoCloseDMSetting"},c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"autoCloseDMAfterSevenDays",type:"radio",name:"autoCloseDM",checked:"after_seven_days"===a.state.settings.close_unused_direct_messages,onChange:a.updateSetting.bind(Qn(Qn(a)),"close_unused_direct_messages","after_seven_days")}),c.a.createElement(m.c,{id:"user.settings.sidebar.after_seven_days",defaultMessage:"After 7 days with no new messages"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"autoCloseDMNever",type:"radio",name:"autoCloseDM",checked:"never"===a.state.settings.close_unused_direct_messages,onChange:a.updateSetting.bind(Qn(Qn(a)),"close_unused_direct_messages","never")}),c.a.createElement(m.c,{id:"user.settings.sidebar.never",defaultMessage:"Never"})),c.a.createElement("br",null)),c.a.createElement("div",null,c.a.createElement("br",null),c.a.createElement(m.c,{id:"user.settings.sidebar.autoCloseDMDesc",defaultMessage:"Direct Message conversations can be reopened with the “+” button in the sidebar or using the Channel Switcher (CTRL+K)."})))],setting:"close_unused_direct_messages",submit:a.handleSubmit,saving:a.state.isSaving,server_error:a.state.serverError,updateSection:a.updateSection}):c.a.createElement(b.a,{title:c.a.createElement(m.c,{id:"user.settings.sidebar.autoCloseDMTitle",defaultMessage:"Automatically Close Direct Messages"}),describe:a.renderAutoCloseDMLabel(a.state.settings.close_unused_direct_messages),section:"autoCloseDM",updateSection:a.updateSection})}),Zn(Qn(Qn(a)),"renderUnreadLabel",function(e){return"true"===e?c.a.createElement(m.c,{id:"user.settings.sidebar.showUnreadSection",defaultMessage:"At the top of the channel sidebar"}):c.a.createElement(m.c,{id:"user.settings.sidebar.never",defaultMessage:"Never"})}),Zn(Qn(Qn(a)),"renderChannelSwitcherLabel",function(e){return"true"===e?c.a.createElement(m.c,{id:"user.settings.sidebar.on",defaultMessage:"On"}):c.a.createElement(m.c,{id:"user.settings.sidebar.off",defaultMessage:"Off"})}),Zn(Qn(Qn(a)),"renderUnreadSection",function(){return"unreadChannels"===a.props.activeSection?c.a.createElement(g.a,{title:c.a.createElement(m.c,{id:"user.settings.sidebar.unreadSectionTitle",defaultMessage:"Group unread channels"}),inputs:[c.a.createElement("div",{key:"unreadSectionSetting"},c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"unreadSectionEnabled",type:"radio",name:"unreadChannels",checked:"true"===a.state.settings.show_unread_section,onChange:a.updateSetting.bind(Qn(Qn(a)),"show_unread_section","true")}),c.a.createElement(m.c,{id:"user.settings.sidebar.showUnreadSection",defaultMessage:"At the top of the channel sidebar"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"unreadSectionNever",type:"radio",name:"unreadChannels",checked:"false"===a.state.settings.show_unread_section,onChange:a.updateSetting.bind(Qn(Qn(a)),"show_unread_section","false")}),c.a.createElement(m.c,{id:"user.settings.sidebar.never",defaultMessage:"Never"})),c.a.createElement("br",null)),c.a.createElement("div",null,c.a.createElement("br",null),c.a.createElement(m.c,{id:"user.settings.sidebar.unreadSectionDesc",defaultMessage:"Unread channels will be sorted at the top of the channel sidebar until read."})))],setting:"show_unread_section",submit:a.handleSubmit,saving:a.state.isSaving,server_error:a.state.serverError,updateSection:a.updateSection}):c.a.createElement(b.a,{title:c.a.createElement(m.c,{id:"user.settings.sidebar.unreadSectionTitle",defaultMessage:"Group unread channels"}),describe:a.renderUnreadLabel(a.state.settings.show_unread_section),section:"unreadChannels",updateSection:a.updateSection})}),Zn(Qn(Qn(a)),"renderChannelSwitcherSection",function(){var e=Object($.b)("user.settings.sidebar.channelSwitcherSectionDesc.windows"),t="The channel switcher is shown at the bottom of the sidebar and is used to jump between channels quickly. It can also be accessed using CTRL + K.";Object(h.isMac)()&&(e=Object($.b)("user.settings.sidebar.channelSwitcherSectionDesc.mac"),t="The channel switcher is shown at the bottom of the sidebar and is used to jump between channels quickly. It can also be accessed using CMD + K.");var n=c.a.createElement(m.c,{id:e,defaultMessage:t});return"channelSwitcher"===a.props.activeSection?c.a.createElement(g.a,{title:c.a.createElement(m.c,{id:"user.settings.sidebar.channelSwitcherSectionTitle",defaultMessage:"Channel Switcher"}),inputs:[c.a.createElement("div",{key:"channelSwitcherSectionSetting"},c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"channelSwitcherSectionEnabled",type:"radio",name:"channelSwitcher",checked:"true"===a.state.settings.channel_switcher_section,onChange:a.updateSetting.bind(Qn(Qn(a)),"channel_switcher_section","true")}),c.a.createElement(m.c,{id:"user.settings.sidebar.on",defaultMessage:"On"})),c.a.createElement("br",null)),c.a.createElement("div",{className:"radio"},c.a.createElement("label",null,c.a.createElement("input",{id:"channelSwitcherSectionOff",type:"radio",name:"channelSwitcher",checked:"false"===a.state.settings.channel_switcher_section,onChange:a.updateSetting.bind(Qn(Qn(a)),"channel_switcher_section","false")}),c.a.createElement(m.c,{id:"user.settings.sidebar.off",defaultMessage:"Off"})),c.a.createElement("br",null)),c.a.createElement("div",null,c.a.createElement("br",null),n))],setting:"channel_switcher_section",submit:a.handleSubmit,saving:a.state.isSaving,server_error:a.state.serverError,updateSection:a.updateSection}):c.a.createElement(b.a,{title:c.a.createElement(m.c,{id:"user.settings.sidebar.channelSwitcherSectionTitle",defaultMessage:"Channel Switcher"}),describe:a.renderChannelSwitcherLabel(a.state.settings.channel_switcher_section),section:"channelSwitcher",updateSection:a.updateSection})}),a.state=a.getStateFromProps(),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Xn(e,t)}(t,c.a.Component),function(e,t,a){t&&Kn(e.prototype,t),a&&Kn(e,a)}(t,[{key:"render",value:function(){var e=this.props,t=e.showUnusedOption,a=e.showUnreadOption,n=t?this.renderAutoCloseDMSection():null,s=a?this.renderUnreadSection():null,i=this.renderChannelSwitcherSection();return c.a.createElement("div",null,c.a.createElement("div",{className:"modal-header"},c.a.createElement("button",{id:"closeButton",type:"button",className:"close","data-dismiss":"modal","aria-label":"Close",onClick:this.props.closeModal},c.a.createElement("span",{"aria-hidden":"true"},"×")),c.a.createElement("h4",{className:"modal-title",ref:"title"},c.a.createElement("div",{className:"modal-back"},c.a.createElement("i",{className:"fa fa-angle-left",title:Object(h.localizeMessage)("generic_icons.collapse","Collapse Icon"),onClick:this.props.collapseModal})),c.a.createElement(m.c,{id:"user.settings.sidebar.title",defaultMessage:"Sidebar Settings"}))),c.a.createElement("div",{className:"user-settings"},c.a.createElement("h3",{className:"tab-header"},c.a.createElement(m.c,{id:"user.settings.sidebar.title",defaultMessage:"Sidebar Settings"})),c.a.createElement("div",{className:"divider-dark first"}),s,a&&c.a.createElement("div",{className:"divider-light"}),i,t&&c.a.createElement("div",{className:"divider-light"}),n,c.a.createElement("div",{className:"divider-dark"})))}}]),t}();Zn($n,"propTypes",{actions:r.a.shape({savePreferences:r.a.func.isRequired}).isRequired,user:r.a.object,closeUnusedDirectMessages:r.a.string.isRequired,displayUnreadSection:r.a.string.isRequired,showUnusedOption:r.a.bool.isRequired,channelSwitcherOption:r.a.string.isRequired,showUnreadOption:r.a.bool.isRequired,updateSection:r.a.func,activeSection:r.a.string,closeModal:r.a.func.isRequired,collapseModal:r.a.func.isRequired});var es=Object(n.connect)(function(e){var t=Object(l.getConfig)(e);return{closeUnusedDirectMessages:Object(u.get)(e,S.Preferences.CATEGORY_SIDEBAR_SETTINGS,"close_unused_direct_messages","after_seven_days"),displayUnreadSection:Object(u.get)(e,S.Preferences.CATEGORY_SIDEBAR_SETTINGS,"show_unread_section",(t.ExperimentalGroupUnreadChannels===d.i.DEFAULT_ON).toString()),channelSwitcherOption:Object(u.get)(e,S.Preferences.CATEGORY_SIDEBAR_SETTINGS,"channel_switcher_section","true"),showUnusedOption:"true"===t.CloseUnusedDirectMessages,showUnreadOption:t.ExperimentalGroupUnreadChannels!==d.i.DISABLED,user:Object(s.getCurrentUser)(e)}},function(e){return{actions:Object(E.bindActionCreators)({savePreferences:y.savePreferences},e)}})($n);function ts(e){return(ts="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function as(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ns(e,t){return!t||"object"!==ts(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ss(e){return(ss=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function is(e,t){return(is=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var rs=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ns(this,ss(t).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&is(e,t)}(t,c.a.PureComponent),function(e,t,a){t&&as(e.prototype,t),a&&as(e,a)}(t,[{key:"render",value:function(){return"general"===this.props.activeTab?c.a.createElement("div",null,c.a.createElement(ra,{user:this.props.user,activeSection:this.props.activeSection,prevActiveSection:this.props.prevActiveSection,updateSection:this.props.updateSection,updateTab:this.props.updateTab,closeModal:this.props.closeModal,collapseModal:this.props.collapseModal})):"security"===this.props.activeTab?c.a.createElement("div",null,c.a.createElement(Yn,{user:this.props.user,activeSection:this.props.activeSection,prevActiveSection:this.props.prevActiveSection,updateSection:this.props.updateSection,closeModal:this.props.closeModal,collapseModal:this.props.collapseModal,setRequireConfirm:this.props.setRequireConfirm})):"notifications"===this.props.activeTab?c.a.createElement("div",null,c.a.createElement(xa,{user:this.props.user,activeSection:this.props.activeSection,prevActiveSection:this.props.prevActiveSection,updateSection:this.props.updateSection,closeModal:this.props.closeModal,collapseModal:this.props.collapseModal})):"display"===this.props.activeTab?c.a.createElement("div",null,c.a.createElement(xt,{user:this.props.user,activeSection:this.props.activeSection,prevActiveSection:this.props.prevActiveSection,updateSection:this.props.updateSection,closeModal:this.props.closeModal,collapseModal:this.props.collapseModal,setEnforceFocus:this.props.setEnforceFocus,setRequireConfirm:this.props.setRequireConfirm})):"sidebar"===this.props.activeTab?c.a.createElement("div",null,c.a.createElement(es,{activeSection:this.props.activeSection,prevActiveSection:this.props.prevActiveSection,updateSection:this.props.updateSection,closeModal:this.props.closeModal,collapseModal:this.props.collapseModal})):"advanced"===this.props.activeTab?c.a.createElement("div",null,c.a.createElement(Y,{activeSection:this.props.activeSection,prevActiveSection:this.props.prevActiveSection,updateSection:this.props.updateSection,closeModal:this.props.closeModal,collapseModal:this.props.collapseModal})):c.a.createElement("div",null)}}]),t}();!function(e,t,a){t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}(rs,"propTypes",{user:r.a.object.isRequired,activeTab:r.a.string,activeSection:r.a.string,prevActiveSection:r.a.string,updateSection:r.a.func,updateTab:r.a.func,closeModal:r.a.func.isRequired,collapseModal:r.a.func.isRequired,setEnforceFocus:r.a.func.isRequired,setRequireConfirm:r.a.func.isRequired});t.default=Object(n.connect)(function(e){return{user:Object(s.getCurrentUser)(e)}})(rs)},850:function(e,t,a){"use strict";var n=a(134),s=a(538),i=a(547),r=(a(235),a(233),a(5)),o=a.n(r),c=a(10),l=a.n(c),u=a(536),d=a(535),m=a(19),p=Object(u.g)({sessionRevoked:{id:Object(m.b)("audit_table.sessionRevoked"),defaultMessage:"The session with id {sessionId} was revoked"},channelCreated:{id:Object(m.b)("audit_table.channelCreated"),defaultMessage:"Created the {channelName} channel"},establishedDM:{id:Object(m.b)("audit_table.establishedDM"),defaultMessage:"Established a direct message channel with {username}"},nameUpdated:{id:Object(m.b)("audit_table.nameUpdated"),defaultMessage:"Updated the {channelName} channel name"},headerUpdated:{id:Object(m.b)("audit_table.headerUpdated"),defaultMessage:"Updated the {channelName} channel header"},channelDeleted:{id:Object(m.b)("audit_table.channelDeleted"),defaultMessage:"Archived the channel with the URL {url}"},userAdded:{id:Object(m.b)("audit_table.userAdded"),defaultMessage:"Added {username} to the {channelName} channel"},userRemoved:{id:Object(m.b)("audit_table.userRemoved"),defaultMessage:"Removed {username} to the {channelName} channel"},attemptedRegisterApp:{id:Object(m.b)("audit_table.attemptedRegisterApp"),defaultMessage:"Attempted to register a new OAuth Application with ID {id}"},attemptedAllowOAuthAccess:{id:Object(m.b)("audit_table.attemptedAllowOAuthAccess"),defaultMessage:"Attempted to allow a new OAuth service access"},successfullOAuthAccess:{id:Object(m.b)("audit_table.successfullOAuthAccess"),defaultMessage:"Successfully gave a new OAuth service access"},failedOAuthAccess:{id:Object(m.b)("audit_table.failedOAuthAccess"),defaultMessage:"Failed to allow a new OAuth service access - the redirect URI did not match the previously registered callback"},attemptedOAuthToken:{id:Object(m.b)("audit_table.attemptedOAuthToken"),defaultMessage:"Attempted to get an OAuth access token"},successfullOAuthToken:{id:Object(m.b)("audit_table.successfullOAuthToken"),defaultMessage:"Successfully added a new OAuth service"},oauthTokenFailed:{id:Object(m.b)("audit_table.oauthTokenFailed"),defaultMessage:"Failed to get an OAuth access token - {token}"},attemptedLogin:{id:Object(m.b)("audit_table.attemptedLogin"),defaultMessage:"Attempted to login"},authenticated:{id:Object(m.b)("audit_table.authenticated"),defauleMessage:"Successfully authenticated"},successfullLogin:{id:Object(m.b)("audit_table.successfullLogin"),defaultMessage:"Successfully logged in"},failedLogin:{id:Object(m.b)("audit_table.failedLogin"),defaultMessage:"FAILED login attempt"},updatePicture:{id:Object(m.b)("audit_table.updatePicture"),defaultMessage:"Updated your profile picture"},updateGeneral:{id:Object(m.b)("audit_table.updateGeneral"),defaultMessage:"Updated the general settings of your account"},attemptedPassword:{id:Object(m.b)("audit_table.attemptedPassword"),defaultMessage:"Attempted to change password"},successfullPassword:{id:Object(m.b)("audit_table.successfullPassword"),defaultMessage:"Successfully changed password"},failedPassword:{id:Object(m.b)("audit_table.failedPassword"),defaultMessage:"Failed to change password - tried to update user password who was logged in through OAuth"},updatedRol:{id:Object(m.b)("audit_table.updatedRol"),defaultMessage:"Updated user role(s) to "},member:{id:Object(m.b)("audit_table.member"),defaultMessage:"member"},accountActive:{id:Object(m.b)("audit_table.accountActive"),defaultMessage:"Account activated"},accountInactive:{id:Object(m.b)("audit_table.accountInactive"),defaultMessage:"Account deactivated"},by:{id:Object(m.b)("audit_table.by"),defaultMessage:" by {username}"},byAdmin:{id:Object(m.b)("audit_table.byAdmin"),defaultMessage:" by an admin"},sentEmail:{id:Object(m.b)("audit_table.sentEmail"),defaultMessage:"Sent an email to {email} to reset your password"},attemptedReset:{id:Object(m.b)("audit_table.attemptedReset"),defaultMessage:"Attempted to reset password"},successfullReset:{id:Object(m.b)("audit_table.successfullReset"),defaultMessage:"Successfully reset password"},updateGlobalNotifications:{id:Object(m.b)("audit_table.updateGlobalNotifications"),defaultMessage:"Updated your global notification settings"},attemptedWebhookCreate:{id:Object(m.b)("audit_table.attemptedWebhookCreate"),defaultMessage:"Attempted to create a webhook"},succcessfullWebhookCreate:{id:Object(m.b)("audit_table.successfullWebhookCreate"),defaultMessage:"Successfully created a webhook"},failedWebhookCreate:{id:Object(m.b)("audit_table.failedWebhookCreate"),defaultMessage:"Failed to create a webhook - bad channel permissions"},attemptedWebhookDelete:{id:Object(m.b)("audit_table.attemptedWebhookDelete"),defaultMessage:"Attempted to delete a webhook"},successfullWebhookDelete:{id:Object(m.b)("audit_table.successfullWebhookDelete"),defaultMessage:"Successfully deleted a webhook"},failedWebhookDelete:{id:Object(m.b)("audit_table.failedWebhookDelete"),defaultMessage:"Failed to delete a webhook - inappropriate conditions"},logout:{id:Object(m.b)("audit_table.logout"),defaultMessage:"Logged out of your account"},verified:{id:Object(m.b)("audit_table.verified"),defaultMessage:"Successfully verified your email address"},revokedAll:{id:Object(m.b)("audit_table.revokedAll"),defaultMessage:"Revoked all current sessions for the team"},loginAttempt:{id:Object(m.b)("audit_table.loginAttempt"),defaultMessage:" (Login attempt)"},loginFailure:{id:Object(m.b)("audit_table.loginFailure"),defaultMessage:" (Login failure)"},attemptedLicenseAdd:{id:Object(m.b)("audit_table.attemptedLicenseAdd"),defaultMessage:"Attempted to add new license"},successfullLicenseAdd:{id:Object(m.b)("audit_table.successfullLicenseAdd"),defaultMessage:"Successfully added new license"},failedExpiredLicenseAdd:{id:Object(m.b)("audit_table.failedExpiredLicenseAdd"),defaultMessage:"Failed to add a new license as it has either expired or not yet been started"},failedInvalidLicenseAdd:{id:Object(m.b)("audit_table.failedInvalidLicenseAdd"),defaultMessage:"Failed to add an invalid license"},licenseRemoved:{id:Object(m.b)("audit_table.licenseRemoved"),defaultMessage:"Successfully removed a license"}});function f(e){for(var t,a,n,s=[],i=e.intl.formatMessage,r=0;r<e.audits.length;r++){var o=e.audits[r],c=g(o,i,e.currentUser,e.getByName,e.getUser),d=void 0;if(e.showUserId){var m=e.getUser(c.userId),p=m?m.email:c.userId;d=l.a.createElement("td",{className:"word-break--all"},p)}var f=void 0;e.showIp&&(f=l.a.createElement("td",{className:"whitespace--nowrap word-break--all"},c.ip));var h=void 0;e.showSession&&(h=l.a.createElement("td",{className:"whitespace--nowrap word-break--all"},c.sessionId));var b="";-1!==c.desc.toLowerCase().indexOf("fail")&&(b=" color--error"),s[r]=l.a.createElement("tr",{key:o.id},l.a.createElement("td",{className:"whitespace--nowrap word-break--all"},c.timestamp),d,l.a.createElement("td",{className:"word-break--all"+b},c.desc),f,h)}return e.showUserId&&(t=l.a.createElement("th",null,l.a.createElement(u.c,{id:"audit_table.userId",defaultMessage:"User ID"}))),e.showIp&&(a=l.a.createElement("th",null,l.a.createElement(u.c,{id:"audit_table.ip",defaultMessage:"IP Address"}))),e.showSession&&(n=l.a.createElement("th",null,l.a.createElement(u.c,{id:"audit_table.session",defaultMessage:"Session ID"}))),l.a.createElement("table",{className:"table"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,l.a.createElement(u.c,{id:"audit_table.timestamp",defaultMessage:"Timestamp"})),t,l.a.createElement("th",null,l.a.createElement(u.c,{id:"audit_table.action",defaultMessage:"Action"})),a,n)),l.a.createElement("tbody",null,s))}f.propTypes={intl:u.i.isRequired,audits:o.a.array.isRequired,showUserId:o.a.bool,showIp:o.a.bool,showSession:o.a.bool,currentUser:o.a.object.isRequired,getUser:o.a.func.isRequired,getByName:o.a.func.isRequired};var h=Object(u.h)(f);function g(e,t,a,n,s){var i=e.action.replace(/\/api\/v[1-9]/,""),r="";if(0===i.indexOf("/channels")){var o,c=e.extra_info.split(" "),m=c[0].split("="),f="",h="";switch(m.indexOf("name")>=0&&(h=(o=n(f=m[m.indexOf("name")+1]))?o.display_name:f),i){case"/channels/create":r=t(p.channelCreated,{channelName:h});break;case"/channels/create_direct":r=t(p.establishedDM,{username:Object(d.getDirectTeammate)(o.id).username});break;case"/channels/update":r=t(p.nameUpdated,{channelName:h});break;case"/channels/update_desc":case"/channels/update_header":r=t(p.headerUpdated,{channelName:h});break;default:var g=[],b="";if(c[1]&&(g=c[1].split("=")).indexOf("user_id")>=0){var v=s(g[g.indexOf("user_id")+1]);v&&(b=v.username)}/\/channels\/[A-Za-z0-9]+\/delete/.test(i)?r=t(p.channelDeleted,{url:f}):/\/channels\/[A-Za-z0-9]+\/add/.test(i)?r=t(p.userAdded,{username:b,channelName:h}):/\/channels\/[A-Za-z0-9]+\/remove/.test(i)&&(r=t(p.userRemoved,{username:b,channelName:h}))}}else if(0===i.indexOf("/oauth")){var E=e.extra_info.split(" ");switch(i){case"/oauth/register":var y=E[0].split("=");"client_id"===y[0]&&(r=t(p.attemptedRegisterApp,{id:y[1]}));break;case"/oauth/allow":"attempt"===E[0]?r=t(p.attemptedAllowOAuthAccess):"success"===E[0]?r=t(p.successfullOAuthAccess):"fail - redirect_uri did not match registered callback"===E[0]&&(r=t(p.failedOAuthAccess));break;case"/oauth/access_token":if("attempt"===E[0])r=t(p.attemptedOAuthToken);else if("success"===E[0])r=t(p.successfullOAuthToken);else{var S=E[0].split("-");"fail"===S[0].trim()&&S[1]&&(r=t(S,{token:S[1].trim()}))}}}else if(0===i.indexOf("/users")){var _=e.extra_info.split(" ");switch(i){case"/users/login":"attempt"===_[0]?r=t(p.attemptedLogin):"success"===_[0]?r=t(p.successfullLogin):"authenticated"===_[0]?r=t(p.authenticated):_[0]&&(r=t(p.failedLogin));break;case"/users/revoke_session":r=t(p.sessionRevoked,{sessionId:_[0].split("=")[1]});break;case"/users/newimage":r=t(p.updatePicture);break;case"/users/update":r=t(p.updateGeneral);break;case"/users/newpassword":"attempted"===_[0]?r=t(p.attemptedPassword):"completed"===_[0]?r=t(p.successfullPassword):"failed - tried to update user password who was logged in through oauth"===_[0]&&(r=t(p.failedPassword));break;case"/users/update_roles":var O=_[0].split("=")[1];r=t(p.updatedRol),O.trim()?r+=O:r+=t(p.member);break;case"/users/update_active":var k=_[0].split("=")[0],w=_[0].split("=")[1];if("active"===k){"true"===w?r=t(p.accountActive):"false"===w&&(r=t(p.accountInactive));var M=_[1].split("=");if("session_user"===M[0]){var N=s(M[1]),T=a;T&&N&&Object(d.isSystemAdmin)(T.roles)?r+=t(p.by,{username:N.username}):T&&N&&(r+=t(p.byAdmin))}}else"session_id"===k&&(r=t(p.sessionRevoked,{sessionId:w}));break;case"/users/send_password_reset":r=t(p.sentEmail,{email:_[0].split("=")[1]});break;case"/users/reset_password":"attempt"===_[0]?r=t(p.attemptedReset):"success"===_[0]&&(r=t(p.successfullReset));break;case"/users/update_notify":r=t(p.updateGlobalNotifications)}}else if(0===i.indexOf("/hooks")){var C=e.extra_info;switch(i){case"/hooks/incoming/create":"attempt"===C?r=t(p.attemptedWebhookCreate):"success"===C?r=t(p.succcessfullWebhookCreate):"fail - bad channel permissions"===C&&(r=t(p.failedWebhookCreate));break;case"/hooks/incoming/delete":"attempt"===C?r=t(p.attemptedWebhookDelete):"success"===C?r=t(p.successfullWebhookDelete):"fail - inappropriate conditions"===C&&(r=t(p.failedWebhookDelete))}}else if(0===i.indexOf("/license")){var A=e.extra_info;switch(i){case"/license/add":"attempt"===A?r=t(p.attemptedLicenseAdd):"success"===A?r=t(p.successfullLicenseAdd):"failed - expired or non-started license"===A?r=t(p.failedExpiredLicenseAdd):"failed - invalid license"===A&&(r=t(p.failedInvalidLicenseAdd));break;case"/license/remove":r=t(p.licenseRemoved)}}else if(0===i.indexOf("/admin/download_compliance_report"))r=Object(d.toTitleCase)(e.extra_info);else switch(i){case"/logout":r=t(p.logout);break;case"/verify_email":r=t(p.verified)}if(!r)if(e.extra_info.indexOf("revoked_all=")>=0)r=t(p.revokedAll);else{var j="";i&&-1!==i.lastIndexOf("/")&&(j=i.substring(i.lastIndexOf("/")+1).replace("_"," "),j=Object(d.toTitleCase)(j));var P="";e.extra_info&&-1!==(P=e.extra_info).indexOf("=")&&(P=P.substring(P.indexOf("=")+1)),r=j+" "+P}var R=new Date(e.create_at),I={};return I.timestamp=l.a.createElement("div",null,l.a.createElement("div",null,l.a.createElement(u.a,{value:R,day:"2-digit",month:"short",year:"numeric"})),l.a.createElement("div",null,l.a.createElement(u.d,{value:R,hour:"2-digit",minute:"2-digit"}))),I.userId=e.user_id,I.desc=r,I.ip=e.ip_address,I.sessionId=e.session_id,I}t.a=Object(n.connect)(function(e){return{currentUser:Object(s.getCurrentUser)(e),getUser:function(t){return Object(s.getUser)(e,t)},getByName:function(t){return Object(i.getChannelByName)(e,t)}}})(h)}}]);
//# sourceMappingURL=5.cdd0050bc94aa4118500.js.map